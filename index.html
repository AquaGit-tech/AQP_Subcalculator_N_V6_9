<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AQP Subcalculator - Onderaannemer prijsberekening voor Vecon">
    <meta name="author" content="Vecon">
    <meta name="robots" content="noindex, nofollow">
    <title>AQP Subcalculator V11.0</title>
    <style>
    /* ============================================================
       AQP SUBCALCULATOR V11.0
       ============================================================
       BUILD DATE: 08-12-2025
       STATUS: PRODUCTION READY
       
       CHANGELOG V11.0:
       -----------------
       [UTF-8 ENCODING] Complete conversie conform KB V2.0
       
       [VALUTA] EUR → € symbool
       - Alle prijsbadges: EUR X,XX/m² → € X,XX/m²
       - Alle breakdown spans: EUR X → € X
       - Alle summary values: EUR X,XX → € X,XX
       - Alle factuuroverzicht regels: EUR → €
       - Alle info modal prijzen: EUR → €
       - Alle dormant reset values: EUR → €
       
       [EENHEDEN] m2 → m² superscript
       - Alle unit-inside spans: m2 → m²
       - Alle sr-only labels: in m2 → in m²
       - Alle placeholders: (m2) → (m²)
       - Alle prijsbadges eenheden: /m2 → /m²
       - Alle verbruik strings: kg/m², L/m², m²/m²
       - Alle info modal eenheden: /cm/m² formaat
       - Alle mat-qty regels: X m² = Y kg
       
       [COPYRIGHT] (c) → © symbool
       - Footer: (c) 2025 Vecon → © 2025 Vecon
       
       [PIJLEN] -> → → symbool
       - Mat-qty regels: -> X m² → → X m²
       
       [TECHNISCH] Behouden in ASCII
       - Element IDs: vloer_m2, price-membraan etc.
       - Data attributes: data-field, data-key
       - JavaScript variabelen: inputs.vloer_m2, qty.bezetten
       - Config keys: cap_per_man, mat_prijs
       
       CHANGELOG V10.11:
       -----------------
       [UX PARITEIT] Volledige V34.5 Sales Calculator UX-alignment
       
       [CSS] Dormant tekst styling
       - .dormant select, .dormant input: color text-muted, font-weight 500
       - Keuzevelden blijven grijs zolang kaart inactief is
       
       [JS] Card activation systeem (V30.15 pattern)
       - cardPrimaryField mapping: bepaalt welk numeriek veld kaart activeert
       - inputToCard mapping: koppelt elk input/select aan parent card
       - shouldActivateCard(): check of primair veld waarde > 0 heeft
       - deactivateCardIfEmpty(): zet kaart terug naar dormant als leeg
       - Dropdown selecties alleen activeren kaart NIET meer
       
       [JS] Auto-scroll focus (V33.2 pattern)
       - scrollFieldIntoView(): scrollt actief veld naar 1/3 van viewport
       - Smooth scroll animatie voor prettige mobiele UX
       - 50ms delay voorkomt conflict met toetsenbord
       
       [JS] Auto-select bestaande waarde (V27.0 pattern)
       - Bij focus wordt gehele getal direct geselecteerd
       - Directe overtypen mogelijk zonder eerst te selecteren
       
       [JS] Enhanced event handlers
       - Input handler: dormant logica met shouldActivateCard check
       - Select handler: alleen activeren als primair veld waarde heeft
       - Reset handler: expliciete dormant state voor alle kaarten
       
       CHANGELOG V10.10:
       -----------------
       [BUGFIX] Fassa Shield capaciteit
       - cap_per_man: 15 -> 25 m2/dag
       - Conform Master Component Sheet V1.3 en Sales Calculator V34.2
       
       [PRIJSCORRECTIE] CODEX Power CX2 / Membraan
       - Verpakkingsprijs: EUR 15,00 -> EUR 15,80 (zak 25kg)
       - Eenheidsprijs: EUR 0,60/kg -> EUR 0,632/kg
       - Membraan mat: EUR 7,80 -> EUR 7,98 (CODEX 3,95 + SNC 4,03)
       - Conform Master Component Sheet V1.3
       
       CHANGELOG V10.9:
       ----------------
       [BUGFIX] Inconsistente if/else structuur
       - Info modal volgorde: sopro -> asocret -> sulfatex (consistent)
       - berekenDynamisch volgorde: sopro -> asocret -> sulfatex (consistent)
       - Expliciete checks voor alle 3 systemen, geen fallback
       
       [BUGFIX] materialState reset toegevoegd
       - Reset knop reset nu alle materialState checkboxes naar true
       - Alle materialen weer enabled na reset
       
       [CLEANUP] Dubbele event listeners verwijderd
       - sulfatex-lagen verwijderd uit forEach array (aparte listener behouden)
       - asocret-dikte verwijderd uit forEach array (aparte listener behouden)
       
       [CLEANUP] Comment header functie signatures geüpdatet
       
       CHANGELOG V10.8:
       ----------------
       [FEATURE] Asocret dikte dropdown (10/15/20mm)
       - asocret-dikte dropdown toegevoegd
       - Capaciteit per dikte: 25/20/15 m2/dag (met Autex: -20%)
       - Materiaal per dikte: EUR 16,20/24,30/32,40 per m2
       - Info modal met dikte-specifieke verbruiken
       - Conform V34.2 Sales Calculator en Master Sheet V1.2
       
       CHANGELOG V10.7:
       ----------------
       [FEATURE] Sulfatex lagen + Autex optie
       - sulfatex-lagen dropdown (2/3 lagen)
       - sulfatex-autex dropdown (zonder/met)
       - Capaciteit: 32,50/21,67 m2/dag (met Autex: -20%)
       - Materiaal: EUR 18,00/27,00 per m² (+EUR 3,24 met Autex)
       - Info modal met checkboxes
       - Conform V34.2 Sales Calculator en Master Sheet V1.2
       
       CHANGELOG V10.6:
       ----------------
       [FEATURE] Sopro Autex optie
       - sopro-autex dropdown toegevoegd (zonder/met)
       - Capaciteit met Autex: -20% (26/17,33/13 m2/dag)
       - Materiaal met Autex: +EUR 3,24/m2
       - Info modal met Autex checkbox
       - Conform V34.2 Sales Calculator
       
       CHANGELOG V10.5:
       ----------------
       [FEATURE] XPS Gitex methode dropdown
       - xps-gitex dropdown toegevoegd (naden/volledig)
       - XPS_GITEX_SYSTEMS datastructuur (conform Wedi)
       - Dynamische capaciteit: naden 35, volledig 30 m2/dag
       - Dynamische gitex/snelband prijzen per methode
       
       [FIX] Gitex prijscorrectie (Master Sheet V1.2)
       - Gitex eenheidsprijs: EUR 1,2534 -> EUR 1,0665/m2
       - XPS naden gitex: EUR 0,31 -> EUR 0,27
       - XPS volledig gitex: EUR 1,38 -> EUR 1,17
       - Wedi naden gitex: EUR 0,31 -> EUR 0,27
       - Wedi volledig gitex: EUR 1,38 -> EUR 1,17
       
       [CLEANUP] Dode code verwijderd
       - XPS_MAT object (ongebruikt)
       - WEDI_MAT object (ongebruikt)
       
       CHANGELOG V10.4:
       ----------------
       [GRONDERING] Mat-qty regels toegevoegd voor alle 6 producten
       - Stucprimer: 0,10 kg/m², verpakking 5L
       - Sopro GD749: 0,15 kg/m², verpakking 5kg
       - Technicure CS: 0,50 L/m², verpakking 25L
       - Keisol MB: 0,15 kg/m², verpakking 30kg
       - Betokontakt: 0,30 kg/m², verpakking 20kg
       - Technicure AS: 0,33 kg/m², verpakking 5kg (trapfunctie)
       - Format: "-> qty m² = X,X kg/L (Y,YY emmers a grootte)"
       
       CHANGELOG V10.2:
       ----------------
       [FIX] Mat-qty Wedi plaat format
       - Toegevoegd "a" voor plaatafmeting
       - Was: "X,XX platen 2600x600"
       - Nu: "X,XX platen a 2600x600"
       
       CHANGELOG V10.1:
       ----------------
       [INFO MODALS - MAT-QTY FORMAT FIX]
       - Volledig format hersteld: totaal + exacte verpakkingseenheden
       - Format: "-> qty m² = X kg/L/m2 (Y,YY zakken/emmers/rollen a grootte)"
       - Voorbeeld: "-> 42 m² = 630 kg (25,20 zakken a 25kg)"
       - Alle 20 materiaalregels consistent aangepast
       
       CHANGELOG V10:
       --------------
       [PRIJSVERIFICATIE - ALLE DYNAMISCHE BREAKDOWNS]
       Systematische verificatie tegen technische fiches en factuuroprijzen.
       NB: VAST/ANKER systeem (EUR 13/31/28/38) blijft ONGEWIJZIGD.
       
       [INJECTIES]
       - Fassa Inject: EUR 15,80 -> EUR 14,22/L (emmer EUR 142,20/10L)
       - Prijs/m: EUR 3,16 -> EUR 2,84
       
       [MEMBRAAN]
       - SNC-Membraan: verbruik 1,10 -> 1,00 m²/m² (overlap verwijderd)
       - SNC prijs: EUR 4,43 -> EUR 4,03/m2
       - Totaal: EUR 8,20 -> EUR 7,80/m2
       
       [BEZETTEN]
       - MP75 zakprijs: EUR 9,08/25kg (eenheidsprijs EUR 0,3632/kg)
       - Prijs/m2: EUR 5,70 -> EUR 5,45
       
       [XPS ISOLATIESYSTEEM]
       - L-gips: forfait EUR 2,40 -> EUR 0,75 (1,8 kg/m² x € 0,4104/kg)
       - Gitex: EUR 1,43 -> EUR 1,38 (rol EUR 125,34/100m2)
       - Snelband: 3mm -> 1mm, EUR 1,34 -> EUR 0,44 (0,8 kg x € 0,552/kg)
       - Totalen: 20mm EUR 5,72, 30mm EUR 6,40, 40mm EUR 7,82, 
                  50mm EUR 9,13, 60mm EUR 10,45
       
       [WEDI SYSTEEM]
       - Flexlijm -> CODEX: EUR 5,00 -> EUR 3,77/m2
       - Gitex naden: EUR 0,42 -> EUR 0,31 (0,25 m2 x € 1,2534)
       - Snelband naden: EUR 0,16 -> EUR 0,11 (0,20 kg x € 0,552)
       - Totalen: 4mm EUR 35,61, 6mm EUR 33,17, 10mm EUR 32,00
       
       [ASOCRET]
       - Autex: EUR 2,16 -> EUR 3,24 (rol EUR 178,20/55m2)
       - Verbruik: 1,1 -> 1,0 m²/m² (overlap verwijderd)
       - Totaal: EUR 18,36 -> EUR 19,44/m2
       
       [FIX & FINISH]
       - Laagdikte: 3mm (gebruiker keuze)
       - Verbruik: 4 -> 2,55 kg/m² (0,85 kg/mm x 3mm)
       - Zakprijs: EUR 17,67/25kg (eenheidsprijs EUR 0,7068/kg)
       - Prijs/m2: EUR 2,40 -> EUR 1,80
       
       [FASSA SHIELD]
       - Superbond: EUR 4,27 -> EUR 4,20 (2,21 kg/m² x € 1,90/kg)
       - Afwerking: EUR 2,12 -> EUR 1,80 (Fix & Finish 3mm)
       - Totaal: EUR 40,28 -> EUR 39,89/m2
       
       [GRONDERING - 6 PRODUCTEN]
       - Stucprimer: EUR 0,70 -> EUR 0,52 (0,10 kg x € 5,234/kg)
       - Sopro GD749: EUR 1,17 (ongewijzigd)
       - Technicure CS: EUR 2,91 -> EUR 3,64 (0,50 L x € 7,28/L)
       - Keisol MB: EUR 3,10 -> EUR 0,78 (0,15 kg x € 5,17/kg)
       - Betokontakt: EUR 1,73 -> EUR 0,84 (0,30 kg x € 2,79/kg)
       - Technicure AS: ongewijzigd (trapfunctie)
       
       [BIJKOMEND PLEISTERWERK]
       - MP75: EUR 2,85 -> EUR 2,72/cm/m2 (7,5 kg x € 0,3632/kg)
       
       CHANGELOG V9.28:
       ---------------
       [BIJKOMEND PLEISTERWERK - PUUR MP75]
       - Herwerkt naar puur MP75 basis (zonder Snelband)
       - Materiaal: MP75 EUR 2,85/cm/m2 (7,5 kg/cm x € 0,38/kg)
       - Arbeid: EUR 7,15/cm/m2 (vast)
       - Totaal: EUR 10,00/cm/m2 (ongewijzigd)
       - Info modal met checkbox voor MP75 materiaal
       - Uitvinken MP75 = alleen arbeidskosten (EUR 7,15/cm/m²)
       
       [BUGFIX - TIJD DUBBELTELLING TOTAALOVERZICHT]
       - Herberekening van result.manuren en result.loon aan einde van
         berekenDynamisch als som van alle component waarden
       - Voorkomt inconsistentie tussen componentkaart (correct) en
         totaaloverzicht (was dubbel)
       
       CHANGELOG V9.27:
       ---------------
       [XPS VEREENVOUDIGD]
       - PU-schuim verwijderd uit XPS berekening en modal
       - Vier checkboxes: plaat, L-gips, Gitex, Snelband
       - Materiaalprijs per dikte (zonder PU-schuim):
         * 20mm: EUR 9,16 -> EUR 8,32
         * 30mm: EUR 9,84 -> EUR 9,00
         * 40mm: EUR 11,26 -> EUR 10,42
         * 50mm: EUR 12,57 -> EUR 11,73
         * 60mm: EUR 13,89 -> EUR 13,05
       
       CHANGELOG V9.26:
       ---------------
       [MEMBRAAN CORRECTIE - HYGROSCOPISCHE KB]
       - Twee checkboxes: CODEX POWER CX2 + SNC-Membraan
       - CODEX POWER CX2: 6,25 kg/m² x € 0,60/kg = EUR 3,77/m2
       - SNC-Membraan: 1,10 m²/m² x € 4,03/m2 = EUR 4,43/m2
       - Materiaalprijs: EUR 8,00/m2 -> EUR 8,20/m2 (KB conform)
       - Bron: HYGROSCOPISCHE_BEHANDELING_MET_SNC-MEMBRAAN_KB
       
       CHANGELOG V9.25:
       ---------------
       [CHECKBOX SYNC - COMPONENTKAART = MODAL]
       - BUG FIX: Componentkaart toonde COMP.mat i.p.v. checkbox-gebaseerde prijs
       - berekenDynamisch() gebruikt nu effectieve prijs functies:
         * Injecties: getInjectiesMatPrijs()
         * Membraan: getMembraanMatPrijs()
         * Bezetten: getBezettenMatPrijs()
         * XPS: getXpsMatPrijs(dikte)
         * Sopro: getSoproMatPrijs(lagen, metAutex)
         * Sulfatex: getSulfatexMatPrijs(lagen, metAutex)
         * Asocret: getAsocretMatPrijs(dikte, metAutex)
         * Fixfinish: getFixfinishMatPrijs()
         * Fassashield: getFassashieldMatPrijs()
       - berekenVasteTarieven() ook aangepast voor checkbox sync
       - Resultaat: uitvinken checkbox = EUR 0,00 in BEIDE weergaves
       
       CHANGELOG V9.24:
       ---------------
       [INJECTIES VEREENVOUDIGD]
       - PU-schuim verwijderd uit berekening en modal
       - Materiaalprijs: EUR 3,30/m -> EUR 3,16/m (alleen Fassa Inject)
       - Eén checkbox: Fassa Inject (EUR 3,16/m)
       
       CHANGELOG V9.23:
       ---------------
       [INJECTIES CORRECTIE - FASSA INJECT KB]
       - Kiesol MB -> Fassa Inject (correcte productnaam)
       - Materiaalprijs: EUR 2,00/m -> EUR 3,30/m (KB conform)
       - Twee checkboxes: Fassa Inject (EUR 3,16/m) + PU-schuim (EUR 0,14/m)
       - Verbruik: 0,2 L/m x € 15,80/L = EUR 3,16/m
       - PU-schuim: forfait EUR 0,14/m
       - Bron: FASSA_INJECT_VOCHTINJECTIES_KNOWLEDGE_BASE
       
       CHANGELOG V9.22:
       ---------------
       [ALLE INFO MODALS HERSCHREVEN - KB V1.0 STANDAARD]
       - Alle modals naar two-line layout met checkboxes
       - Injecties: checkbox Kiesol MB (EUR 2,00/m)
       - Membraan: checkbox SNC-membraan (EUR 8,00/m²)
       - Bezetten: checkbox MP75 gipspleister (EUR 5,70/m²)
       - XPS: checkboxes plaat/L-gips/PU-schuim/Gitex/Snelband
       - Ultradun Sopro: checkboxes per laag + wapening
       - Ultradun Asocret: checkboxes mortel + Autex
       - Fix & Finish: checkbox Fix & Finish (EUR 2,61/m²)
       - Fassa Shield: checkboxes Shield/Superbond/Afwerking
       - Consistente V30.13/V30.18 styling voor alle modals
       - materialState uitgebreid voor alle componenten
       - Toggle functies per component toegevoegd
       - Bron: INFOMODAL_HERSCHRIJVING_KNOWLEDGE_BASE_V1_0
       
       CHANGELOG V9.21:
       ---------------
       [WEDI GITEX METHODE - V30.18 SYNC]
       - Dropdown: "Naden verstevigen" vs "Volledig oppervlak"
       - WEDI_GITEX_SYSTEMS met productiviteit/prijzen per methode
       - Naden: 30 m2/dag, Gitex 0,12 m²/m² = EUR 0,42
       - Volledig: 25 m2/dag, Gitex 1,10 m²/m² = EUR 3,85
       - Snelband variabel per methode (naden = 12% van volledig)
       - Info modal: toont gekozen methode en variabele prijzen
       - Capaciteit en materiaal dynamisch per methode
       - Consistent met Sales Calculator V30.18
       
       CHANGELOG V9.20:
       ---------------
       [MODAL TOTAL STYLING - V30.13]
       - .total-badge -> .modal-total
       - Verwijderd: blauwe achtergrond, border-radius
       - Toegevoegd: border-top 2px solid primary
       - Label: 14px, uppercase, var(--text)
       - Value: 18px, bold, var(--primary)
       - Consistent met Sales Calculator V30.13
       
       CHANGELOG V9.19:
       ---------------
       [SNELBAND CORRECTIE]
       - Laagdikte: 3mm (voor Gitex verankering)
       - Verbruik: 0,8 kg/mm x 3mm = 2,4 kg/m²
       - Prijs: EUR 14,00/25kg = EUR 0,56/kg
       - Kosten: 2,4 x 0,56 = EUR 1,34/m2 (was EUR 2,00)
       - Totaal 10mm: EUR 38,66 -> EUR 38,00 (-EUR 0,66)
       - Bron: Knauf datasheet + praktijk
       
       CHANGELOG V9.18:
       ---------------
       [MODAL MATERIAALKOSTEN VERDUIDELIJKING]
       - Two-line layout voor materiaal checkboxes
       - Regel 1: Checkbox + naam + prijs/m2
       - Regel 2: Verbruik x eenheidsprijs berekening
       - WEDI_MAT_BREAKDOWN uitgebreid met verbruik/eenheidsprijs
       - Nieuwe CSS classes: .mat-row, .mat-calc
       - Bron referentie: KB V1.4
       
       CHANGELOG V9.17:
       ---------------
       [FLEXLIJM CORRECTIE]
       - Verbruik: 14 kg/m² -> 6,25 kg/m² (praktijk: 4m2/zak)
       - Prijs: EUR 11,20 -> EUR 5,00 per m2
       - Bron: Hygroscopische KB + praktijkervaring
       - Impact Wedi totaal: -EUR 6,20/m2
       - 4mm: EUR 48,47 -> EUR 42,27
       - 6mm: EUR 46,03 -> EUR 39,83
       - 10mm: EUR 44,86 -> EUR 38,66
       
       CHANGELOG V9.16:
       ---------------
       [MATERIAAL CHECKBOXES - PROOF OF CONCEPT]
       - WEDI_MAT_BREAKDOWN: per-materiaal prijzen
       - materialState object voor checkbox states (sessie)
       - getWediMatPrijs(): effectieve prijs o.b.v. checkboxes
       - toggleWediMaterial(): toggle + herbereken
       - Info modal Wedi: checkboxes per materiaal
       - Uitvinken materiaal = EUR 0,00 (AQP levert)
       - Direct update componentkaart bij toggle
       
       CHANGELOG V9.15:
       ---------------
       [INFO MODAL CONTENT STYLING V30.13]
       - material-badge -> modal-section-title
       - info-list -> material-list
       - Consistente classnames met V30.13
       - Duplicate CSS verwijderd
       
       CHANGELOG V9.14:
       ---------------
       [INFO MODAL V30.13 STYLING]
       - Modal overlay systeem (fade-in animatie)
       - Sluiten knop onderaan (i.p.v. X rechtsboven)
       - Material-badge als section title
       - Info-list met > bullets
       - Escape toets sluit modal
       - Click buiten modal sluit
       
       CHANGELOG V9.13:
       ---------------
       [BEZETTEN MATERIAALKOST]
       - mat: 6.50 -> 5.70 (puur MP75, geen Snelband)
       - 15 kg/m² x € 0,38/kg = EUR 5,70/m2
       - Info modal ook aangepast naar 5.70
       
       CHANGELOG V9.12:
       ---------------
       [SELECT DROPDOWN TEXT FIX]
       - Override font-size: 18px -> 16px gefixed
       - padding-right: 30px toegevoegd (ruimte voor pijl)
       - Tekst "Met Autex glasvezelwapening" past nu volledig
       
       CHANGELOG V9.11:
       ---------------
       [INPUT/SELECT COMPACTER]
       - font-size: 18px -> 16px
       - padding: 8px 13px -> 8px 8px
       - Meer ruimte voor "Met Autex glasvezelwapening"
       
       CHANGELOG V9.10:
       ---------------
       [AUTEX DROPDOWN POSITIE]
       - Zie V9.10 voor details
       ============================================================ */

    * { margin: 0; padding: 0; box-sizing: border-box; }

    /* === CSS VARIABELEN === */
    :root {
        /* Brand Colors */
        --primary: #33b2d2;
        --primary-dark: #2a9bbf;
        
        /* Text */
        --text: #e5e5e5;
        --text-muted: #a0a0a0;
        
        /* Backgrounds */
        --bg: #1a1b1e;
        --card-bg: #25272b;
        --input-bg: #1e2023;
        
        /* Borders & Effects */
        --border: #3c4043;
        --card-shadow: none;
        --focus-ring: 0 0 0 3px rgba(51, 178, 210, 0.5);
        
        /* Dormant State */
        --dormant-bg: #1e2022;
        --dormant-border: #3c4043;
    }

    body:not(.dark-mode) {
        --text: #2d3748;
        --text-muted: #718096;
        --bg: #ffffff;
        --card-bg: #ffffff;
        --border: #e2e8f0;
        --input-bg: #f8fafc;
        --card-shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.06);
        --dormant-bg: #f8fafc;
        --dormant-border: #cbd5e0;
    }

    /* === ACCESSIBILITY === */
    .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: var(--primary);
        color: white;
        padding: 8px 16px;
        z-index: 1000;
        text-decoration: none;
        font-weight: 600;
        border-radius: 0 0 8px 0;
        transition: top 0.3s;
    }
    .skip-link:focus { top: 0; outline: none; }

    *:focus-visible {
        outline: 2px solid var(--primary);
        outline-offset: 2px;
    }
    button:focus-visible, input:focus-visible, select:focus-visible {
        box-shadow: var(--focus-ring);
    }

    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    /* === LAYOUT === */
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: var(--bg);
        color: var(--text);
        line-height: 1.5;
        min-height: 100vh;
    }

    .container {
        max-width: 700px;
        margin: 0 auto;
        padding: 8px 10px;
    }

    /* === HEADER === */
    .header {
        max-width: 700px;
        margin: 0 auto;
        padding: 8px 10px;
        display: grid;
        grid-template-columns: auto 1fr auto;
        grid-template-rows: 36px 1fr;
        gap: 0 8px;
        margin-bottom: 4px;
        min-height: 86px;
    }

    .header-logo {
        grid-column: 1;
        grid-row: 1 / -1;
        width: 66px;
        height: 86px;
        display: flex;
        align-items: center;
    }
    .header-logo svg { width: 100%; height: 100%; }

    .logo-light { display: none; }
    .logo-dark { display: block; }
    body:not(.dark-mode) .logo-light { display: block; }
    body:not(.dark-mode) .logo-dark { display: none; }

    .header-title {
        grid-column: 2 / -1;
        grid-row: 2;
        color: var(--primary);
        font-size: 28px;
        font-weight: 700;
        margin: 0;
        display: flex;
        align-items: center;
        white-space: nowrap;
    }

    .header-controls {
        grid-column: 3;
        grid-row: 1;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 8px;
    }

    /* Header Buttons - V3.0 styling: zonder cirkel */
    .header-btn {
        background: transparent;
        border: none;
        width: 20px;
        height: 20px;
        min-width: 36px;
        min-height: 36px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
    }
    .header-btn svg {
        width: 18px;
        height: 18px;
        stroke: var(--text-muted);
        fill: none;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        transition: stroke 0.2s;
    }
    .header-btn:hover svg { stroke: var(--primary); }
    .header-btn.btn-flash svg { stroke: var(--primary); transition: none; }

    /* === COMPONENT CARDS === */
    .component-card {
        position: relative;
        background: var(--card-bg);
        border-radius: clamp(10px, 1.2vw, 14px);
        padding: 4px 10px;
        margin-bottom: 4px;
        border: 1px solid var(--border);
        border-left: 4px solid var(--primary);
        box-shadow: var(--card-shadow);
        display: flex;
        align-items: flex-end;
        gap: 6px;
        transition: background 0.3s ease, border-color 0.3s ease;
    }

    .component-card.dormant {
        border-left-color: var(--dormant-border);
        background: var(--dormant-bg);
    }

    .card-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .card-header {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: clamp(10px, 1.5vw, 16px);
        margin-bottom: 2px;
        padding-right: 30px;
    }

    .card-title {
        font-size: clamp(18px, 3vw, 24px);
        font-weight: 600;
        color: var(--text);
        flex: 1;
    }

    .price-badge {
        background: none;
        color: var(--primary);
        padding: 0;
        font-weight: 700;
        font-size: clamp(18px, 3vw, 24px);
        white-space: nowrap;
        margin-right: 10px;
    }

    .dormant .price-badge {
        color: var(--text-muted);
    }

    /* Info Button - V3.0 styling */
    .info-btn {
        position: absolute;
        top: 8px;
        right: 8px;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        border: none;
        background: transparent;
        color: var(--text-muted);
        font-size: 14px;
        font-weight: 700;
        font-style: italic;
        font-family: Georgia, serif;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: color 0.2s;
        z-index: 10;
        padding: 0;
        line-height: 1;
    }
    .info-btn:hover,
    .info-btn:focus {
        color: var(--primary);
    }
    .info-btn:focus {
        outline: none;
    }

    /* === INPUT FIELDS - V3.0 PARITY === */
    .input-stack {
        display: flex;
        flex-direction: column;
        gap: 2px;
        width: 100%;
    }

    .input-wrapper {
        position: relative;
        width: 100%;
    }

    .input-wrapper input:not([type="checkbox"]),
    .input-wrapper select {
        width: 100%;
        height: 38px;
        padding: 8px 8px;
        border: 2px solid var(--border);
        border-radius: 8px;
        background: var(--card-bg);
        color: var(--text);
        font-size: 16px;
        font-weight: 600;
        line-height: normal;
        transition: border-color 0.3s;
        -webkit-appearance: none;
        appearance: none;
    }

    .input-wrapper input:focus,
    .input-wrapper select:focus {
        outline: none;
        border-color: var(--primary);
    }

    .input-wrapper input::placeholder {
        color: #9ca3af;
        font-size: 17px;
        font-weight: 500;
    }

    .input-wrapper input[type="number"]::-webkit-inner-spin-button,
    .input-wrapper input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    .input-wrapper input[type="number"] {
        -moz-appearance: textfield;
    }

    /* V3.0 Unit & Label Inside Pattern - LINKS gepositioneerd */
    .unit-inside, .label-inside {
        position: absolute;
        left: 13px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
        font-size: 13px;
        font-weight: 400;
        pointer-events: none;
        display: none;
        background: var(--card-bg);
        white-space: nowrap;
    }
    .label-inside { color: #9ca3af; }
    
    /* Show when input has value */
    .input-wrapper input:not(:placeholder-shown) ~ .unit-inside,
    .input-wrapper input:not(:placeholder-shown) ~ .label-inside {
        display: block;
    }
    /* Hide in dormant state */
    .dormant .unit-inside, .dormant .label-inside { display: none !important; }
    /* V11.0: Placeholder-style in dormant state (grey + lighter weight) - V34.5 parity */
    .dormant select, .dormant input { 
        color: var(--text-muted) !important; 
        font-weight: 500 !important; 
    }

    /* Select Styling - V3.0 met SVG arrow */
    .input-wrapper select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23535554' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        cursor: pointer;
    }
    body.dark-mode .input-wrapper select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a0a0a0' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    }
    .input-wrapper select.placeholder-active {
        font-size: 17px;
        font-weight: 500;
        color: #9ca3af;
    }
    .input-wrapper.select-wrapper select:not(.placeholder-active) {
        font-size: 16px;
        font-weight: 600;
        color: var(--text);
        padding-right: 30px;
    }
    .input-wrapper select:not(.placeholder-active) ~ .unit-inside,
    .input-wrapper select:not(.placeholder-active) ~ .label-inside { display: block; }
    .input-wrapper.select-wrapper select.placeholder-active ~ .unit-inside,
    .input-wrapper.select-wrapper select.placeholder-active ~ .label-inside { display: none !important; }
    .input-wrapper select option {
        color: var(--text);
        font-size: 18px;
        background: var(--card-bg);
    }

    /* V9.2: Autex Checkbox Styling - Identiek aan Sales Calculator V30.7 */
    .input-wrapper.checkbox-standalone {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 0;
        margin: 0;
    }
    .input-wrapper.checkbox-standalone input[type="checkbox"] {
        -webkit-appearance: none;
        appearance: none;
        width: 32px;
        height: 32px;
        min-width: 32px;
        min-height: 32px;
        flex-shrink: 0;
        margin: 0;
        padding: 0;
        cursor: pointer;
        border: 2px solid var(--border);
        border-radius: 6px;
        background: var(--card-bg);
        transition: border-color 0.3s, background-color 0.3s;
        position: relative;
    }
    .input-wrapper.checkbox-standalone input[type="checkbox"]:hover {
        border-color: var(--border);
    }
    .input-wrapper.checkbox-standalone input[type="checkbox"]:checked {
        border-color: var(--border);
        background-color: var(--card-bg);
    }
    .input-wrapper.checkbox-standalone input[type="checkbox"]:checked::after {
        content: '';
        position: absolute;
        left: 50%;
        top: 45%;
        transform: translate(-50%, -50%) rotate(45deg);
        width: 6px;
        height: 12px;
        border: solid var(--primary);
        border-width: 0 2px 2px 0;
    }
    .input-wrapper.checkbox-standalone .checkbox-label {
        font-size: clamp(13px, 1.4vw, 15px);
        color: var(--text);
        cursor: pointer;
        user-select: none;
        line-height: 32px;
    }
    .autex-option {
        margin-top: 2px;
    }

    /* === BREAKDOWN - V9.4 Compact zoals V30.7 === */
    .breakdown {
        display: none;
        font-size: 13px;
        margin-top: 4px;
        padding-top: 4px;
        border-top: 1px solid var(--border);
    }

    .breakdown.show {
        display: block;
    }

    .breakdown-row {
        display: flex;
        justify-content: space-between;
        padding: 2px 0;
        color: var(--text-muted);
    }

    .breakdown-row.total {
        font-weight: 700;
        color: var(--primary);
        border-top: 1px solid var(--border);
        margin-top: 2px;
        padding-top: 4px;
    }

    /* === EXTRA SECTION - V9.4 Compact zoals V30.7 === */
    .extra-section {
        margin-bottom: clamp(8px, 1.2vw, 12px);
    }
    /* V9.4: Extra sectie cards compacter zoals V30.7 */
    .extra-section .card-content { gap: 2px; }
    .extra-section .card-title { font-size: clamp(15px, 2.4vw, 20px); margin-bottom: 2px; }
    .extra-section .component-card { margin-bottom: 4px; }

    .section-header {
        background: transparent;
        color: var(--text);
        padding: clamp(6px, 1vw, 10px) 0;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: clamp(18px, 3vw, 24px);
        font-weight: 600;
        transition: color 0.2s;
        border: none;
        width: 100%;
        text-align: left;
    }
    .section-header:hover .section-toggle::after { color: var(--primary-dark); }

    .section-toggle::after {
        content: '+';
        font-size: clamp(18px, 3vw, 24px);
        font-weight: 600;
        color: var(--primary);
    }
    .section-header.expanded .section-toggle::after {
        content: '-';
    }

    .section-content {
        display: none;
        padding-top: clamp(8px, 1.2vw, 12px);
    }
    .section-content.show {
        display: block;
    }

    /* === SUMMARY CARD === */
    .summary-card {
        background: var(--card-bg);
        border: 3px solid var(--primary);
        border-radius: 12px;
        padding: 8px;
        margin-top: 4px;
        box-shadow: var(--card-shadow);
        transition: opacity 0.3s ease, border-color 0.3s ease;
    }

    .summary-card.dormant {
        border-color: var(--dormant-border);
        opacity: 0.5;
    }
    
    /* Dormant state: verberg alles behalve titel en totaal */
    .summary-card.dormant .summary-section-title,
    .summary-card.dormant .summary-row,
    .summary-card.dormant .summary-divider {
        display: none;
    }
    .summary-card.dormant .summary-title {
        margin-bottom: 0;
    }
    .summary-card.dormant .summary-total {
        margin-top: 8px;
        padding-top: 8px;
    }

    .summary-title {
        color: var(--primary);
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .summary-section-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--text);
        margin-top: 12px;
        margin-bottom: 4px;
    }
    .summary-section-title:first-of-type { margin-top: 0; }

    .summary-row {
        display: flex;
        justify-content: space-between;
        padding: 4px 0;
        font-size: 14px;
        color: var(--text-muted);
        border-bottom: 1px solid var(--border);
    }
    .summary-row:last-of-type { border-bottom: none; }
    .summary-row span:last-child { 
        color: var(--text); 
        font-weight: 600; 
    }
    .summary-row.indented { padding-left: 12px; }

    .summary-divider {
        border-top: 2px solid var(--primary);
        margin: 12px 0;
    }

    .summary-total {
        display: flex;
        justify-content: center;
        align-items: center;
        padding-top: 12px;
        border-top: 2px solid var(--primary);
        margin-top: 12px;
    }
    .summary-total .value {
        font-size: 22px;
        font-weight: 900;
        color: var(--primary);
    }

    /* === INVOICE OVERVIEW === */
    .invoice-card {
        background: var(--card-bg);
        border: 3px solid var(--primary);
        border-radius: 12px;
        padding: 8px;
        margin-top: 4px;
        box-shadow: var(--card-shadow);
        transition: opacity 0.3s ease, border-color 0.3s ease;
    }

    .invoice-card.dormant {
        border-color: var(--dormant-border);
        opacity: 0.5;
    }
    
    /* Dormant state: verberg items, toon alleen titel en totaal */
    .invoice-card.dormant #invoice-items {
        display: none;
    }
    .invoice-card.dormant .invoice-title {
        margin-bottom: 0;
    }
    .invoice-card.dormant .invoice-total {
        margin-top: 8px;
    }

    .invoice-title {
        color: var(--primary);
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .invoice-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px 0;
        font-size: 14px;
        border-bottom: 1px solid var(--border);
    }
    .invoice-row:last-of-type { border-bottom: none; }

    .invoice-row .component-name {
        font-weight: 600;
        color: var(--text);
        flex: 1;
    }
    .invoice-row .component-calc {
        color: var(--text-muted);
        margin: 0 10px;
        font-size: 13px;
    }
    .invoice-row .component-total {
        font-weight: 700;
        color: var(--text);
        min-width: 90px;
        text-align: right;
    }

    .invoice-total {
        font-size: 22px;
        font-weight: 900;
        text-align: center;
        margin-top: 12px;
        padding-top: 12px;
        border-top: 2px solid var(--primary);
        color: var(--primary);
    }

    /* === MODAL === */
    /* Modal Overlay - V30.13 Styling */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.75);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        padding: 16px;
    }
    .modal-overlay.active {
        opacity: 1;
        visibility: visible;
    }
    
    /* Modal Card */
    .info-modal {
        background: var(--card-bg);
        border-radius: 12px;
        max-width: 420px;
        width: 100%;
        max-height: 80vh;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        transform: scale(0.9) translateY(20px);
        transition: transform 0.3s ease;
        display: flex;
        flex-direction: column;
        border: 1px solid var(--border);
    }
    .modal-overlay.active .info-modal {
        transform: scale(1) translateY(0);
    }
    
    /* Modal Header */
    .modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px;
        border-bottom: 1px solid var(--border);
        background: var(--card-bg);
    }
    .modal-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--primary);
        margin: 0;
    }
    
    /* Modal Body */
    .modal-body {
        padding: 16px;
        overflow-y: auto;
        flex: 1;
    }
    
    /* Section Title */
    .modal-section-title {
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: var(--text-muted);
        margin-bottom: 10px;
    }
    
    /* Material List */
    .material-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .material-list li {
        padding: 8px 0;
        font-size: 14px;
        color: var(--text);
        display: flex;
        align-items: flex-start;
        gap: 8px;
        border-bottom: 1px solid var(--border);
    }
    .material-list li:last-child {
        border-bottom: none;
    }
    .material-list li::before {
        content: ">";
        color: var(--primary);
        font-weight: 700;
        flex-shrink: 0;
    }
    .material-brand {
        color: var(--text-muted);
        font-size: 13px;
    }
    .material-product {
        font-weight: 600;
    }
    
    /* No Materials Note */
    .no-materials {
        color: var(--text-muted);
        font-size: 14px;
        font-style: italic;
        padding: 8px 0;
    }
    
    /* Subsystem styling */
    .subsystem-title {
        font-size: 12px;
        font-weight: 600;
        color: var(--primary);
        margin: 12px 0 8px 0;
        padding-top: 8px;
        border-top: 1px solid var(--border);
    }
    .subsystem-title:first-child {
        margin-top: 0;
        padding-top: 0;
        border-top: none;
    }
    
    /* V9.20: Modal Total - V30.13 Style */
    .modal-total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0 4px 0;
        border-top: 2px solid var(--primary);
        margin-top: 16px;
    }
    .modal-total .total-label {
        font-size: 14px;
        font-weight: 600;
        color: var(--text);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    .modal-total .total-value {
        font-size: 18px;
        font-weight: 700;
        color: var(--primary);
    }
    
    /* Modal Close Button */
    .modal-close {
        display: block;
        width: 100%;
        padding: 12px;
        background: transparent;
        border: none;
        border-top: 1px solid var(--border);
        color: var(--text-muted);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    .modal-close:hover {
        background: var(--primary);
        color: white;
    }
    
    /* Info Section wrapper */
    .info-section {
        margin-bottom: 0;
    }
    
    /* V9.18: Material Checkbox Styling - Two-line layout */
    .material-checkbox-list {
        list-style: none;
        padding: 0;
        margin: 0 0 12px 0;
    }
    .material-checkbox-item {
        padding: 10px 0;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
    }
    .material-checkbox-item:last-child {
        border-bottom: none;
    }
    .material-checkbox-item .mat-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .material-checkbox-item label {
        display: flex;
        align-items: center;
        gap: 10px;
        cursor: pointer;
        flex: 1;
    }
    .material-checkbox-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        accent-color: var(--primary);
        cursor: pointer;
        flex-shrink: 0;
    }
    .material-checkbox-item .mat-name {
        color: var(--text);
        font-weight: 500;
    }
    .material-checkbox-item .mat-price {
        color: var(--primary);
        font-weight: 600;
        white-space: nowrap;
    }
    .material-checkbox-item .mat-calc {
        margin-left: 28px;
        margin-top: 4px;
        font-size: 12px;
        color: var(--text-muted);
    }
    .material-checkbox-item.disabled label {
        opacity: 0.5;
        text-decoration: line-through;
    }
    .material-checkbox-item.disabled .mat-price {
        color: var(--text-muted);
    }
    .material-checkbox-item.disabled .mat-calc {
        opacity: 0.5;
    }
    .material-checkbox-item .mat-qty {
        margin-left: 28px;
        margin-top: 2px;
        font-size: 12px;
        color: var(--primary);
        font-weight: 500;
    }
    .material-checkbox-item.disabled .mat-qty {
        opacity: 0.5;
        color: var(--text-muted);
    }

    /* === FOOTER - V3.0 STYLING === */
    .summary-footer {
        text-align: right;
        padding-top: 1px;
        padding-right: 10px;
        color: var(--text-muted);
        font-size: 8px;
    }

    /* === PRINT STYLES === */
    @media print {
        .header-controls, .section-header, .skip-link, .info-btn { display: none !important; }
        body { background: white; color: black; }
        .component-card, .summary-card, .invoice-card {
            box-shadow: none;
            border-color: #ccc;
        }
    }
    </style>
</head>
<body class="dark-mode">
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Ga naar inhoud</a>

    <!-- Header -->
    <header class="header" role="banner">
        <div class="header-logo">
            <!-- Logo Zwart (light mode) - Volledig officieel logo -->
            <svg class="logo-light" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 174.77 229.38">
              <defs>
                <style>
                  .stl0 { fill: url(#lg-light-2); }
                  .stl1 { fill: url(#lg-light-10); }
                  .stl2 { fill: url(#lg-light-21); }
                  .stl3 { fill: url(#lg-light-27); }
                  .stl4 { fill: url(#lg-light-26); }
                  .stl5 { fill: url(#lg-light-1); }
                  .stl6 { fill: url(#lg-light-9); }
                  .stl7 { fill: url(#lg-light-18); }
                  .stl8 { fill: url(#lg-light-23); }
                  .stl9 { fill: url(#lg-light-8); }
                  .stl10 { fill: url(#lg-light-11); }
                  .stl11 { fill: none; }
                  .stl12 { fill: url(#lg-light-16); }
                  .stl13 { fill: url(#lg-light-24); }
                  .stl14 { fill: url(#lg-light-3); stroke: #fff; stroke-miterlimit: 10; stroke-width: 8.31px; }
                  .stl15 { fill: #595857; }
                  .stl16 { fill: url(#lg-light-22); }
                  .stl17 { fill: url(#lg-light-29); }
                  .stl18 { fill: url(#lg-light-19); }
                  .stl19 { fill: url(#lg-light-12); }
                  .stl20 { opacity: .89; }
                  .stl21 { fill: url(#lg-light-28); }
                  .stl22 { fill: url(#lg-light-7); }
                  .stl23 { opacity: .56; }
                  .stl24 { fill: url(#lg-light-20); }
                  .stl25 { fill: url(#lg-light-4); }
                  .stl26 { fill: url(#lg-light-14); }
                  .stl27 { fill: url(#lg-light-5); }
                  .stl28 { fill: url(#lg-light-25); }
                  .stl29 { opacity: .77; }
                  .stl30 { fill: url(#lg-light-15); }
                  .stl31 { fill: url(#lg-light-17); }
                  .stl32 { fill: url(#lg-light-6); }
                  .stl33 { fill: url(#lg-light-13); }
                  .stl34 { fill: url(#lg-light-); }
                  .stl35 { clip-path: url(#clippath-light); }
                  .stl36 { opacity: .82; }
                </style>
                <clipPath id="clippath-light">
                  <path class="stl11" d="M117.81,182.78c0,18.65-15.67,33.58-30.25,33.58-16.92,0-30.63-13.85-30.63-33.2s13.71-33.77,30.63-33.77,30.25,14.73,30.25,33.38Z"/>
                </clipPath>
                <linearGradient id="lg-light-" x1="87.56" y1="151.81" x2="87.56" y2="211.1" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="#fff"/>
                  <stop offset="1" stop-color="#41b0d4"/>
                </linearGradient>
                <linearGradient id="lg-light-1" x1="87.67" y1="151.81" x2="87.67" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-2" x1="87.88" y1="151.81" x2="87.88" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-3" x1="116.4" y1="198.14" x2="116.4" y2="198.14" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-4" x1="87.98" y1="151.81" x2="87.98" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-5" x1="60.13" y1="151.81" x2="60.13" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-6" x1="67.28" y1="151.81" x2="67.28" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-7" x1="63.7" y1="151.81" x2="63.7" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-8" x1="67.28" y1="151.81" x2="67.28" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-9" x1="75.83" y1="151.81" x2="75.83" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-10" x1="71.49" y1="151.81" x2="71.49" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-11" x1="75.83" y1="151.81" x2="75.83" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-12" x1="84.17" y1="151.81" x2="84.17" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-13" x1="80.18" y1="151.81" x2="80.18" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-14" x1="84.17" y1="151.81" x2="84.17" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-15" x1="84.3" y1="151.81" x2="84.3" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-16" x1="91.87" y1="151.81" x2="91.87" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-17" x1="87.88" y1="151.81" x2="87.88" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-18" x1="84.3" y1="151.81" x2="84.3" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-19" x1="91.87" y1="151.81" x2="91.87" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-20" x1="100.28" y1="151.81" x2="100.28" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-21" x1="95.91" y1="151.81" x2="95.91" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-22" x1="100.28" y1="151.81" x2="100.28" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-23" x1="108.35" y1="151.81" x2="108.35" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-24" x1="104.27" y1="151.81" x2="104.27" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-25" x1="108.35" y1="151.81" x2="108.35" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-26" x1="115.71" y1="151.81" x2="115.71" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-27" x1="112.13" y1="151.81" x2="112.13" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-28" x1="115.71" y1="151.81" x2="115.71" y2="211.1" xlink:href="#lg-light-"/>
                <linearGradient id="lg-light-29" x1="60.13" y1="151.81" x2="60.13" y2="211.1" xlink:href="#lg-light-"/>
              </defs>
              <g id="Linksboven">
                <g>
                  <g class="stl20">
                    <polygon class="stl15" points="10.32 115.67 45.26 37.87 69.43 81.72 71.21 78.38 46.58 33.8 43.8 33.8 5.2 118.67 8.83 118.67 18 118.67 50.06 118.67 51.73 115.67 10.32 115.67"/>
                    <path class="stl15" d="M131.59,6.77h-3.78c-31.54,71.25-49.7,108.9-61.09,134.47-9.95,22.32-15.43,32.06-16.29,41.78-.92,10.39,2.82,20.75,10.51,29.15,7.43,8.1,17.36,11.12,26.57,11.12,17.15,0,37.09-16.49,37.09-40.12,0-13.38-9.19-30.13-18.92-47.86-1.61-2.93-4.39-8.48-5.97-11.41l-1.98,4.29c1.58,2.94,3.2,5.9,4.82,8.84,9.5,17.32,18.48,33.68,18.48,46.14,0,21.61-18.01,36.54-33.51,36.54-8.22,0-17.17-2.58-23.93-9.96-7-7.65-10.41-17.03-9.59-26.42.8-9.07,6.43-18.53,15.95-40.54,11.74-27.13,28.55-59.66,60.27-133.1h1.38c16.1,0,34.66,11.19,34.66,34.42,0,16.47-14.25,35.46-34.89,35.46h-11.04l-1.68,3.43h12.72c21.98,0,38.71-19.84,38.71-38.89,0-25.47-19.81-37.35-38.48-37.35Z"/>
                  </g>
                  <g class="stl35">
                    <g class="stl29">
                      <rect class="stl34" x="56.82" y="186.79" width="61.47" height="1.66"/>
                    </g>
                    <g class="stl29">
                      <rect class="stl5" x="55.9" y="190.14" width="63.55" height="3.32"/>
                    </g>
                    <g class="stl29">
                      <rect class="stl0" x="56.59" y="194.71" width="62.58" height="3.32"/>
                    </g>
                    <g class="stl23">
                      <path class="stl14" d="M116.4,198.14"/>
                    </g>
                    <g class="stl36">
                      <path class="stl25" d="M58.73,199.53l58.5-.28s-32.09,43.15-58.5.28Z"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl27" cx="60.13" cy="183.16" r="1.05"/>
                      <circle class="stl32" cx="67.28" cy="183.16" r="1.05"/>
                      <circle class="stl22" cx="63.7" cy="179.58" r="1.05"/>
                      <circle class="stl9" cx="67.28" cy="176" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl6" cx="75.83" cy="183.1" r="1.05"/>
                      <circle class="stl1" cx="71.49" cy="179.53" r="1.05"/>
                      <circle class="stl10" cx="75.83" cy="175.95" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl19" cx="84.17" cy="183.16" r="1.05"/>
                      <circle class="stl33" cx="80.18" cy="179.58" r="1.05"/>
                      <circle class="stl26" cx="84.17" cy="176" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl30" cx="84.3" cy="183.1" r="1.05"/>
                      <circle class="stl12" cx="91.87" cy="183.1" r="1.05"/>
                      <circle class="stl31" cx="87.88" cy="179.53" r="1.05"/>
                      <circle class="stl7" cx="84.3" cy="175.95" r="1.05"/>
                      <circle class="stl18" cx="91.87" cy="175.95" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl24" cx="100.28" cy="183.16" r="1.05"/>
                      <circle class="stl2" cx="95.91" cy="179.47" r="1.05"/>
                      <circle class="stl16" cx="100.28" cy="175.95" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl8" cx="108.35" cy="183.16" r="1.05"/>
                      <circle class="stl13" cx="104.27" cy="179.47" r="1.05"/>
                      <circle class="stl28" cx="108.35" cy="175.95" r="1.05"/>
                    </g>
                    <g class="stl36">
                      <circle class="stl4" cx="115.71" cy="183.15" r="1.05"/>
                      <circle class="stl3" cx="112.13" cy="179.57" r="1.05"/>
                      <circle class="stl21" cx="115.71" cy="175.99" r="1.05"/>
                    </g>
                    <circle class="stl17" cx="60.13" cy="175.95" r="1.05"/>
                  </g>
                </g>
              </g>
            </svg>
            <!-- Logo Wit (dark mode) - Volledig officieel logo -->
            <svg class="logo-dark" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 180.19 238.52">
              <defs>
                <style>
                  .std0 { fill: url(#lg-dark-2); }
                  .std1 { fill: url(#lg-dark-10); }
                  .std2 { fill: url(#lg-dark-21); }
                  .std3 { fill: url(#lg-dark-27); }
                  .std4 { fill: #fff; }
                  .std5 { fill: url(#lg-dark-26); }
                  .std6 { fill: url(#lg-dark-1); }
                  .std7 { fill: url(#lg-dark-9); }
                  .std8 { fill: url(#lg-dark-18); }
                  .std9 { fill: url(#lg-dark-23); }
                  .std10 { fill: url(#lg-dark-8); }
                  .std11 { fill: url(#lg-dark-11); }
                  .std12 { fill: none; }
                  .std13 { fill: url(#lg-dark-16); }
                  .std14 { fill: url(#lg-dark-24); }
                  .std15 { fill: url(#lg-dark-3); stroke: #fff; stroke-miterlimit: 10; stroke-width: 8.31px; }
                  .std16 { fill: url(#lg-dark-22); }
                  .std17 { fill: url(#lg-dark-29); }
                  .std18 { fill: url(#lg-dark-19); }
                  .std19 { fill: url(#lg-dark-12); }
                  .std20 { opacity: .89; }
                  .std21 { fill: url(#lg-dark-28); }
                  .std22 { fill: url(#lg-dark-7); }
                  .std23 { opacity: .56; }
                  .std24 { fill: url(#lg-dark-20); }
                  .std25 { fill: url(#lg-dark-4); }
                  .std26 { fill: url(#lg-dark-14); }
                  .std27 { fill: url(#lg-dark-5); }
                  .std28 { fill: url(#lg-dark-25); }
                  .std29 { opacity: .77; }
                  .std30 { fill: url(#lg-dark-15); }
                  .std31 { fill: url(#lg-dark-17); }
                  .std32 { fill: url(#lg-dark-6); }
                  .std33 { display: none; fill: #1a1a1e; }
                  .std34 { fill: url(#lg-dark-13); }
                  .std35 { fill: url(#lg-dark-); }
                  .std36 { clip-path: url(#clippath-dark); }
                  .std37 { opacity: .82; }
                </style>
                <clipPath id="clippath-dark">
                  <path class="std12" d="M119.82,184.32c0,18.65-15.67,33.58-30.25,33.58-16.92,0-30.63-13.85-30.63-33.2s13.71-33.77,30.63-33.77,30.25,14.73,30.25,33.38Z"/>
                </clipPath>
                <linearGradient id="lg-dark-" x1="89.57" y1="153.35" x2="89.57" y2="212.64" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="#fff"/>
                  <stop offset="1" stop-color="#41b0d4"/>
                </linearGradient>
                <linearGradient id="lg-dark-1" x1="89.68" y1="153.35" x2="89.68" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-2" x1="89.89" y1="153.35" x2="89.89" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-3" x1="118.41" y1="199.69" x2="118.41" y2="199.69" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-4" x1="90" y1="153.35" x2="90" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-5" x1="62.14" y1="153.35" x2="62.14" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-6" x1="69.3" y1="153.35" x2="69.3" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-7" x1="65.72" y1="153.35" x2="65.72" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-8" x1="69.3" y1="153.35" x2="69.3" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-9" x1="77.85" y1="153.35" x2="77.85" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-10" x1="73.51" y1="153.35" x2="73.51" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-11" x1="77.85" y1="153.35" x2="77.85" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-12" x1="86.19" y1="153.35" x2="86.19" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-13" x1="82.19" y1="153.35" x2="82.19" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-14" x1="86.19" y1="153.35" x2="86.19" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-15" x1="86.31" y1="153.35" x2="86.31" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-16" x1="93.88" y1="153.35" x2="93.88" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-17" x1="89.89" y1="153.35" x2="89.89" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-18" x1="86.31" y1="153.35" x2="86.31" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-19" x1="93.88" y1="153.35" x2="93.88" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-20" x1="102.3" y1="153.35" x2="102.3" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-21" x1="97.92" y1="153.35" x2="97.92" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-22" x1="102.3" y1="153.35" x2="102.3" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-23" x1="110.36" y1="153.35" x2="110.36" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-24" x1="106.28" y1="153.35" x2="106.28" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-25" x1="110.36" y1="153.35" x2="110.36" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-26" x1="117.72" y1="153.35" x2="117.72" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-27" x1="114.14" y1="153.35" x2="114.14" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-28" x1="117.72" y1="153.35" x2="117.72" y2="212.64" xlink:href="#lg-dark-"/>
                <linearGradient id="lg-dark-29" x1="62.14" y1="153.35" x2="62.14" y2="212.64" xlink:href="#lg-dark-"/>
              </defs>
              <rect id="Achtergrond_-_zwart" class="std33" x="-43.04" y="-10.29" width="614.97" height="269.58"/>
              <g id="Linksboven">
                <g>
                  <g class="std20">
                    <polygon class="std4" points="12.33 117.21 47.27 39.41 71.44 83.27 73.22 79.93 48.6 35.34 45.82 35.34 7.21 120.21 10.85 120.21 20.01 120.21 52.07 120.21 53.74 117.21 12.33 117.21"/>
                    <path class="std4" d="M133.6,8.32h-3.78c-31.54,71.25-49.7,108.9-61.09,134.47-9.95,22.32-15.43,32.06-16.29,41.78-.92,10.39,2.82,20.75,10.51,29.15,7.43,8.1,17.36,11.12,26.57,11.12,17.15,0,37.09-16.49,37.09-40.12,0-13.38-9.19-30.13-18.92-47.86-1.61-2.93-4.39-8.48-5.97-11.41l-1.98,4.29c1.58,2.94,3.2,5.9,4.82,8.84,9.5,17.32,18.48,33.68,18.48,46.14,0,21.61-18.01,36.54-33.51,36.54-8.22,0-17.17-2.58-23.93-9.96-7-7.65-10.41-17.03-9.59-26.42.8-9.07,6.43-18.53,15.95-40.54,11.74-27.13,28.55-59.66,60.27-133.1h1.38c16.1,0,34.66,11.19,34.66,34.42,0,16.47-14.25,35.46-34.89,35.46h-11.04l-1.68,3.43h12.72c21.98,0,38.71-19.84,38.71-38.89,0-25.47-19.81-37.35-38.48-37.35Z"/>
                  </g>
                  <g class="std36">
                    <g class="std29">
                      <rect class="std35" x="58.83" y="188.34" width="61.47" height="1.66"/>
                    </g>
                    <g class="std29">
                      <rect class="std6" x="57.91" y="191.68" width="63.55" height="3.32"/>
                    </g>
                    <g class="std29">
                      <rect class="std0" x="58.6" y="196.25" width="62.58" height="3.32"/>
                    </g>
                    <g class="std23">
                      <path class="std15" d="M118.41,199.69"/>
                    </g>
                    <g class="std37">
                      <path class="std25" d="M60.75,201.07l58.5-.28s-32.09,43.15-58.5.28Z"/>
                    </g>
                    <g class="std37">
                      <circle class="std27" cx="62.14" cy="184.7" r="1.05"/>
                      <circle class="std32" cx="69.3" cy="184.7" r="1.05"/>
                      <circle class="std22" cx="65.72" cy="181.13" r="1.05"/>
                      <circle class="std10" cx="69.3" cy="177.55" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std7" cx="77.85" cy="184.65" r="1.05"/>
                      <circle class="std1" cx="73.51" cy="181.07" r="1.05"/>
                      <circle class="std11" cx="77.85" cy="177.49" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std19" cx="86.19" cy="184.7" r="1.05"/>
                      <circle class="std34" cx="82.19" cy="181.13" r="1.05"/>
                      <circle class="std26" cx="86.19" cy="177.55" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std30" cx="86.31" cy="184.65" r="1.05"/>
                      <circle class="std13" cx="93.88" cy="184.65" r="1.05"/>
                      <circle class="std31" cx="89.89" cy="181.07" r="1.05"/>
                      <circle class="std8" cx="86.31" cy="177.49" r="1.05"/>
                      <circle class="std18" cx="93.88" cy="177.49" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std24" cx="102.3" cy="184.7" r="1.05"/>
                      <circle class="std2" cx="97.92" cy="181.01" r="1.05"/>
                      <circle class="std16" cx="102.3" cy="177.49" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std9" cx="110.36" cy="184.7" r="1.05"/>
                      <circle class="std14" cx="106.28" cy="181.01" r="1.05"/>
                      <circle class="std28" cx="110.36" cy="177.49" r="1.05"/>
                    </g>
                    <g class="std37">
                      <circle class="std5" cx="117.72" cy="184.69" r="1.05"/>
                      <circle class="std3" cx="114.14" cy="181.12" r="1.05"/>
                      <circle class="std21" cx="117.72" cy="177.54" r="1.05"/>
                    </g>
                    <circle class="std17" cx="62.14" cy="177.49" r="1.05"/>
                  </g>
                </g>
              </g>
            </svg>
        </div>
        <h1 class="header-title">Subcalculator</h1>
        <div class="header-controls">
            <button type="button" id="theme-toggle-btn" class="header-btn" 
                    aria-label="Wissel thema">
                <svg id="theme-icon" viewBox="0 0 24 24" 
                     aria-hidden="true" focusable="false">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
            <button type="button" id="reset-btn" class="header-btn" 
                    aria-label="Reset calculator">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                    <path d="M3 3v5h5"></path>
                </svg>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <main id="main-content" role="main">

            <!-- Hoofdcomponenten -->
            <div class="components-grid">
                
                <!-- Afkappen -->
                <section class="component-card dormant" id="card-afkappen" 
                         aria-labelledby="title-afkappen">
                    <button type="button" class="info-btn" tabindex="-1"
                            onclick="showInfo('afkappen')" aria-label="Info afkappen">i</button>
                    <div class="card-content">
                        <div class="card-header">
                            <h2 class="card-title" id="title-afkappen">Afkappen</h2>
                            <span class="price-badge" id="price-afkappen">€ 0,00/m²</span>
                        </div>
                        <div class="input-stack">
                            <div class="input-wrapper">
                                <label for="afkappen" class="sr-only">Afkappen oppervlakte in m²</label>
                                <input type="text" id="afkappen" 
                                       inputmode="decimal"
                                       placeholder="Afkappen oppervlakte (m²)"
                                       data-field="afkappen"
                                       autocomplete="off"
                                       enterkeyhint="next">
                                <span class="unit-inside" aria-hidden="true">m²</span>
                                <span class="label-inside" aria-hidden="true">afkappen oppervlakte</span>
                            </div>
                        </div>
                        <div class="breakdown" id="breakdown-afkappen">
                            <div class="breakdown-row">
                                <span>Materiaal:</span>
                                <span id="mat-afkappen">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Arbeid:</span>
                                <span id="arb-afkappen">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Tijd:</span>
                                <span id="tijd-afkappen">0u 0m</span>
                            </div>
                            <div class="breakdown-row total">
                                <span>Totaal:</span>
                                <span id="tot-afkappen">€ 0</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Injecties -->
                <section class="component-card dormant" id="card-injecties" 
                         aria-labelledby="title-injecties">
                    <button type="button" class="info-btn" tabindex="-1"
                            onclick="showInfo('injecties')" aria-label="Info injecties">i</button>
                    <div class="card-content">
                        <div class="card-header">
                            <h2 class="card-title" id="title-injecties">Injecties</h2>
                            <span class="price-badge" id="price-injecties">€ 0,00/m</span>
                        </div>
                        <div class="input-stack">
                            <div class="input-wrapper">
                                <label for="injecties" class="sr-only">Injecties lengte in m</label>
                                <input type="text" id="injecties" 
                                       inputmode="decimal"
                                       placeholder="Injecties lengte (m)"
                                       data-field="injecties"
                                       autocomplete="off"
                                       enterkeyhint="next">
                                <span class="unit-inside" aria-hidden="true">m</span>
                                <span class="label-inside" aria-hidden="true">injecties lengte</span>
                            </div>
                        </div>
                        <div class="breakdown" id="breakdown-injecties">
                            <div class="breakdown-row">
                                <span>Materiaal:</span>
                                <span id="mat-injecties">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Arbeid:</span>
                                <span id="arb-injecties">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Tijd:</span>
                                <span id="tijd-injecties">0u 0m</span>
                            </div>
                            <div class="breakdown-row total">
                                <span>Totaal:</span>
                                <span id="tot-injecties">€ 0</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Membraan -->
                <section class="component-card dormant" id="card-membraan" 
                         aria-labelledby="title-membraan">
                    <button type="button" class="info-btn" tabindex="-1"
                            onclick="showInfo('membraan')" aria-label="Info membraan">i</button>
                    <div class="card-content">
                        <div class="card-header">
                            <h2 class="card-title" id="title-membraan">SNC-membraan</h2>
                            <span class="price-badge" id="price-membraan">€ 0,00/m²</span>
                        </div>
                        <div class="input-stack">
                            <div class="input-wrapper">
                                <label for="membraan" class="sr-only">Membraan oppervlakte in m²</label>
                                <input type="text" id="membraan" 
                                       inputmode="decimal"
                                       placeholder="Membraan oppervlakte (m²)"
                                       data-field="membraan"
                                       autocomplete="off"
                                       enterkeyhint="next">
                                <span class="unit-inside" aria-hidden="true">m²</span>
                                <span class="label-inside" aria-hidden="true">membraan oppervlakte</span>
                            </div>
                        </div>
                        <div class="breakdown" id="breakdown-membraan">
                            <div class="breakdown-row">
                                <span>Materiaal:</span>
                                <span id="mat-membraan">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Arbeid:</span>
                                <span id="arb-membraan">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Tijd:</span>
                                <span id="tijd-membraan">0u 0m</span>
                            </div>
                            <div class="breakdown-row total">
                                <span>Totaal:</span>
                                <span id="tot-membraan">€ 0</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Bezetten -->
                <section class="component-card dormant" id="card-bezetten" 
                         aria-labelledby="title-bezetten">
                    <button type="button" class="info-btn" tabindex="-1"
                            onclick="showInfo('bezetten')" aria-label="Info bezetten">i</button>
                    <div class="card-content">
                        <div class="card-header">
                            <h2 class="card-title" id="title-bezetten">Bezetten</h2>
                            <span class="price-badge" id="price-bezetten">€ 0,00/m²</span>
                        </div>
                        <div class="input-stack">
                            <div class="input-wrapper">
                                <label for="bezetten" class="sr-only">Bezetten oppervlakte in m²</label>
                                <input type="text" id="bezetten" 
                                       inputmode="decimal"
                                       placeholder="Bezetten oppervlakte (m²)"
                                       data-field="bezetten"
                                       autocomplete="off"
                                       enterkeyhint="go">
                                <span class="unit-inside" aria-hidden="true">m²</span>
                                <span class="label-inside" aria-hidden="true">bezetten oppervlakte</span>
                            </div>
                        </div>
                        <div class="breakdown" id="breakdown-bezetten">
                            <div class="breakdown-row">
                                <span>Materiaal:</span>
                                <span id="mat-bezetten">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Arbeid:</span>
                                <span id="arb-bezetten">€ 0</span>
                            </div>
                            <div class="breakdown-row">
                                <span>Tijd:</span>
                                <span id="tijd-bezetten">0u 0m</span>
                            </div>
                            <div class="breakdown-row total">
                                <span>Totaal:</span>
                                <span id="tot-bezetten">€ 0</span>
                            </div>
                        </div>
                    </div>
                </section>

            </div>

            <!-- Bijkomend werk sectie -->
            <div class="extra-section">
                <button type="button" class="section-header" id="bijkomend-header"
                        aria-expanded="false" aria-controls="bijkomend-content">
                    <span class="section-toggle" aria-hidden="true"></span>
                    Bijkomend werk
                </button>
                <div class="section-content" id="bijkomend-content">
                    <div class="components-grid">
                        
                        <!-- Hoekprofielen -->
                        <section class="component-card dormant" id="card-hoekprofielen" 
                                 aria-labelledby="title-hoekprofielen">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('hoekprofielen')" 
                                    aria-label="Info hoekprofielen">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-hoekprofielen">Hoekprofiel(en)</h2>
                                    <span class="price-badge" id="price-hoekprofielen">€ 0,00/m</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper">
                                        <label for="hoekprofielen" class="sr-only">
                                            Hoekprofielen lengte in m</label>
                                        <input type="text" id="hoekprofielen" 
                                               inputmode="decimal"
                                               placeholder="Hoekprofielen lengte (m)"
                                               data-field="hoekprofielen"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m</span>
                                        <span class="label-inside" aria-hidden="true">hoekprofielen lengte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-hoekprofielen">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-hoekprofielen">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-hoekprofielen">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-hoekprofielen">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-hoekprofielen">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Bijkomend pleisterwerk -->
                        <section class="component-card dormant" id="card-bijkomendpleister" 
                                 aria-labelledby="title-bijkomendpleister">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('bijkomendpleister')" 
                                    aria-label="Info bijkomend pleisterwerk">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-bijkomendpleister">
                                        Bijkomend pleisterwerk</h2>
                                    <span class="price-badge" id="price-bijkomendpleister">
                                        € 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper">
                                        <label for="bijkomendpleister" class="sr-only">
                                            Bijkomend pleisterwerk zakken</label>
                                        <input type="text" id="bijkomendpleister" 
                                               inputmode="decimal"
                                               placeholder="Bijkomend pleisterwerk (zakken 25kg)"
                                               data-field="bijkomendpleister"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">zakken</span>
                                        <span class="label-inside" aria-hidden="true">bijkomend pleisterwerk</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-bijkomendpleister">
                                    <div class="breakdown-row">
                                        <span>Totale dikte:</span>
                                        <span id="totale-dikte-bijkomendpleister">0 cm</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Extra dikte:</span>
                                        <span id="extra-dikte-bijkomendpleister">0 cm</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-bijkomendpleister">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Egalisatie -->
                        <section class="component-card dormant" id="card-egalisatie" 
                                 aria-labelledby="title-egalisatie">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('egalisatie')" 
                                    aria-label="Info egalisatie">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-egalisatie">
                                        Bijkomende egalisatie</h2>
                                    <span class="price-badge" id="price-egalisatie">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper">
                                        <label for="egalisatie" class="sr-only">
                                            Egalisatie zakken Mixemsub</label>
                                        <input type="text" id="egalisatie" 
                                               inputmode="decimal"
                                               placeholder="Egalisatie (zakken Mixemsub)"
                                               data-field="egalisatie"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">zakken</span>
                                        <span class="label-inside" aria-hidden="true">egalisatie</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-egalisatie">
                                    <div class="breakdown-row">
                                        <span>Totale dikte:</span>
                                        <span id="totale-dikte-egalisatie">0 mm</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-egalisatie">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                    </div>
                </div>
            </div>

            <!-- Extra componenten sectie -->
            <div class="extra-section">
                <button type="button" class="section-header" id="extra-header"
                        aria-expanded="false" aria-controls="extra-content">
                    <span class="section-toggle" aria-hidden="true"></span>
                    Extra componenten
                </button>
                <div class="section-content" id="extra-content">
                    <div class="components-grid">
                        
                        <!-- Grondering Muur -->
                        <section class="component-card dormant" id="card-grondering" 
                                 aria-labelledby="title-grondering">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('grondering')" 
                                    aria-label="Info Grondering">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-grondering">Grondering Muur</h2>
                                    <span class="price-badge" id="price-grondering">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper select-wrapper">
                                        <label for="product-grondering" class="sr-only">Selecteer gronderingsproduct</label>
                                        <select id="product-grondering" data-field="product_grondering" class="placeholder-active">
                                            <option value="" disabled selected>Gronderingsproduct</option>
                                            <option value="betocontact">Knauf, Betokontakt</option>
                                            <option value="stucprimer">Knauf, Stuc Primer</option>
                                            <option value="keisol_mb">Remmers, Keisol MB</option>
                                            <option value="sopro_gd749">Sopro, GD749</option>
                                            <option value="technicure_as">Technichem, Technicure AS</option>
                                            <option value="technicure_cs">Technichem, Technicure CS</option>
                                        </select>
                                    </div>
                                    <div class="input-wrapper">
                                        <label for="grondering" class="sr-only">Grondering oppervlakte in m²</label>
                                        <input type="text" id="grondering" 
                                               inputmode="decimal"
                                               placeholder="Grondering oppervlakte (m²)"
                                               data-field="grondering"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">grondering oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-grondering">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-grondering">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-grondering">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-grondering">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-grondering">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Fix & Finish -->
                        <section class="component-card dormant" id="card-fixfinish" 
                                 aria-labelledby="title-fixfinish">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('fixfinish')" 
                                    aria-label="Info Fix Finish">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-fixfinish">Fix & Finish</h2>
                                    <span class="price-badge" id="price-fixfinish">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper">
                                        <label for="fixfinish" class="sr-only">
                                            Fix & Finish oppervlakte in m²</label>
                                        <input type="text" id="fixfinish" 
                                               inputmode="decimal"
                                               placeholder="Fix & Finish oppervlakte (m²)"
                                               data-field="fixfinish"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">fix & finish oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-fixfinish">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-fixfinish">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-fixfinish">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-fixfinish">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-fixfinish">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- XPS isolatie -->
                        <section class="component-card dormant" id="card-xps" 
                                 aria-labelledby="title-xps">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('xps')" aria-label="Info XPS">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-xps">XPS-isolatie</h2>
                                    <span class="price-badge" id="price-xps">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper select-wrapper">
                                        <label for="xps-dikte" class="sr-only">Selecteer dikte XPS plaat</label>
                                        <select id="xps-dikte" data-field="dikte_xps" class="placeholder-active">
                                            <option value="" disabled selected>Dikte XPS plaat (mm)</option>
                                            <option value="20">20</option>
                                            <option value="30">30</option>
                                            <option value="40">40</option>
                                            <option value="50">50</option>
                                            <option value="60">60</option>
                                        </select>
                                        <span class="unit-inside" aria-hidden="true">mm</span>
                                        <span class="label-inside" aria-hidden="true">dikte xps plaat</span>
                                    </div>
                                    <div class="input-wrapper select-wrapper">
                                        <label for="xps-gitex" class="sr-only">Gitex afwerking methode XPS</label>
                                        <select id="xps-gitex" data-field="gitex_xps">
                                            <option value="naden" selected>Naden verstevigen met Gitex</option>
                                            <option value="volledig">Volledig oppervlak met Gitex</option>
                                        </select>
                                    </div>
                                    <div class="input-wrapper">
                                        <label for="xps" class="sr-only">XPS isolatie oppervlakte in m²</label>
                                        <input type="text" id="xps" 
                                               inputmode="decimal"
                                               placeholder="XPS isolatie oppervlakte (m²)"
                                               data-field="xps"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">xps isolatie oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-xps">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-xps">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-xps">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-xps">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-xps">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>


                        <!-- Wedi Bouwplatensysteem -->
                        <section class="component-card dormant" id="card-wedi" 
                                 aria-labelledby="title-wedi">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('wedi')" aria-label="Info Wedi">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-wedi">Wedi Bouwplatensysteem</h2>
                                    <span class="price-badge" id="price-wedi">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper select-wrapper">
                                        <label for="wedi-dikte" class="sr-only">Dikte Wedi plaat</label>
                                        <select id="wedi-dikte" data-field="dikte_wedi" class="placeholder-active">
                                            <option value="" disabled selected>Dikte Wedi plaat (mm)</option>
                                            <option value="4">4</option>
                                            <option value="6">6</option>
                                            <option value="10">10</option>
                                        </select>
                                        <span class="unit-inside" aria-hidden="true">mm</span>
                                        <span class="label-inside" aria-hidden="true">dikte wedi plaat</span>
                                    </div>
                                    <div class="input-wrapper select-wrapper">
                                        <label for="wedi-gitex" class="sr-only">Gitex afwerking methode</label>
                                        <select id="wedi-gitex" data-field="gitex_wedi">
                                            <option value="naden" selected>Naden verstevigen met Gitex</option>
                                            <option value="volledig">Volledig oppervlak met Gitex</option>
                                        </select>
                                    </div>
                                    <div class="input-wrapper">
                                        <label for="wedi" class="sr-only">Wedi oppervlakte in m²</label>
                                        <input type="text" id="wedi" 
                                               inputmode="decimal"
                                               placeholder="Wedi bouwplaten oppervlakte (m²)"
                                               data-field="wedi"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">wedi oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-wedi">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-wedi">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-wedi">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-wedi">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-wedi">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Fassa Shield -->
                        <section class="component-card dormant" id="card-fassashield" 
                                 aria-labelledby="title-fassashield">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('fassashield')" 
                                    aria-label="Info Fassa Shield">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-fassashield">Fassa Shield</h2>
                                    <span class="price-badge" id="price-fassashield">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper">
                                        <label for="fassashield" class="sr-only">
                                            Fassa Shield oppervlakte in m²</label>
                                        <input type="text" id="fassashield" 
                                               inputmode="decimal"
                                               placeholder="Fassa Shield oppervlakte (m²)"
                                               data-field="fassashield"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">fassa shield oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-fassashield">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-fassashield">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-fassashield">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-fassashield">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-fassashield">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Compacte dichting -->
                        <section class="component-card dormant" id="card-ultradun" 
                                 aria-labelledby="title-ultradun">
                            <button type="button" class="info-btn" tabindex="-1"
                                    onclick="showInfo('ultradun')" 
                                    aria-label="Info compacte dichting">i</button>
                            <div class="card-content">
                                <div class="card-header">
                                    <h2 class="card-title" id="title-ultradun">Compacte dichting</h2>
                                    <span class="price-badge" id="price-ultradun">€ 0,00/m²</span>
                                </div>
                                <div class="input-stack">
                                    <div class="input-wrapper select-wrapper">
                                        <label for="ultradun-systeem" class="sr-only">Selecteer waterdichtingssysteem</label>
                                        <select id="ultradun-systeem" data-field="systeem_ultradun" class="placeholder-active">
                                            <option value="" disabled selected>Waterdichtingssysteem</option>
                                            <option value="asocret">Asocret-M30 systeem</option>
                                            <option value="sopro">Sopro systeem</option>
                                            <option value="sulfatex">Sulfatex systeem</option>
                                        </select>
                                    </div>
                                    <!-- V9.10: Autex dropdown TUSSEN systeem en sopro-lagen -->
                                    <div class="input-wrapper select-wrapper" id="asocret-autex-wrapper" style="display: none;">
                                        <label for="asocret-autex" class="sr-only">Autex glasvezelwapening</label>
                                        <select id="asocret-autex" data-field="autex_asocret">
                                            <option value="zonder" selected>Zonder Autex glasvezelwapening</option>
                                            <option value="met">Met Autex glasvezelwapening</option>
                                        </select>
                                    </div>
                                    <!-- V10.8: Asocret dikte dropdown -->
                                    <div class="input-wrapper select-wrapper" id="asocret-dikte-wrapper" style="display: none;">
                                        <label for="asocret-dikte" class="sr-only">Laagdikte Asocret</label>
                                        <select id="asocret-dikte" data-field="dikte_asocret">
                                            <option value="10" selected>10mm: Licht</option>
                                            <option value="15">15mm: Standaard</option>
                                            <option value="20">20mm: Zwaar</option>
                                        </select>
                                    </div>
                                    <!-- V10.6: Sopro Autex dropdown -->
                                    <div class="input-wrapper select-wrapper" id="sopro-autex-wrapper" style="display: none;">
                                        <label for="sopro-autex" class="sr-only">Autex glasvezelwapening Sopro</label>
                                        <select id="sopro-autex" data-field="autex_sopro">
                                            <option value="zonder" selected>Zonder Autex glasvezelwapening</option>
                                            <option value="met">Met Autex glasvezelwapening</option>
                                        </select>
                                    </div>
                                    <div class="input-wrapper select-wrapper" id="sopro-lagen-wrapper" style="display: none;">
                                        <label for="sopro-lagen" class="sr-only">Aantal lagen Sopro</label>
                                        <select id="sopro-lagen" data-field="lagen_sopro">
                                            <option value="2" selected>2 lagen</option>
                                            <option value="3">3 lagen</option>
                                            <option value="4">4 lagen</option>
                                        </select>
                                    </div>
                                    <!-- V10.7: Sulfatex Autex dropdown -->
                                    <div class="input-wrapper select-wrapper" id="sulfatex-autex-wrapper" style="display: none;">
                                        <label for="sulfatex-autex" class="sr-only">Autex glasvezelwapening Sulfatex</label>
                                        <select id="sulfatex-autex" data-field="autex_sulfatex">
                                            <option value="zonder" selected>Zonder Autex glasvezelwapening</option>
                                            <option value="met">Met Autex glasvezelwapening</option>
                                        </select>
                                    </div>
                                    <!-- V10.7: Sulfatex lagen dropdown -->
                                    <div class="input-wrapper select-wrapper" id="sulfatex-lagen-wrapper" style="display: none;">
                                        <label for="sulfatex-lagen" class="sr-only">Aantal lagen Sulfatex</label>
                                        <select id="sulfatex-lagen" data-field="lagen_sulfatex">
                                            <option value="2" selected>2 lagen (3,2mm)</option>
                                            <option value="3">3 lagen (4,8mm)</option>
                                        </select>
                                    </div>
                                    <div class="input-wrapper">
                                        <label for="ultradun" class="sr-only">
                                            Waterdichting oppervlakte in m²</label>
                                        <input type="text" id="ultradun" 
                                               inputmode="decimal"
                                               placeholder="Waterdichting oppervlakte (m²)"
                                               data-field="ultradun"
                                               autocomplete="off">
                                        <span class="unit-inside" aria-hidden="true">m²</span>
                                        <span class="label-inside" aria-hidden="true">waterdichting oppervlakte</span>
                                    </div>
                                </div>
                                <div class="breakdown" id="breakdown-ultradun">
                                    <div class="breakdown-row">
                                        <span>Materiaal:</span>
                                        <span id="mat-ultradun">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Arbeid:</span>
                                        <span id="arb-ultradun">€ 0</span>
                                    </div>
                                    <div class="breakdown-row">
                                        <span>Tijd:</span>
                                        <span id="tijd-ultradun">0u 0m</span>
                                    </div>
                                    <div class="breakdown-row total">
                                        <span>Totaal:</span>
                                        <span id="tot-ultradun">€ 0</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                    </div>
                </div>
            </div>

            <!-- Summary Card -->
            <aside class="summary-card dormant" id="summary" aria-label="Totaaloverzicht">
                <h2 class="summary-title">Totaaloverzicht</h2>
                
                <div class="summary-section-title" id="hoofdcomponenten-title">Hoofdcomponenten</div>
                
                <div class="summary-row">
                    <span>Tijd:</span>
                    <span id="total-tijd">0u 0m</span>
                </div>
                <div class="summary-row">
                    <span>Arbeid:</span>
                    <span id="total-arbeid">€ 0,00</span>
                </div>
                <div class="summary-row">
                    <span>Materiaal:</span>
                    <span id="total-materiaal">€ 0,00</span>
                </div>
                <div class="summary-row">
                    <span>T&O:</span>
                    <span id="total-to">€ 0,00</span>
                </div>
                
                <div class="summary-section-title" id="bijkomend-title" style="display: none;">
                    Bijkomend werk</div>
                
                <div class="summary-row indented" id="row-hoekprofielen" style="display: none;">
                    <span>Hoekprofielen:</span>
                    <span id="total-hoekprofielen">€ 0,00</span>
                </div>
                <div class="summary-row indented" id="row-bijkomendpleister" style="display: none;">
                    <span>Bijkomend pleister:</span>
                    <span id="total-bijkomendpleister">€ 0,00</span>
                </div>
                <div class="summary-row indented" id="row-egalisatie" style="display: none;">
                    <span>Egalisatie:</span>
                    <span id="total-egalisatie">€ 0,00</span>
                </div>
                
                <div class="summary-divider"></div>
                
                <div class="summary-row">
                    <span>Marge (25%):</span>
                    <span id="total-winst">€ 0,00</span>
                </div>
                
                <div class="summary-total">
                    <span class="value" id="total-prijs">€ 0,00</span>
                </div>
            </aside>

            <!-- Invoice Overview -->
            <aside class="invoice-card dormant" id="invoice" aria-label="Factuuroverzicht">
                <h2 class="invoice-title">Factuuroverzicht</h2>
                <div id="invoice-items">
                    <!-- Dynamisch gevuld -->
                </div>
                <div class="invoice-total" id="invoice-total">€ 0,00</div>
            </aside>

            <div class="summary-footer">© 2025 Vecon</div>

        </main>
    </div>

    <!-- Info Modal - V30.13 Styling -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
        <div class="info-modal" id="infoModal" role="dialog" aria-modal="true">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-title">Component Info</h4>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamisch gevuld -->
            </div>
            <button type="button" class="modal-close" onclick="closeModal()">Sluiten</button>
        </div>
    </div>

    <script>
    /* ============================================================
       JAVASCRIPT - AQP SUBCALCULATOR V8.0
       ============================================================ */

    // === CONSTANTEN ===
    const LOON = 48.03;
    const TO_PER_DAG = 208;

    // V10: Hoofdcomponenten configuratie (dynamische materiaalkosten)
    const COMP = {
        afkappen: { cap_per_man: 35, mat: 0 },
        injecties: { cap_per_man: 60, mat: 2.84 },  // V10: Fassa Inject EUR 14,22/L x 0,2 L/m
        membraan: { cap_per_man: 40, mat: 7.98 },   // V10.10: CODEX 3,95 + SNC 4,03
        bezetten: { cap_per_man: 20, mat: 5.45 }    // V10: MP75 15 kg x € 0,3632/kg
    };

    // Extra componenten configuratie
    const XTRA = {
        xps: {},  // V10.5: capaciteit nu dynamisch via getXpsCapaciteit()
        wedi: { cap_per_man: 25 },  // V8.0: Wedi Bouwplatensysteem
        ultradun: {
            // V10.7: Sulfatex Rapid met lagen en Autex optie
            sulfatex: { 
                mat_per_laag: 9.00,  // 1,6 kg/m²/laag x € 5,625/kg = EUR 9,00/laag
                lagen: {
                    2: { cap_per_man: 32.50, cap_met_autex: 26.00, mat: 18.00, mat_met_autex: 21.24 },
                    3: { cap_per_man: 21.67, cap_met_autex: 17.33, mat: 27.00, mat_met_autex: 30.24 }
                }
            },
            sopro: { 
                mat_per_laag: 3.75,  // V9.29: 1,2 kg/m²/mm x € 3,125/kg = EUR 3,75/laag
                // V10.6: Capaciteit en materiaal per aantal lagen met Autex optie
                lagen: {
                    2: { cap_per_man: 32.50, cap_met_autex: 26.00, mat: 7.50, mat_met_autex: 10.74 },
                    3: { cap_per_man: 21.67, cap_met_autex: 17.33, mat: 11.25, mat_met_autex: 14.49 },
                    4: { cap_per_man: 16.25, cap_met_autex: 13.00, mat: 15.00, mat_met_autex: 18.24 }
                }
            },
            // V10.8: Asocret-M30 met dikte dropdown (10/15/20mm)
            asocret: {
                mat_per_mm: 1.62,  // 1,4 kg/m²/mm x € 1,157/kg = EUR 1,62/mm
                diktes: {
                    10: { cap_per_man: 25, cap_met_autex: 20, mat: 16.20, mat_met_autex: 19.44, verbruik: 14 },
                    15: { cap_per_man: 20, cap_met_autex: 16, mat: 24.30, mat_met_autex: 27.54, verbruik: 21 },
                    20: { cap_per_man: 15, cap_met_autex: 12, mat: 32.40, mat_met_autex: 35.64, verbruik: 28 }
                }
            }
        },
        fixfinish: { cap_per_man: 35, mat: 1.80 },  // V10: 2,55 kg/m² x € 0,7068/kg
        fassashield: { cap_per_man: 25, mat: 39.89 },  // V10.10: cap conform Master Sheet V1.3
        // V10: Grondering Muur - 6 producten (prijzen geverifieerd)
        grondering: {
            stucprimer:    { cap_per_man: 140, mat: 0.52, naam: "Knauf, Stuc Primer", verbruik: "0,10 kg/m²", verbruik_num: 0.10, eenheid: "kg", emmer: 5, emmer_eenheid: "L" },
            sopro_gd749:   { cap_per_man: 140, mat: 1.17, naam: "Sopro, GD749", verbruik: "0,15 kg/m²", verbruik_num: 0.15, eenheid: "kg", emmer: 5, emmer_eenheid: "kg" },
            technicure_cs: { cap_per_man: 140, mat: 3.64, naam: "Technichem, Technicure CS", verbruik: "0,50 L/m²", verbruik_num: 0.50, eenheid: "L", emmer: 25, emmer_eenheid: "L" },
            keisol_mb:     { cap_per_man: 140, mat: 0.78, naam: "Remmers, Keisol MB", verbruik: "0,15 kg/m²", verbruik_num: 0.15, eenheid: "kg", emmer: 30, emmer_eenheid: "kg" },
            betocontact:   { cap_per_man: 120, mat: 0.84, naam: "Knauf, Betokontakt", verbruik: "0,30 kg/m²", verbruik_num: 0.30, eenheid: "kg", emmer: 20, emmer_eenheid: "kg" },
            technicure_as: { 
                cap_per_man: 120, 
                emmer_kg: 5,
                emmer_prijs: 51.92,
                verbruik_per_m2: 0.33,
                naam: "Technichem, Technicure AS",
                verbruik: "0,33 kg/m² (2 lagen)",
                trapfunctie: true
            }
        }
    };

    // V10.5: Wedi gitex systemen - Gitex prijs gecorrigeerd (EUR 1,0665/m²)
    const WEDI_GITEX_SYSTEMS = {
        naden: {
            naam: 'Naden verstevigen',
            productiviteit: 30,           // m2/dag per man
            gitex_verbruik: 0.25,         // m2 Gitex per m2 wand
            gitex_prijs: 0.27,            // V10.5: 0.25 x 1.0665 (was 0.31)
            snelband_verbruik: 0.20,      // kg/m²
            snelband_prijs: 0.11          // 0.20 x 0.552
        },
        volledig: {
            naam: 'Volledig oppervlak',
            productiviteit: 25,           // m2/dag per man
            gitex_verbruik: 1.10,         // m2 Gitex per m2 wand
            gitex_prijs: 1.17,            // V10.5: 1.10 x 1.0665 (was 1.38)
            snelband_verbruik: 0.88,      // kg/m²
            snelband_prijs: 0.49          // 0.88 x 0.552
        }
    };

    // V10.5: XPS gitex systemen (conform Wedi patroon)
    const XPS_GITEX_SYSTEMS = {
        naden: {
            naam: 'Naden verstevigen',
            productiviteit: 35,           // m2/dag per man
            gitex_verbruik: 0.25,         // m2 Gitex per m2 wand
            gitex_prijs: 0.27,            // 0.25 x 1.0665
            snelband_verbruik: 0.20,      // kg/m²
            snelband_prijs: 0.11          // 0.20 x 0.552
        },
        volledig: {
            naam: 'Volledig oppervlak',
            productiviteit: 30,           // m2/dag per man
            gitex_verbruik: 1.10,         // m2 Gitex per m2 wand
            gitex_prijs: 1.17,            // 1.10 x 1.0665
            snelband_verbruik: 0.88,      // kg/m²
            snelband_prijs: 0.49          // 0.88 x 0.552
        }
    };

    // V10: Wedi materiaalkosten per dikte (plaat + CODEX lijm)
    // Gitex en Snelband apart via WEDI_GITEX_SYSTEMS
    const WEDI_MAT_BREAKDOWN = {
        4: {
            plaat:    { naam: 'Wedi plaat 4mm', prijs: 31.42, 
                        verbruik: '1,05 m2/m²', eenheidsprijs: '29,92' },
            flexlijm: { naam: 'CODEX POWER CX2', prijs: 3.77,  
                        verbruik: '6,25 kg/m²', eenheidsprijs: '0,60/kg' }
        },
        6: {
            plaat:    { naam: 'Wedi plaat 6mm', prijs: 28.98, 
                        verbruik: '1,05 m2/m²', eenheidsprijs: '27,60' },
            flexlijm: { naam: 'CODEX POWER CX2', prijs: 3.77,  
                        verbruik: '6,25 kg/m²', eenheidsprijs: '0,60/kg' }
        },
        10: {
            plaat:    { naam: 'Wedi plaat 10mm', prijs: 27.81, 
                        verbruik: '1,05 m2/m²',  eenheidsprijs: '26,49' },
            flexlijm: { naam: 'CODEX POWER CX2',  prijs: 3.77,  
                        verbruik: '6,25 kg/m²',  eenheidsprijs: '0,60/kg' }
        }
    };
    
    // V9.16: Session state voor materiaal checkboxes (alle aan by default)
    const materialState = {
        wedi: {
            plaat: true,
            flexlijm: true,
            gitex: true,
            snelband: true
        },
        // V9.22: Uitgebreid voor alle componenten
        // V9.24: Injecties alleen Fassa Inject (zonder PU-schuim)
        injecties: {
            fassainject: true
        },
        // V9.26: Membraan met CODEX POWER + SNC-Membraan
        membraan: {
            codex: true,
            snc: true
        },
        bezetten: {
            mp75: true
        },
        // V9.27: XPS zonder PU-schuim
        xps: {
            plaat: true,
            lgips: true,
            gitex: true,
            snelband: true
        },
        // V10.6: Sopro mortel + Autex
        sopro: {
            mortel: true,
            autex: true
        },
        // V10.7: Sulfatex mortel + Autex
        sulfatex: {
            mortel: true,
            autex: true
        },
        asocret: {
            mortel: true,
            autex: true
        },
        fixfinish: {
            absfinish: true
        },
        fassashield: {
            shield: true,
            superbond: true,
            afwerking: true
        },
        // V9.28: Bijkomend pleisterwerk puur MP75
        bijkomendpleister: {
            mp75: true
        },
        // V9.29: Grondering met checkbox
        grondering: {
            product: true
        }
    };
    
    // V10: Material breakdown voor Injecties (prijzen geverifieerd)
    const INJECTIES_MAT_BREAKDOWN = {
        fassainject: { naam: 'Fassa Inject', prijs: 2.84, 
                       verbruik: '0,2 L/m', eenheidsprijs: '14,22/L' }
    };
    
    // V10: Material breakdown voor Membraan (prijzen geverifieerd)
    const MEMBRAAN_MAT_BREAKDOWN = {
        codex: { naam: 'CODEX POWER CX2', prijs: 3.77, 
                 verbruik: '6,25 kg/m²', eenheidsprijs: '0,60/kg' },
        snc:   { naam: 'SNC-Membraan', prijs: 4.03, 
                 verbruik: '1,00 m2/m²', eenheidsprijs: '4,03/m²' }
    };
    
    // V10: Material breakdown voor Bezetten (prijzen geverifieerd)
    const BEZETTEN_MAT_BREAKDOWN = {
        mp75: { naam: 'MP75 gipspleister', prijs: 5.45, 
                verbruik: '15 kg/m²', eenheidsprijs: '0,3632/kg' }
    };
    
    // V10.5: XPS Material breakdown - alleen vaste materialen
    // Gitex en Snelband nu dynamisch via XPS_GITEX_SYSTEMS
    const XPS_MAT_BREAKDOWN = {
        20: {
            plaat: { naam: 'XPS plaat 20mm', prijs: 3.15, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '3,00' },
            lgips: { naam: 'L-gips', prijs: 0.75, 
                     verbruik: '1,8 kg/m²', eenheidsprijs: '0,4104/kg' }
        },
        30: {
            plaat: { naam: 'XPS plaat 30mm', prijs: 3.83, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '3,65' },
            lgips: { naam: 'L-gips', prijs: 0.75, 
                     verbruik: '1,8 kg/m²', eenheidsprijs: '0,4104/kg' }
        },
        40: {
            plaat: { naam: 'XPS plaat 40mm', prijs: 5.25, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '5,00' },
            lgips: { naam: 'L-gips', prijs: 0.75, 
                     verbruik: '1,8 kg/m²', eenheidsprijs: '0,4104/kg' }
        },
        50: {
            plaat: { naam: 'XPS plaat 50mm', prijs: 6.56, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '6,25' },
            lgips: { naam: 'L-gips', prijs: 0.75, 
                     verbruik: '1,8 kg/m²', eenheidsprijs: '0,4104/kg' }
        },
        60: {
            plaat: { naam: 'XPS plaat 60mm', prijs: 7.88, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '7,50' },
            lgips: { naam: 'L-gips', prijs: 0.75, 
                     verbruik: '1,8 kg/m²', eenheidsprijs: '0,4104/kg' }
        }
    };
    
    // V10.7: Material breakdown voor Sulfatex Rapid per aantal lagen
    // Mortel: 1,6 kg/m² per laag x € 5,625/kg
    // Autex: 1,0 m²/m² x € 3,24/m2
    const SULFATEX_MAT_BREAKDOWN = {
        2: {
            mortel: { naam: 'Sulfatex Rapid (2 lagen)', prijs: 18.00, 
                      verbruik: '3,2 kg/m²', eenheidsprijs: '5,625/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        },
        3: {
            mortel: { naam: 'Sulfatex Rapid (3 lagen)', prijs: 27.00, 
                      verbruik: '4,8 kg/m²', eenheidsprijs: '5,625/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        }
    };
    
    // V10.6: Material breakdown voor Sopro Ultradun per aantal lagen
    // Mortel: 1,2 kg/m² per laag x € 3,125/kg
    // Autex: 1,0 m²/m² x € 3,24/m2
    const SOPRO_MAT_BREAKDOWN = {
        2: {
            mortel: { naam: 'Sopro ZR Turbo (2 lagen)', prijs: 7.50, 
                      verbruik: '2,4 kg/m²', eenheidsprijs: '3,125/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        },
        3: {
            mortel: { naam: 'Sopro ZR Turbo (3 lagen)', prijs: 11.25, 
                      verbruik: '3,6 kg/m²', eenheidsprijs: '3,125/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        },
        4: {
            mortel: { naam: 'Sopro ZR Turbo (4 lagen)', prijs: 15.00, 
                      verbruik: '4,8 kg/m²', eenheidsprijs: '3,125/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        }
    };
    
    // V10.8: Material breakdown voor Asocret per dikte
    // Mortel: 1,4 kg/m²/mm x € 1,157/kg
    // Autex: 1,0 m²/m² x € 3,24/m2
    const ASOCRET_MAT_BREAKDOWN = {
        10: {
            mortel: { naam: 'Asocret-M30 (10mm)', prijs: 16.20, 
                      verbruik: '14 kg/m²', eenheidsprijs: '1,157/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        },
        15: {
            mortel: { naam: 'Asocret-M30 (15mm)', prijs: 24.30, 
                      verbruik: '21 kg/m²', eenheidsprijs: '1,157/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        },
        20: {
            mortel: { naam: 'Asocret-M30 (20mm)', prijs: 32.40, 
                      verbruik: '28 kg/m²', eenheidsprijs: '1,157/kg' },
            autex:  { naam: 'Autex glasvezelwapening', prijs: 3.24, 
                      verbruik: '1,0 m2/m²', eenheidsprijs: '3,24/m²' }
        }
    };
    
    // V10: Material breakdown voor Fix & Finish (3mm laagdikte)
    // Verbruik: 0,85 kg/mm x 3mm = 2,55 kg/m²
    // Zakprijs: EUR 17,67/25kg = EUR 0,7068/kg
    const FIXFINISH_MAT_BREAKDOWN = {
        absfinish: { naam: 'Fix & Finish', prijs: 1.80, 
                     verbruik: '2,55 kg/m²', eenheidsprijs: '0,7068/kg' }
    };
    
    // V10: Material breakdown voor Fassa Shield (prijzen geverifieerd)
    const FASSASHIELD_MAT_BREAKDOWN = {
        shield:    { naam: 'Fassa Shield', prijs: 33.89, 
                     verbruik: '1,05 m2/m²', eenheidsprijs: '32,28/m²' },
        superbond: { naam: 'Superbond', prijs: 4.20, 
                     verbruik: '2,21 kg/m²', eenheidsprijs: '1,90/kg' },
        afwerking: { naam: 'Fix & Finish afwerking', prijs: 1.80, 
                     verbruik: '2,55 kg/m²', eenheidsprijs: '0,7068/kg' }
    };
    
    // V10: Bijkomend pleisterwerk - puur MP75 (prijs geverifieerd)
    const BIJKOMENDPLEISTER_MAT_BREAKDOWN = {
        mp75: { naam: 'Knauf MP75', prijs: 2.72, 
                verbruik: '7,5 kg/cm/m²', eenheidsprijs: '0,3632/kg' }
    };
    const BIJKOMENDPLEISTER_ARBEID = 7.28;  // EUR/cm/m2 (10,00 - 2,72 = 7,28 arbeid)
    
    // V9.24: Effectieve materiaalprijs functies per component
    function getInjectiesMatPrijs() {
        let totaal = 0;
        if (materialState.injecties.fassainject) totaal += INJECTIES_MAT_BREAKDOWN.fassainject.prijs;
        return totaal;
    }
    
    // V9.26: Membraan met twee materialen
    function getMembraanMatPrijs() {
        let totaal = 0;
        if (materialState.membraan.codex) totaal += MEMBRAAN_MAT_BREAKDOWN.codex.prijs;
        if (materialState.membraan.snc) totaal += MEMBRAAN_MAT_BREAKDOWN.snc.prijs;
        return totaal;
    }
    
    function getBezettenMatPrijs() {
        let totaal = 0;
        if (materialState.bezetten.mp75) totaal += BEZETTEN_MAT_BREAKDOWN.mp75.prijs;
        return totaal;
    }
    
    // V10.5: XPS materiaalprijs met gitex methode
    function getXpsMatPrijs(dikte, gitexMethode) {
        const breakdown = XPS_MAT_BREAKDOWN[dikte] || XPS_MAT_BREAKDOWN[40];
        const gitexSys = XPS_GITEX_SYSTEMS[gitexMethode] || XPS_GITEX_SYSTEMS.naden;
        let totaal = 0;
        if (materialState.xps.plaat) totaal += breakdown.plaat.prijs;
        if (materialState.xps.lgips) totaal += breakdown.lgips.prijs;
        if (materialState.xps.gitex) totaal += gitexSys.gitex_prijs;
        if (materialState.xps.snelband) totaal += gitexSys.snelband_prijs;
        return totaal;
    }
    
    // V10.7: Sulfatex mortel + Autex
    function getSulfatexMatPrijs(lagen, metAutex) {
        const breakdown = SULFATEX_MAT_BREAKDOWN[lagen] || SULFATEX_MAT_BREAKDOWN[2];
        let totaal = 0;
        if (materialState.sulfatex.mortel) totaal += breakdown.mortel.prijs;
        if (metAutex && materialState.sulfatex.autex) totaal += breakdown.autex.prijs;
        return totaal;
    }
    
    // V10.6: Sopro mortel + Autex
    function getSoproMatPrijs(lagen, metAutex) {
        const breakdown = SOPRO_MAT_BREAKDOWN[lagen] || SOPRO_MAT_BREAKDOWN[2];
        let totaal = 0;
        if (materialState.sopro.mortel) totaal += breakdown.mortel.prijs;
        if (metAutex && materialState.sopro.autex) totaal += breakdown.autex.prijs;
        return totaal;
    }
    
    // V10.8: Asocret met dikte parameter
    function getAsocretMatPrijs(dikte, metAutex) {
        const breakdown = ASOCRET_MAT_BREAKDOWN[dikte] || ASOCRET_MAT_BREAKDOWN[10];
        let totaal = 0;
        if (materialState.asocret.mortel) totaal += breakdown.mortel.prijs;
        if (metAutex && materialState.asocret.autex) totaal += breakdown.autex.prijs;
        return totaal;
    }
    
    function getFixfinishMatPrijs() {
        let totaal = 0;
        if (materialState.fixfinish.absfinish) totaal += FIXFINISH_MAT_BREAKDOWN.absfinish.prijs;
        return totaal;
    }
    
    function getFassashieldMatPrijs() {
        let totaal = 0;
        if (materialState.fassashield.shield) totaal += FASSASHIELD_MAT_BREAKDOWN.shield.prijs;
        if (materialState.fassashield.superbond) totaal += FASSASHIELD_MAT_BREAKDOWN.superbond.prijs;
        if (materialState.fassashield.afwerking) totaal += FASSASHIELD_MAT_BREAKDOWN.afwerking.prijs;
        return totaal;
    }
    
    // V9.28: Bijkomend pleisterwerk materiaalprijs (per cm/m²)
    function getBijkomendpleisterMatPrijs() {
        let totaal = 0;
        if (materialState.bijkomendpleister.mp75) totaal += BIJKOMENDPLEISTER_MAT_BREAKDOWN.mp75.prijs;
        return totaal;
    }
    
    // V9.29: Grondering materiaalprijs
    function getGroderingMatPrijs(product) {
        const spec = XTRA.grondering[product];
        if (!spec || !materialState.grondering.product) return 0;
        return spec.mat || 0;
    }
    
    // V9.21: Bereken effectieve Wedi materiaalprijs op basis van checkbox state + gitex methode
    function getWediMatPrijs(dikte, gitexMethode) {
        const breakdown = WEDI_MAT_BREAKDOWN[dikte] || WEDI_MAT_BREAKDOWN[10];
        const gitexSys = WEDI_GITEX_SYSTEMS[gitexMethode] || WEDI_GITEX_SYSTEMS.naden;
        let totaal = 0;
        
        // Plaat
        if (materialState.wedi.plaat) {
            totaal += breakdown.plaat.prijs;
        }
        // Flexlijm
        if (materialState.wedi.flexlijm) {
            totaal += breakdown.flexlijm.prijs;
        }
        // Gitex (variabel per methode)
        if (materialState.wedi.gitex) {
            totaal += gitexSys.gitex_prijs;
        }
        // Snelband (variabel per methode)
        if (materialState.wedi.snelband) {
            totaal += gitexSys.snelband_prijs;
        }
        
        return totaal;
    }
    
    // V9.21: Haal Wedi capaciteit op basis van gitex methode
    function getWediCapaciteit(gitexMethode) {
        const gitexSys = WEDI_GITEX_SYSTEMS[gitexMethode] || WEDI_GITEX_SYSTEMS.naden;
        return gitexSys.productiviteit;
    }
    
    // V10.5: Haal XPS capaciteit op basis van gitex methode
    function getXpsCapaciteit(gitexMethode) {
        const gitexSys = XPS_GITEX_SYSTEMS[gitexMethode] || XPS_GITEX_SYSTEMS.naden;
        return gitexSys.productiviteit;
    }

    // === THEME MANAGEMENT ===
    const themeBtn = document.getElementById('theme-toggle-btn');
    const body = document.body;

    // ============================================================
    // UNITPOSITIONER - V3.0 Label Positioning
    // Dynamically positions unit and label after typed value
    // ============================================================
    
    const UnitPositioner = (() => {
        const update = (element) => {
            const wrapper = element.parentElement;
            if (!wrapper || !wrapper.classList.contains('input-wrapper')) return;
            
            const unit = wrapper.querySelector('.unit-inside');
            const label = wrapper.querySelector('.label-inside');
            if (!unit) return;
            
            const isSelect = element.tagName === 'SELECT';
            const value = isSelect ? element.options[element.selectedIndex].text : element.value;
            
            // Check for empty/placeholder state
            if ((isSelect && (element.value === '' || element.classList.contains('placeholder-active'))) || 
                (!isSelect && !value)) {
                // Reset to default position when empty
                unit.style.left = '13px';
                if (label) label.style.left = '13px';
                return;
            }
            
            // Measure text width
            const temp = document.createElement('span');
            temp.style.cssText = 'visibility:hidden;position:absolute;white-space:nowrap;';
            temp.style.font = window.getComputedStyle(element).font;
            temp.style.fontSize = window.getComputedStyle(element).fontSize;
            temp.textContent = value;
            document.body.appendChild(temp);
            const textWidth = temp.offsetWidth;
            document.body.removeChild(temp);
            
            // Position unit after value
            const unitLeft = 13 + textWidth + 5;
            unit.style.left = unitLeft + 'px';
            
            // Position label after unit
            if (label) {
                const tempUnit = document.createElement('span');
                tempUnit.style.cssText = 'visibility:hidden;position:absolute;white-space:nowrap;';
                tempUnit.style.font = window.getComputedStyle(unit).font;
                tempUnit.style.fontSize = window.getComputedStyle(unit).fontSize;
                tempUnit.textContent = unit.textContent;
                document.body.appendChild(tempUnit);
                const unitWidth = tempUnit.offsetWidth;
                document.body.removeChild(tempUnit);
                label.style.left = (unitLeft + unitWidth + 8) + 'px';
            }
        };
        
        const init = () => {
            // Observe all inputs and selects for resize changes
            if (typeof ResizeObserver !== 'undefined') {
                const observer = new ResizeObserver(entries => {
                    entries.forEach(entry => {
                        const isSelect = entry.target.tagName === 'SELECT';
                        if ((isSelect && entry.target.value) || (!isSelect && entry.target.value)) {
                            update(entry.target);
                        }
                    });
                });
                document.querySelectorAll('.input-wrapper input, .input-wrapper select').forEach(el => {
                    observer.observe(el);
                });
            }
        };
        
        const reset = () => {
            document.querySelectorAll('.unit-inside, .label-inside').forEach(el => {
                el.style.left = '13px';
            });
        };
        
        return { update, init, reset };
    })();

    function loadTheme() {
        try {
            const saved = localStorage.getItem('aqp-theme');
            if (saved === 'light') {
                body.classList.remove('dark-mode');
            }
        } catch (e) {}
    }

    function toggleTheme() {
        body.classList.toggle('dark-mode');
        try {
            localStorage.setItem('aqp-theme', 
                body.classList.contains('dark-mode') ? 'dark' : 'light');
        } catch (e) {}
    }

    themeBtn.addEventListener('click', toggleTheme);
    loadTheme();

    // === RESET FUNCTION ===
    const resetBtn = document.getElementById('reset-btn');
    
    resetBtn.addEventListener('click', function() {
        this.classList.add('btn-flash');
        
        const inputIds = [
            'afkappen', 'injecties', 'membraan', 'bezetten',
            'hoekprofielen', 'bijkomendpleister', 'egalisatie',
            'xps', 'wedi', 'ultradun', 'fixfinish', 'fassashield', 'grondering'
        ];
        
        inputIds.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.value = '';
        });
        
        document.getElementById('xps-dikte').selectedIndex = 0;
        document.getElementById('xps-dikte').classList.add('placeholder-active');
        // V10.5: Reset xps-gitex dropdown
        document.getElementById('xps-gitex').value = 'naden';
        document.getElementById('wedi-dikte').selectedIndex = 0;
        document.getElementById('wedi-dikte').classList.add('placeholder-active');
        document.getElementById('ultradun-systeem').selectedIndex = 0;
        document.getElementById('ultradun-systeem').classList.add('placeholder-active');
        // V8.2: Reset sopro-lagen dropdown to default (2 lagen)
        document.getElementById('sopro-lagen').value = '2';
        document.getElementById('sopro-lagen-wrapper').style.display = 'none';
        // V10.6: Reset sopro-autex dropdown (default: zonder)
        document.getElementById('sopro-autex').value = 'zonder';
        document.getElementById('sopro-autex-wrapper').style.display = 'none';
        // V10.7: Reset sulfatex-lagen dropdown (default: 2 lagen)
        document.getElementById('sulfatex-lagen').value = '2';
        document.getElementById('sulfatex-lagen-wrapper').style.display = 'none';
        // V10.7: Reset sulfatex-autex dropdown (default: zonder)
        document.getElementById('sulfatex-autex').value = 'zonder';
        document.getElementById('sulfatex-autex-wrapper').style.display = 'none';
        // V9.9: Reset asocret-autex dropdown (default: zonder)
        document.getElementById('asocret-autex').value = 'zonder';
        document.getElementById('asocret-autex-wrapper').style.display = 'none';
        // V10.8: Reset asocret-dikte dropdown (default: 10mm)
        document.getElementById('asocret-dikte').value = '10';
        document.getElementById('asocret-dikte-wrapper').style.display = 'none';
        // V8.8: Reset product-grondering dropdown
        document.getElementById('product-grondering').selectedIndex = 0;
        document.getElementById('product-grondering').classList.add('placeholder-active');
        
        // Reset unit/label positions
        UnitPositioner.reset();
        
        // V10.9: Reset materialState - alle checkboxes weer enabled
        materialState.wedi.plaat = true;
        materialState.wedi.flexlijm = true;
        materialState.wedi.gitex = true;
        materialState.wedi.snelband = true;
        materialState.injecties.fassainject = true;
        materialState.membraan.codex = true;
        materialState.membraan.snc = true;
        materialState.bezetten.mp75 = true;
        materialState.xps.plaat = true;
        materialState.xps.lgips = true;
        materialState.xps.gitex = true;
        materialState.xps.snelband = true;
        materialState.sopro.mortel = true;
        materialState.sopro.autex = true;
        materialState.sulfatex.mortel = true;
        materialState.sulfatex.autex = true;
        materialState.asocret.mortel = true;
        materialState.asocret.autex = true;
        materialState.fixfinish.absfinish = true;
        materialState.fassashield.shield = true;
        materialState.fassashield.superbond = true;
        materialState.fassashield.afwerking = true;
        materialState.bijkomendpleister.mp75 = true;
        materialState.grondering.product = true;
        
        // Collapse sections
        ['bijkomend', 'extra'].forEach(section => {
            const header = document.getElementById(`${section}-header`);
            const content = document.getElementById(`${section}-content`);
            if (header && content) {
                header.classList.remove('expanded');
                header.setAttribute('aria-expanded', 'false');
                content.classList.remove('show');
            }
        });
        
        calculate();
        
        // V11.0: Expliciete dormant state voor alle kaarten na reset (V34.5 pattern)
        setTimeout(() => {
            // Hoofdcomponent cards
            ['afkappen', 'injecties', 'membraan', 'bezetten'].forEach(comp => {
                const card = document.getElementById(`card-${comp}`);
                if (card) card.classList.add('dormant');
            });
            
            // Bijkomend werk cards
            ['hoekprofielen', 'bijkomendpleister', 'egalisatie'].forEach(comp => {
                const card = document.getElementById(`card-${comp}`);
                if (card) card.classList.add('dormant');
            });
            
            // Extra component cards
            ['xps', 'wedi', 'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
                const card = document.getElementById(`card-${comp}`);
                if (card) card.classList.add('dormant');
            });
            
            // Summary en Invoice cards
            const summary = document.getElementById('summary');
            const invoice = document.getElementById('invoice');
            if (summary) summary.classList.add('dormant');
            if (invoice) invoice.classList.add('dormant');
        }, 50);
        
        setTimeout(() => this.classList.remove('btn-flash'), 300);
    });

    // === SECTION TOGGLES ===
    ['bijkomend', 'extra'].forEach(section => {
        const header = document.getElementById(`${section}-header`);
        const content = document.getElementById(`${section}-content`);
        
        header.addEventListener('click', function() {
            const expanded = this.getAttribute('aria-expanded') === 'true';
            this.setAttribute('aria-expanded', !expanded);
            this.classList.toggle('expanded');
            content.classList.toggle('show');
        });
    });

    // === MODAL FUNCTIONS ===
    window.showInfo = function(component) {
        const modal = document.getElementById('infoModal');
        const title = document.getElementById('modal-title');
        const body = document.getElementById('modal-body');
        
        const titles = {
            afkappen: 'Afkappen pleister',
            injecties: 'Vochtinjecties',
            membraan: 'SNC-membraan',
            bezetten: 'Bezetten gips',
            hoekprofielen: 'Hoekprofielen',
            bijkomendpleister: 'Bijkomend pleisterwerk',
            egalisatie: 'Bijkomende egalisatie',
            xps: 'XPS-isolatiesysteem',
            wedi: 'Wedi Bouwplatensysteem',
            ultradun: 'Compacte dichting',
            fixfinish: 'Fix & Finish',
            fassashield: 'Fassa Shield Isolatiesysteem'
        };
        
        title.textContent = titles[component] || component;
        
        const qty = parseFloat(document.getElementById(
            component === 'bijkomendpleister' || component === 'egalisatie' 
            ? component : component).value) || 0;
        
        let html = '<div class="info-section">';
        
        if (qty > 0) {
            // === AFKAPPEN (alleen arbeid) ===
            if (component === 'afkappen') {
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Geen materiaalkosten (enkel arbeid)</li>';
                html += '<li>Capaciteit: 35 m2/man/dag</li>';
                html += `<li>${qty} m² = ${(qty / 35 * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
            }
            // === INJECTIES (V9.24 alleen Fassa Inject) ===
            else if (component === 'injecties') {
                const effectief_mat = getInjectiesMatPrijs();
                const breakdown = INJECTIES_MAT_BREAKDOWN;
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Capaciteit: 60 m/man/dag</li>';
                html += `<li>${qty} m = ${(qty / 60 * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkbox
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                // Fassa Inject
                const fassaChecked = materialState.injecties.fassainject ? 'checked' : '';
                const fassaDisabled = materialState.injecties.fassainject ? '' : 'disabled';
                const fassaPrijs = materialState.injecties.fassainject ? breakdown.fassainject.prijs : 0;
                const fassaLiter = qty * 0.2;
                const fassaEmmers = (fassaLiter / 10).toFixed(2);
                html += `<li class="material-checkbox-item ${fassaDisabled}" data-key="fassainject">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${fassaChecked} onchange="toggleInjectiesMaterial('fassainject', ${qty})">`;
                html += `<span class="mat-name">${breakdown.fassainject.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${fassaPrijs.toFixed(2)}/m</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.fassainject.verbruik} x € ${breakdown.fassainject.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m = ${fassaLiter.toFixed(1)} L (${fassaEmmers} emmers a 10L)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="injecties-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === MEMBRAAN (V9.26 CODEX + SNC) ===
            else if (component === 'membraan') {
                const effectief_mat = getMembraanMatPrijs();
                const breakdown = MEMBRAAN_MAT_BREAKDOWN;
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Capaciteit: 40 m2/man/dag</li>';
                html += `<li>${qty} m² = ${(qty / 40 * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkboxes
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                // CODEX POWER CX2
                const codexChecked = materialState.membraan.codex ? 'checked' : '';
                const codexDisabled = materialState.membraan.codex ? '' : 'disabled';
                const codexPrijs = materialState.membraan.codex ? breakdown.codex.prijs : 0;
                const codexKg = qty * 6.25;
                const codexZakken = (codexKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${codexDisabled}" data-key="codex">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${codexChecked} onchange="toggleMembraanMaterial('codex', ${qty})">`;
                html += `<span class="mat-name">${breakdown.codex.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${codexPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.codex.verbruik} x € ${breakdown.codex.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${codexKg.toFixed(1)} kg (${codexZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                // SNC-Membraan
                const sncChecked = materialState.membraan.snc ? 'checked' : '';
                const sncDisabled = materialState.membraan.snc ? '' : 'disabled';
                const sncPrijs = materialState.membraan.snc ? breakdown.snc.prijs : 0;
                const sncM2 = qty * 1.0;
                const sncRollen = (sncM2 / 30).toFixed(2);
                html += `<li class="material-checkbox-item ${sncDisabled}" data-key="snc">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${sncChecked} onchange="toggleMembraanMaterial('snc', ${qty})">`;
                html += `<span class="mat-name">${breakdown.snc.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${sncPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.snc.verbruik} x € ${breakdown.snc.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${sncM2.toFixed(1)} m² (${sncRollen} rollen a 30m²)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="membraan-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === BEZETTEN (V9.22 two-line layout) ===
            else if (component === 'bezetten') {
                const effectief_mat = getBezettenMatPrijs();
                const breakdown = BEZETTEN_MAT_BREAKDOWN;
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Capaciteit: 20 m2/man/dag</li>';
                html += `<li>${qty} m² = ${(qty / 20 * 8).toFixed(2)} manuren</li>`;
                html += `<li>Zakken (25kg): ${(qty * 15 / 25).toFixed(1)} stuks</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkbox
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                const mp75Checked = materialState.bezetten.mp75 ? 'checked' : '';
                const mp75Disabled = materialState.bezetten.mp75 ? '' : 'disabled';
                const mp75Prijs = materialState.bezetten.mp75 ? breakdown.mp75.prijs : 0;
                const mp75Kg = qty * 15;
                const mp75Zakken = (mp75Kg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${mp75Disabled}" data-key="mp75">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${mp75Checked} onchange="toggleBezettenMaterial('mp75', ${qty})">`;
                html += `<span class="mat-name">${breakdown.mp75.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${mp75Prijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.mp75.verbruik} x € ${breakdown.mp75.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${mp75Kg.toFixed(0)} kg (${mp75Zakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="bezetten-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === XPS (V10.5: met gitex methode dropdown) ===
            else if (component === 'xps') {
                const dikte = parseInt(document.getElementById('xps-dikte').value) || 40;
                const gitexMethode = document.getElementById('xps-gitex').value || 'naden';
                const breakdown = XPS_MAT_BREAKDOWN[dikte] || XPS_MAT_BREAKDOWN[40];
                const gitexSys = XPS_GITEX_SYSTEMS[gitexMethode] || XPS_GITEX_SYSTEMS.naden;
                const effectief_mat = getXpsMatPrijs(dikte, gitexMethode);
                const cap_per_man = getXpsCapaciteit(gitexMethode);
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += `<li>Methode: ${gitexSys.naam}</li>`;
                html += `<li>Capaciteit: ${cap_per_man} m2/man/dag</li>`;
                html += `<li>${qty} m² = ${(qty / cap_per_man * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkboxes
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                // XPS plaat
                const plaatChecked = materialState.xps.plaat ? 'checked' : '';
                const plaatDisabled = materialState.xps.plaat ? '' : 'disabled';
                const plaatPrijs = materialState.xps.plaat ? breakdown.plaat.prijs : 0;
                const plaatM2 = qty * 1.05;
                const plaatStuks = (plaatM2 / 0.75).toFixed(2);
                html += `<li class="material-checkbox-item ${plaatDisabled}" data-key="plaat">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${plaatChecked} onchange="toggleXpsMaterial('plaat', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${breakdown.plaat.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${plaatPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.plaat.verbruik} x € ${breakdown.plaat.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${plaatM2.toFixed(1)} m² (${plaatStuks} platen a 0,75m²)</div>`;
                html += '</li>';
                
                // L-gips
                const lgipsChecked = materialState.xps.lgips ? 'checked' : '';
                const lgipsDisabled = materialState.xps.lgips ? '' : 'disabled';
                const lgipsPrijs = materialState.xps.lgips ? breakdown.lgips.prijs : 0;
                const lgipsKg = qty * 1.8;
                const lgipsZakken = (lgipsKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${lgipsDisabled}" data-key="lgips">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${lgipsChecked} onchange="toggleXpsMaterial('lgips', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${breakdown.lgips.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${lgipsPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.lgips.verbruik} x € ${breakdown.lgips.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${lgipsKg.toFixed(1)} kg (${lgipsZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                // Gitex (variabel per methode)
                const gitexChecked = materialState.xps.gitex ? 'checked' : '';
                const gitexDisabled = materialState.xps.gitex ? '' : 'disabled';
                const gitexPrijs = materialState.xps.gitex ? gitexSys.gitex_prijs : 0;
                const gitexNaam = gitexMethode === 'naden' ? 'Gitex (naden)' : 'Gitex (volledig)';
                const gitexM2 = qty * gitexSys.gitex_verbruik;
                const gitexRollen = (gitexM2 / 100).toFixed(2);
                html += `<li class="material-checkbox-item ${gitexDisabled}" data-key="gitex">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${gitexChecked} onchange="toggleXpsMaterial('gitex', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${gitexNaam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${gitexPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${gitexSys.gitex_verbruik.toFixed(2)} m²/m² x € 1,0665</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${gitexM2.toFixed(1)} m² (${gitexRollen} rollen a 100m²)</div>`;
                html += '</li>';
                
                // Snelband (variabel per methode)
                const snelChecked = materialState.xps.snelband ? 'checked' : '';
                const snelDisabled = materialState.xps.snelband ? '' : 'disabled';
                const snelPrijs = materialState.xps.snelband ? gitexSys.snelband_prijs : 0;
                const snelNaam = gitexMethode === 'naden' ? 'Snelband (naden)' : 'Snelband 1mm';
                const snelKg = qty * gitexSys.snelband_verbruik;
                const snelZakken = (snelKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${snelDisabled}" data-key="snelband">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${snelChecked} onchange="toggleXpsMaterial('snelband', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${snelNaam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${snelPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${gitexSys.snelband_verbruik.toFixed(2)} kg/m² x € 0,552/kg</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${snelKg.toFixed(1)} kg (${snelZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="xps-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === WEDI (bestaande V9.21 implementatie - referentie) ===
            else if (component === 'wedi') {
                const dikte = parseInt(document.getElementById('wedi-dikte').value) || 10;
                const gitexMethode = document.getElementById('wedi-gitex').value || 'naden';
                const breakdown = WEDI_MAT_BREAKDOWN[dikte] || WEDI_MAT_BREAKDOWN[10];
                const gitexSys = WEDI_GITEX_SYSTEMS[gitexMethode] || WEDI_GITEX_SYSTEMS.naden;
                const effectief_mat = getWediMatPrijs(dikte, gitexMethode);
                const cap_per_man = getWediCapaciteit(gitexMethode);
                
                // Section 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += `<li>Methode: ${gitexSys.naam}</li>`;
                html += `<li>Capaciteit: ${cap_per_man} m2/man/dag</li>`;
                html += `<li>${qty} m² = ${(qty / cap_per_man * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Section 2: Materiaalkosten met checkboxes
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                // Plaat
                const plaatChecked = materialState.wedi.plaat ? 'checked' : '';
                const plaatDisabled = materialState.wedi.plaat ? '' : 'disabled';
                const plaatPrijs = materialState.wedi.plaat ? breakdown.plaat.prijs : 0;
                const plaatGrootte = dikte === 10 ? 1.56 : 0.75;
                const plaatAfm = dikte === 10 ? '2600x600' : '1250x600';
                const plaatM2 = qty * 1.05;
                const plaatStuks = (plaatM2 / plaatGrootte).toFixed(2);
                html += `<li class="material-checkbox-item ${plaatDisabled}" data-key="plaat">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${plaatChecked} onchange="toggleWediMaterial('plaat', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${breakdown.plaat.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${plaatPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.plaat.verbruik} x € ${breakdown.plaat.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${plaatM2.toFixed(1)} m² (${plaatStuks} platen a ${plaatAfm})</div>`;
                html += '</li>';
                
                // Flexlijm (CODEX)
                const flexChecked = materialState.wedi.flexlijm ? 'checked' : '';
                const flexDisabled = materialState.wedi.flexlijm ? '' : 'disabled';
                const flexPrijs = materialState.wedi.flexlijm ? breakdown.flexlijm.prijs : 0;
                const flexKg = qty * 6.25;
                const flexZakken = (flexKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${flexDisabled}" data-key="flexlijm">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${flexChecked} onchange="toggleWediMaterial('flexlijm', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${breakdown.flexlijm.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${flexPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.flexlijm.verbruik} x € ${breakdown.flexlijm.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${flexKg.toFixed(1)} kg (${flexZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                // Gitex (variabel per methode)
                const gitexChecked = materialState.wedi.gitex ? 'checked' : '';
                const gitexDisabled = materialState.wedi.gitex ? '' : 'disabled';
                const gitexPrijs = materialState.wedi.gitex ? gitexSys.gitex_prijs : 0;
                const gitexNaam = gitexMethode === 'naden' ? 'Gitex (naden)' : 'Gitex (volledig)';
                const gitexM2 = qty * gitexSys.gitex_verbruik;
                const gitexRollen = (gitexM2 / 100).toFixed(2);
                html += `<li class="material-checkbox-item ${gitexDisabled}" data-key="gitex">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${gitexChecked} onchange="toggleWediMaterial('gitex', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${gitexNaam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${gitexPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${gitexSys.gitex_verbruik.toFixed(2)} m²/m² x € 1,0665</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${gitexM2.toFixed(1)} m² (${gitexRollen} rollen a 100m²)</div>`;
                html += '</li>';
                
                // Snelband (variabel per methode)
                const snelChecked = materialState.wedi.snelband ? 'checked' : '';
                const snelDisabled = materialState.wedi.snelband ? '' : 'disabled';
                const snelPrijs = materialState.wedi.snelband ? gitexSys.snelband_prijs : 0;
                const snelNaam = gitexMethode === 'naden' ? 'Snelband (naden)' : 'Snelband 1mm';
                const snelKg = qty * gitexSys.snelband_verbruik;
                const snelZakken = (snelKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${snelDisabled}" data-key="snelband">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${snelChecked} onchange="toggleWediMaterial('snelband', ${dikte}, ${qty}, '${gitexMethode}')">`;
                html += `<span class="mat-name">${snelNaam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${snelPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${gitexSys.snelband_verbruik.toFixed(2)} kg/m² x € 0,552/kg</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${snelKg.toFixed(1)} kg (${snelZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="wedi-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === ULTRADUN ===
            else if (component === 'ultradun') {
                const systeem = document.getElementById('ultradun-systeem').value;
                
                // V10.9: Volgorde consistent met berekenDynamisch: sopro -> asocret -> sulfatex
                // Sopro (V10.6: met Autex optie)
                if (systeem === 'sopro') {
                    const lagen = parseInt(document.getElementById('sopro-lagen').value) || 2;
                    const metAutex = document.getElementById('sopro-autex').value === 'met';
                    const lagen_data = XTRA.ultradun.sopro.lagen[lagen];
                    const cap = metAutex ? lagen_data.cap_met_autex : lagen_data.cap_per_man;
                    const effectief_mat = getSoproMatPrijs(lagen, metAutex);
                    const breakdown = SOPRO_MAT_BREAKDOWN[lagen] || SOPRO_MAT_BREAKDOWN[2];
                    
                    // Sectie 1: Capaciteit & Arbeid
                    html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                    html += '<ul class="material-list">';
                    html += `<li>Aantal lagen: ${lagen}</li>`;
                    if (metAutex) {
                        html += '<li>Methode: Met Autex glasvezelwapening</li>';
                    }
                    html += `<li>Capaciteit: ${cap} m2/man/dag</li>`;
                    html += `<li>${qty} m² = ${(qty / cap * 8).toFixed(2)} manuren</li>`;
                    html += '</ul>';
                    
                    // Sectie 2: Materiaalkosten met checkboxes
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                    html += '<ul class="material-checkbox-list">';
                    
                    // Sopro mortel
                    const mortelChecked = materialState.sopro.mortel ? 'checked' : '';
                    const mortelDisabled = materialState.sopro.mortel ? '' : 'disabled';
                    const mortelPrijs = materialState.sopro.mortel ? breakdown.mortel.prijs : 0;
                    const verbruikPerLaag = 1.2;
                    const soproKg = qty * lagen * verbruikPerLaag;
                    const soproEmmers = (soproKg / 24).toFixed(2);
                    html += `<li class="material-checkbox-item ${mortelDisabled}" data-key="mortel">`;
                    html += '<div class="mat-row">';
                    html += '<label>';
                    html += `<input type="checkbox" ${mortelChecked} onchange="toggleSoproMaterial('mortel', ${lagen}, ${qty}, ${metAutex})">`;
                    html += `<span class="mat-name">${breakdown.mortel.naam}</span>`;
                    html += '</label>';
                    html += `<span class="mat-price">€ ${mortelPrijs.toFixed(2)}/m²</span>`;
                    html += '</div>';
                    html += `<div class="mat-calc">${breakdown.mortel.verbruik} x € ${breakdown.mortel.eenheidsprijs}</div>`;
                    html += `<div class="mat-qty">→ ${qty} m² = ${soproKg.toFixed(1)} kg (${soproEmmers} emmers a 24kg)</div>`;
                    html += '</li>';
                    
                    // Autex (alleen als met Autex geselecteerd)
                    if (metAutex) {
                        const autexChecked = materialState.sopro.autex ? 'checked' : '';
                        const autexDisabled = materialState.sopro.autex ? '' : 'disabled';
                        const autexPrijs = materialState.sopro.autex ? breakdown.autex.prijs : 0;
                        const autexM2 = qty * 1.0;
                        const autexRollen = (autexM2 / 55).toFixed(2);
                        html += `<li class="material-checkbox-item ${autexDisabled}" data-key="autex">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${autexChecked} onchange="toggleSoproMaterial('autex', ${lagen}, ${qty}, ${metAutex})">`;
                        html += `<span class="mat-name">${breakdown.autex.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${autexPrijs.toFixed(2)}/m²</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${breakdown.autex.verbruik} x € ${breakdown.autex.eenheidsprijs}</div>`;
                        html += `<div class="mat-qty">→ ${qty} m² = ${autexM2.toFixed(1)} m² (${autexRollen} rollen a 55m2)</div>`;
                        html += '</li>';
                    }
                    
                    html += '</ul>';
                    
                    // Totaal
                    html += '<div class="modal-total">';
                    html += '<span class="total-label">Materiaal</span>';
                    html += `<span id="sopro-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                    html += '</div>';
                }
                // Asocret (V10.8: met dikte dropdown)
                else if (systeem === 'asocret') {
                    const dikte = parseInt(document.getElementById('asocret-dikte').value) || 10;
                    const metAutex = document.getElementById('asocret-autex').value === 'met';
                    const dikte_data = XTRA.ultradun.asocret.diktes[dikte];
                    const cap = metAutex ? dikte_data.cap_met_autex : dikte_data.cap_per_man;
                    const effectief_mat = getAsocretMatPrijs(dikte, metAutex);
                    const breakdown = ASOCRET_MAT_BREAKDOWN[dikte] || ASOCRET_MAT_BREAKDOWN[10];
                    
                    // Sectie 1: Capaciteit & Arbeid
                    html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                    html += '<ul class="material-list">';
                    html += `<li>Laagdikte: ${dikte} mm (waterdicht)</li>`;
                    if (metAutex) {
                        html += '<li>Methode: Met Autex glasvezelwapening</li>';
                    }
                    html += `<li>Capaciteit: ${cap} m2/man/dag</li>`;
                    html += `<li>${qty} m² = ${(qty / cap * 8).toFixed(2)} manuren</li>`;
                    html += '</ul>';
                    
                    // Sectie 2: Materiaalkosten met checkboxes
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                    html += '<ul class="material-checkbox-list">';
                    
                    // Asocret mortel
                    const mortelChecked = materialState.asocret.mortel ? 'checked' : '';
                    const mortelDisabled = materialState.asocret.mortel ? '' : 'disabled';
                    const mortelPrijs = materialState.asocret.mortel ? breakdown.mortel.prijs : 0;
                    const mortelKg = qty * dikte_data.verbruik;
                    const mortelZakken = (mortelKg / 25).toFixed(2);
                    html += `<li class="material-checkbox-item ${mortelDisabled}" data-key="mortel">`;
                    html += '<div class="mat-row">';
                    html += '<label>';
                    html += `<input type="checkbox" ${mortelChecked} onchange="toggleAsocretMaterial('mortel', ${dikte}, ${metAutex}, ${qty})">`;
                    html += `<span class="mat-name">${breakdown.mortel.naam}</span>`;
                    html += '</label>';
                    html += `<span class="mat-price">€ ${mortelPrijs.toFixed(2)}/m²</span>`;
                    html += '</div>';
                    html += `<div class="mat-calc">${breakdown.mortel.verbruik} x € ${breakdown.mortel.eenheidsprijs}</div>`;
                    html += `<div class="mat-qty">→ ${qty} m² = ${mortelKg.toFixed(0)} kg (${mortelZakken} zakken a 25kg)</div>`;
                    html += '</li>';
                    
                    // Autex (alleen als met Autex geselecteerd)
                    if (metAutex) {
                        const autexChecked = materialState.asocret.autex ? 'checked' : '';
                        const autexDisabled = materialState.asocret.autex ? '' : 'disabled';
                        const autexPrijs = materialState.asocret.autex ? breakdown.autex.prijs : 0;
                        const autexM2 = qty * 1.0;
                        const autexRollen = (autexM2 / 55).toFixed(2);
                        html += `<li class="material-checkbox-item ${autexDisabled}" data-key="autex">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${autexChecked} onchange="toggleAsocretMaterial('autex', ${dikte}, ${metAutex}, ${qty})">`;
                        html += `<span class="mat-name">${breakdown.autex.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${autexPrijs.toFixed(2)}/m²</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${breakdown.autex.verbruik} x € ${breakdown.autex.eenheidsprijs}</div>`;
                        html += `<div class="mat-qty">→ ${qty} m² = ${autexM2.toFixed(1)} m² (${autexRollen} rollen a 55m2)</div>`;
                        html += '</li>';
                    }
                    
                    html += '</ul>';
                    
                    // Opmerking Grondering
                    html += '<div class="modal-note" style="margin-top: 12px; padding: 8px; background: var(--bg-tertiary); border-radius: 4px; font-size: 0.85em;">';
                    html += '<strong>Let op:</strong> Grondering apart selecteren indien nodig.';
                    html += '</div>';
                    
                    // Totaal
                    html += '<div class="modal-total">';
                    html += '<span class="total-label">Materiaal</span>';
                    html += `<span id="asocret-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                    html += '</div>';
                }
                // Sulfatex (V10.7: met lagen en Autex optie)
                else if (systeem === 'sulfatex') {
                    const lagen = parseInt(document.getElementById('sulfatex-lagen').value) || 2;
                    const metAutex = document.getElementById('sulfatex-autex').value === 'met';
                    const lagen_data = XTRA.ultradun.sulfatex.lagen[lagen];
                    const cap = metAutex ? lagen_data.cap_met_autex : lagen_data.cap_per_man;
                    const effectief_mat = getSulfatexMatPrijs(lagen, metAutex);
                    const breakdown = SULFATEX_MAT_BREAKDOWN[lagen] || SULFATEX_MAT_BREAKDOWN[2];
                    
                    // Sectie 1: Capaciteit & Arbeid
                    html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                    html += '<ul class="material-list">';
                    html += `<li>Aantal lagen: ${lagen}</li>`;
                    if (metAutex) {
                        html += '<li>Methode: Met Autex glasvezelwapening</li>';
                    }
                    html += `<li>Capaciteit: ${cap} m2/man/dag</li>`;
                    html += `<li>${qty} m² = ${(qty / cap * 8).toFixed(2)} manuren</li>`;
                    html += '</ul>';
                    
                    // Sectie 2: Materiaalkosten met checkboxes
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                    html += '<ul class="material-checkbox-list">';
                    
                    // Sulfatex mortel
                    const mortelChecked = materialState.sulfatex.mortel ? 'checked' : '';
                    const mortelDisabled = materialState.sulfatex.mortel ? '' : 'disabled';
                    const mortelPrijs = materialState.sulfatex.mortel ? breakdown.mortel.prijs : 0;
                    const verbruikPerLaag = 1.6;
                    const sulfatexKg = qty * lagen * verbruikPerLaag;
                    const sulfatexEmmers = (sulfatexKg / 25).toFixed(2);
                    html += `<li class="material-checkbox-item ${mortelDisabled}" data-key="mortel">`;
                    html += '<div class="mat-row">';
                    html += '<label>';
                    html += `<input type="checkbox" ${mortelChecked} onchange="toggleSulfatexMaterial('mortel', ${lagen}, ${qty}, ${metAutex})">`;
                    html += `<span class="mat-name">${breakdown.mortel.naam}</span>`;
                    html += '</label>';
                    html += `<span class="mat-price">€ ${mortelPrijs.toFixed(2)}/m²</span>`;
                    html += '</div>';
                    html += `<div class="mat-calc">${breakdown.mortel.verbruik} x € ${breakdown.mortel.eenheidsprijs}</div>`;
                    html += `<div class="mat-qty">→ ${qty} m² = ${sulfatexKg.toFixed(1)} kg (${sulfatexEmmers} emmers a 25kg)</div>`;
                    html += '</li>';
                    
                    // Autex (alleen als met Autex geselecteerd)
                    if (metAutex) {
                        const autexChecked = materialState.sulfatex.autex ? 'checked' : '';
                        const autexDisabled = materialState.sulfatex.autex ? '' : 'disabled';
                        const autexPrijs = materialState.sulfatex.autex ? breakdown.autex.prijs : 0;
                        const autexM2 = qty * 1.0;
                        const autexRollen = (autexM2 / 55).toFixed(2);
                        html += `<li class="material-checkbox-item ${autexDisabled}" data-key="autex">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${autexChecked} onchange="toggleSulfatexMaterial('autex', ${lagen}, ${qty}, ${metAutex})">`;
                        html += `<span class="mat-name">${breakdown.autex.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${autexPrijs.toFixed(2)}/m²</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${breakdown.autex.verbruik} x € ${breakdown.autex.eenheidsprijs}</div>`;
                        html += `<div class="mat-qty">→ ${qty} m² = ${autexM2.toFixed(1)} m² (${autexRollen} rollen a 55m2)</div>`;
                        html += '</li>';
                    }
                    
                    html += '</ul>';
                    
                    // Opmerking Grondering
                    html += '<div class="modal-note" style="margin-top: 12px; padding: 8px; background: var(--bg-tertiary); border-radius: 4px; font-size: 0.85em;">';
                    html += '<strong>Let op:</strong> Grondering (Technicure AS) apart selecteren!';
                    html += '</div>';
                    
                    // Totaal
                    html += '<div class="modal-total">';
                    html += '<span class="total-label">Materiaal</span>';
                    html += `<span id="sulfatex-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                    html += '</div>';
                }
            }
            // === FIX & FINISH (V9.22 two-line layout) ===
            else if (component === 'fixfinish') {
                const effectief_mat = getFixfinishMatPrijs();
                const breakdown = FIXFINISH_MAT_BREAKDOWN;
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Capaciteit: 35 m2/man/dag</li>';
                html += `<li>${qty} m² = ${(qty / 35 * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkbox
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                const absChecked = materialState.fixfinish.absfinish ? 'checked' : '';
                const absDisabled = materialState.fixfinish.absfinish ? '' : 'disabled';
                const absPrijs = materialState.fixfinish.absfinish ? breakdown.absfinish.prijs : 0;
                const absKg = qty * 2.55;
                const absZakken = (absKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${absDisabled}" data-key="absfinish">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${absChecked} onchange="toggleFixfinishMaterial('absfinish', ${qty})">`;
                html += `<span class="mat-name">${breakdown.absfinish.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${absPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.absfinish.verbruik} x € ${breakdown.absfinish.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${absKg.toFixed(1)} kg (${absZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="fixfinish-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === FASSA SHIELD (V9.22 two-line layout) ===
            else if (component === 'fassashield') {
                const effectief_mat = getFassashieldMatPrijs();
                const breakdown = FASSASHIELD_MAT_BREAKDOWN;
                
                // Sectie 1: Capaciteit & Arbeid
                html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                html += '<ul class="material-list">';
                html += '<li>Capaciteit: 15 m2/man/dag</li>';
                html += `<li>${qty} m² = ${(qty / 15 * 8).toFixed(2)} manuren</li>`;
                html += '</ul>';
                
                // Sectie 2: Materiaalkosten met checkboxes
                html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                html += '<ul class="material-checkbox-list">';
                
                // Fassa Shield membraan
                const shieldChecked = materialState.fassashield.shield ? 'checked' : '';
                const shieldDisabled = materialState.fassashield.shield ? '' : 'disabled';
                const shieldPrijs = materialState.fassashield.shield ? breakdown.shield.prijs : 0;
                const shieldM2 = qty * 1.05;
                const shieldRollen = (shieldM2 / 7.125).toFixed(2);
                html += `<li class="material-checkbox-item ${shieldDisabled}" data-key="shield">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${shieldChecked} onchange="toggleFassashieldMaterial('shield', ${qty})">`;
                html += `<span class="mat-name">${breakdown.shield.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${shieldPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.shield.verbruik} x € ${breakdown.shield.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${shieldM2.toFixed(1)} m² (${shieldRollen} rollen a 7,125m2)</div>`;
                html += '</li>';
                
                // Superbond lijm
                const superbondChecked = materialState.fassashield.superbond ? 'checked' : '';
                const superbondDisabled = materialState.fassashield.superbond ? '' : 'disabled';
                const superbondPrijs = materialState.fassashield.superbond ? breakdown.superbond.prijs : 0;
                const superbondKg = qty * 2.21;
                const superbondEmmers = (superbondKg / 15).toFixed(2);
                html += `<li class="material-checkbox-item ${superbondDisabled}" data-key="superbond">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${superbondChecked} onchange="toggleFassashieldMaterial('superbond', ${qty})">`;
                html += `<span class="mat-name">${breakdown.superbond.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${superbondPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.superbond.verbruik} x € ${breakdown.superbond.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${superbondKg.toFixed(1)} kg (${superbondEmmers} emmers a 15kg)</div>`;
                html += '</li>';
                
                // Afwerking
                const afwerkingChecked = materialState.fassashield.afwerking ? 'checked' : '';
                const afwerkingDisabled = materialState.fassashield.afwerking ? '' : 'disabled';
                const afwerkingPrijs = materialState.fassashield.afwerking ? breakdown.afwerking.prijs : 0;
                const afwerkingKg = qty * 2.55;
                const afwerkingZakken = (afwerkingKg / 25).toFixed(2);
                html += `<li class="material-checkbox-item ${afwerkingDisabled}" data-key="afwerking">`;
                html += '<div class="mat-row">';
                html += '<label>';
                html += `<input type="checkbox" ${afwerkingChecked} onchange="toggleFassashieldMaterial('afwerking', ${qty})">`;
                html += `<span class="mat-name">${breakdown.afwerking.naam}</span>`;
                html += '</label>';
                html += `<span class="mat-price">€ ${afwerkingPrijs.toFixed(2)}/m²</span>`;
                html += '</div>';
                html += `<div class="mat-calc">${breakdown.afwerking.verbruik} x € ${breakdown.afwerking.eenheidsprijs}</div>`;
                html += `<div class="mat-qty">→ ${qty} m² = ${afwerkingKg.toFixed(1)} kg (${afwerkingZakken} zakken a 25kg)</div>`;
                html += '</li>';
                
                html += '</ul>';
                
                // Totaal
                html += '<div class="modal-total">';
                html += '<span class="total-label">Materiaal</span>';
                html += `<span id="fassashield-mat-total" class="total-value">€ ${(qty * effectief_mat).toFixed(2)}</span>`;
                html += '</div>';
            }
            // === GRONDERING (V9.29 met checkbox) ===
            else if (component === 'grondering') {
                const product = document.getElementById('product-grondering').value;
                const spec = XTRA.grondering[product];
                
                if (spec) {
                    // Sectie 1: Capaciteit & Arbeid
                    html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                    html += '<ul class="material-list">';
                    html += `<li>Capaciteit: ${spec.cap_per_man} m2/man/dag</li>`;
                    html += `<li>${qty} m² = ${(qty / spec.cap_per_man * 8).toFixed(2)} manuren</li>`;
                    html += '</ul>';
                    
                    // Sectie 2: Materiaalkosten met checkbox
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                    html += '<ul class="material-checkbox-list">';
                    
                    const productChecked = materialState.grondering.product ? 'checked' : '';
                    const productDisabled = materialState.grondering.product ? '' : 'disabled';
                    
                    if (spec.trapfunctie) {
                        // Technicure AS met trapfunctie
                        const kg_nodig = qty * spec.verbruik_per_m2;
                        const emmers = Math.ceil(kg_nodig / spec.emmer_kg);
                        const emmers_exact = (kg_nodig / spec.emmer_kg).toFixed(2);
                        const mat_totaal = materialState.grondering.product ? emmers * spec.emmer_prijs : 0;
                        
                        html += `<li class="material-checkbox-item ${productDisabled}" data-key="product">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${productChecked} onchange="toggleGroderingMaterial('${product}', ${qty})">`;
                        html += `<span class="mat-name">${spec.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${mat_totaal.toFixed(2)}</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${spec.verbruik} - ${emmers} emmers x € ${spec.emmer_prijs.toFixed(2)}</div>`;
                        html += `<div class="mat-qty">→ ${qty} m² = ${kg_nodig.toFixed(1)} kg (${emmers_exact} emmers a ${spec.emmer_kg}kg)</div>`;
                        html += '</li>';
                        html += '</ul>';
                        
                        html += '<div class="modal-total">';
                        html += '<span class="total-label">Materiaal</span>';
                        html += `<span id="grondering-mat-total" class="total-value">€ ${mat_totaal.toFixed(2)}</span>`;
                        html += '</div>';
                    } else {
                        // Standaard producten
                        const mat_prijs = materialState.grondering.product ? spec.mat : 0;
                        const mat_totaal = qty * mat_prijs;
                        const totaal_verbruik = qty * spec.verbruik_num;
                        const emmers = (totaal_verbruik / spec.emmer).toFixed(2);
                        
                        html += `<li class="material-checkbox-item ${productDisabled}" data-key="product">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${productChecked} onchange="toggleGroderingMaterial('${product}', ${qty})">`;
                        html += `<span class="mat-name">${spec.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${mat_prijs.toFixed(2)}/m²</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${spec.verbruik}</div>`;
                        html += `<div class="mat-qty">→ ${qty} m² = ${totaal_verbruik.toFixed(1)} ${spec.eenheid} (${emmers} emmers a ${spec.emmer}${spec.emmer_eenheid})</div>`;
                        html += '</li>';
                        html += '</ul>';
                        
                        html += '<div class="modal-total">';
                        html += '<span class="total-label">Materiaal</span>';
                        html += `<span id="grondering-mat-total" class="total-value">€ ${mat_totaal.toFixed(2)}</span>`;
                        html += '</div>';
                    }
                } else {
                    html += '<p style="color: #e53e3e;">Selecteer eerst een gronderingsproduct.</p>';
                }
            }
            // === HOEKPROFIELEN (basis modal) ===
            else if (component === 'hoekprofielen') {
                const oppervlakte_bezetten = parseFloat(document.getElementById('bezetten').value) || 0;
                if (oppervlakte_bezetten > 0) {
                    const mat_prijs = qty * 0.80;
                    const arb_prijs = qty * 0.25 * LOON;
                    
                    // Sectie 1: Capaciteit & Arbeid
                    html += '<div class="modal-section-title">Capaciteit & Arbeid</div>';
                    html += '<ul class="material-list">';
                    html += '<li>Arbeid: 15 min/m</li>';
                    html += `<li>${qty} m = ${(qty * 0.25).toFixed(2)} uur</li>`;
                    html += `<li>Arbeid: € ${arb_prijs.toFixed(2)}</li>`;
                    html += '</ul>';
                    
                    // Sectie 2: Materiaalkosten
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                    html += '<ul class="material-list">';
                    html += '<li>MDB hoekprofiel</li>';
                    html += `<li>€ 0,80/m x ${qty} m</li>`;
                    html += '</ul>';
                    
                    html += '<div class="modal-total">';
                    html += '<span class="total-label">Totaal</span>';
                    html += `<span class="total-value">€ ${(mat_prijs + arb_prijs).toFixed(2)}</span>`;
                    html += '</div>';
                } else {
                    html += '<p style="color: #e53e3e;">Vul eerst "Bezetten" in.</p>';
                }
            }
            // === BIJKOMEND PLEISTERWERK (V9.28 puur MP75) ===
            else if (component === 'bijkomendpleister') {
                const oppervlakte_bezetten = parseFloat(document.getElementById('bezetten').value) || 0;
                if (oppervlakte_bezetten > 0 && qty > 0) {
                    const totaal_kg = qty * 25;
                    const kg_per_m2 = totaal_kg / oppervlakte_bezetten;
                    const totale_dikte = kg_per_m2 / 7.5;
                    const extra_dikte = Math.max(0, totale_dikte - 2);
                    const standaard_zakken = (oppervlakte_bezetten * 2 * 7.5) / 25;
                    
                    if (qty > standaard_zakken) {
                        const breakdown = BIJKOMENDPLEISTER_MAT_BREAKDOWN;
                        const mat_prijs = getBijkomendpleisterMatPrijs();
                        const mat_totaal = extra_dikte * mat_prijs * oppervlakte_bezetten;
                        const arb_totaal = extra_dikte * BIJKOMENDPLEISTER_ARBEID * oppervlakte_bezetten;
                        const totaal = mat_totaal + arb_totaal;
                        
                        // Sectie 1: Berekening extra dikte
                        html += '<div class="modal-section-title">Berekening extra dikte</div>';
                        html += '<ul class="material-list">';
                        html += `<li>Standaard (2cm): ${standaard_zakken.toFixed(1)} zakken</li>`;
                        html += `<li>Gebruikt: ${qty} zakken = ${totaal_kg} kg</li>`;
                        html += `<li>Totale dikte: ${totale_dikte.toFixed(2)} cm</li>`;
                        html += `<li>Extra dikte: ${extra_dikte.toFixed(2)} cm</li>`;
                        html += '</ul>';
                        
                        // Sectie 2: Materiaalkosten met checkbox
                        html += '<div class="modal-section-title" style="margin-top: 16px;">Materiaalkosten</div>';
                        html += '<ul class="material-checkbox-list">';
                        
                        const mp75Checked = materialState.bijkomendpleister.mp75 ? 'checked' : '';
                        const mp75Disabled = materialState.bijkomendpleister.mp75 ? '' : 'disabled';
                        const mp75Prijs = materialState.bijkomendpleister.mp75 ? breakdown.mp75.prijs : 0;
                        const mp75TotaalKg = extra_dikte * 7.5 * oppervlakte_bezetten;
                        const mp75ExtraZakken = (mp75TotaalKg / 25).toFixed(2);
                        html += `<li class="material-checkbox-item ${mp75Disabled}" data-key="mp75">`;
                        html += '<div class="mat-row">';
                        html += '<label>';
                        html += `<input type="checkbox" ${mp75Checked} onchange="toggleBijkomendpleisterMaterial('mp75', ${extra_dikte}, ${oppervlakte_bezetten})">`;
                        html += `<span class="mat-name">${breakdown.mp75.naam}</span>`;
                        html += '</label>';
                        html += `<span class="mat-price">€ ${mp75Prijs.toFixed(2)}/cm/m²</span>`;
                        html += '</div>';
                        html += `<div class="mat-calc">${breakdown.mp75.verbruik} x € ${breakdown.mp75.eenheidsprijs}</div>`;
                        html += `<div class="mat-qty">→ ${extra_dikte.toFixed(2)} cm x ${oppervlakte_bezetten} m² = ${mp75TotaalKg.toFixed(0)} kg (${mp75ExtraZakken} zakken a 25kg)</div>`;
                        html += '</li>';
                        html += '</ul>';
                        
                        html += '<div class="modal-total" style="border-top: none; padding-top: 8px;">';
                        html += '<span class="total-label">Materiaal</span>';
                        html += `<span id="bijkomendpleister-mat-total" class="total-value">€ ${mat_totaal.toFixed(2)}</span>`;
                        html += '</div>';
                        
                        // Sectie 3: Arbeidskosten
                        html += '<div class="modal-section-title" style="margin-top: 16px;">Arbeidskosten</div>';
                        html += '<ul class="material-list">';
                        html += `<li>€ ${BIJKOMENDPLEISTER_ARBEID.toFixed(2)}/cm/m² x ${extra_dikte.toFixed(2)} cm x ${oppervlakte_bezetten} m²</li>`;
                        html += `<li>= € ${arb_totaal.toFixed(2)}</li>`;
                        html += '</ul>';
                        
                        // Totaal
                        html += '<div class="modal-total">';
                        html += '<span class="total-label">Totaal</span>';
                        html += `<span id="bijkomendpleister-totaal" class="total-value">€ ${totaal.toFixed(2)}</span>`;
                        html += '</div>';
                    } else {
                        html += '<p>Geen bijkomend pleisterwerk (binnen standaard 2cm).</p>';
                    }
                } else {
                    html += '<p style="color: #e53e3e;">Vul eerst "Bezetten" in.</p>';
                }
            }
            // === EGALISATIE (basis modal) ===
            else if (component === 'egalisatie') {
                const oppervlakte_bezetten = parseFloat(document.getElementById('bezetten').value) || 0;
                if (oppervlakte_bezetten > 0 && qty > 0) {
                    const totaal_kg = qty * 25;
                    const kg_per_m2 = totaal_kg / oppervlakte_bezetten;
                    const totale_dikte_mm = kg_per_m2 / 2;
                    
                    html += '<div class="modal-section-title">Berekening egalisatie</div>';
                    html += '<ul class="material-list">';
                    html += '<li>Mixemsub egalisatiemortel</li>';
                    html += `<li>${qty} zakken x 25 kg = ${totaal_kg} kg</li>`;
                    html += `<li>Dikte: ${totale_dikte_mm.toFixed(2)} mm gemiddeld</li>`;
                    html += '</ul>';
                    
                    html += '<div class="modal-section-title" style="margin-top: 16px;">Kostentoeslag</div>';
                    html += '<ul class="material-list">';
                    html += `<li>€ 3,50/mm/m² x ${totale_dikte_mm.toFixed(2)} mm x ${oppervlakte_bezetten} m²</li>`;
                    html += '</ul>';
                    
                    html += '<div class="modal-total">';
                    html += '<span class="total-label">Totaal</span>';
                    html += `<span class="total-value">€ ${(totale_dikte_mm * 3.50 * oppervlakte_bezetten).toFixed(2)}</span>`;
                    html += '</div>';
                } else {
                    html += '<p style="color: #e53e3e;">Vul eerst "Bezetten" in.</p>';
                }
            }
        } else {
            html += '<p style="color: var(--text-muted);">';
            html += 'Vul eerst een hoeveelheid in om de materiaalinfo te zien.</p>';
        }
        
        html += '</div>';
        body.innerHTML = html;
        document.getElementById('modal-overlay').classList.add('active');
        document.body.style.overflow = 'hidden';
    };

    window.closeModal = function(event) {
        if (event && event.target.closest('.info-modal') && 
            !event.target.classList.contains('modal-close')) {
            return;
        }
        document.getElementById('modal-overlay').classList.remove('active');
        document.body.style.overflow = '';
    };

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            const overlay = document.getElementById('modal-overlay');
            if (overlay && overlay.classList.contains('active')) {
                closeModal();
                e.preventDefault();
            }
        }
    });

    // V9.21: Toggle Wedi materiaal checkbox en herbereken (met gitex methode)
    window.toggleWediMaterial = function(materialKey, dikte, qty, gitexMethode) {
        // Toggle state
        materialState.wedi[materialKey] = !materialState.wedi[materialKey];
        
        // Herbereken effectieve materiaalprijs
        const effectief_mat = getWediMatPrijs(dikte, gitexMethode);
        const breakdown = WEDI_MAT_BREAKDOWN[dikte] || WEDI_MAT_BREAKDOWN[10];
        const gitexSys = WEDI_GITEX_SYSTEMS[gitexMethode] || WEDI_GITEX_SYSTEMS.naden;
        
        // Update totaal in modal
        const totalEl = document.getElementById('wedi-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        // Update checkbox item styling - vaste volgorde: plaat, flexlijm, gitex, snelband
        const checkboxItems = document.querySelectorAll('.material-checkbox-item');
        const materials = ['plaat', 'flexlijm', 'gitex', 'snelband'];
        
        materials.forEach((key, idx) => {
            const item = checkboxItems[idx];
            if (item) {
                let prijs = 0;
                if (materialState.wedi[key]) {
                    if (key === 'plaat') prijs = breakdown.plaat.prijs;
                    else if (key === 'flexlijm') prijs = breakdown.flexlijm.prijs;
                    else if (key === 'gitex') prijs = gitexSys.gitex_prijs;
                    else if (key === 'snelband') prijs = gitexSys.snelband_prijs;
                }
                
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) {
                    priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                }
                if (materialState.wedi[key]) {
                    item.classList.remove('disabled');
                } else {
                    item.classList.add('disabled');
                }
            }
        });
        
        // Trigger hoofdberekening om componentkaart te updaten
        calculate();
    };
    
    // V9.24: Toggle Injecties materiaal checkbox (alleen Fassa Inject)
    window.toggleInjectiesMaterial = function(materialKey, qty) {
        materialState.injecties[materialKey] = !materialState.injecties[materialKey];
        const effectief_mat = getInjectiesMatPrijs();
        
        const totalEl = document.getElementById('injecties-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const item = document.querySelector('.material-checkbox-item[data-key="fassainject"]');
        if (item) {
            const prijs = materialState.injecties.fassainject ? INJECTIES_MAT_BREAKDOWN.fassainject.prijs : 0;
            const priceEl = item.querySelector('.mat-price');
            if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m`;
            item.classList.toggle('disabled', !materialState.injecties.fassainject);
        }
        
        calculate();
    };
    
    // V9.26: Toggle Membraan materiaal checkbox (CODEX + SNC)
    window.toggleMembraanMaterial = function(materialKey, qty) {
        materialState.membraan[materialKey] = !materialState.membraan[materialKey];
        const effectief_mat = getMembraanMatPrijs();
        
        const totalEl = document.getElementById('membraan-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        // Update beide checkbox items
        const materials = ['codex', 'snc'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                const prijs = materialState.membraan[key] ? MEMBRAAN_MAT_BREAKDOWN[key].prijs : 0;
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.membraan[key]);
            }
        });
        
        calculate();
    };
    
    // V9.22: Toggle Bezetten materiaal checkbox
    window.toggleBezettenMaterial = function(materialKey, qty) {
        materialState.bezetten[materialKey] = !materialState.bezetten[materialKey];
        const effectief_mat = getBezettenMatPrijs();
        
        const totalEl = document.getElementById('bezetten-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const item = document.querySelector('.material-checkbox-item[data-key="mp75"]');
        if (item) {
            const prijs = materialState.bezetten.mp75 ? BEZETTEN_MAT_BREAKDOWN.mp75.prijs : 0;
            const priceEl = item.querySelector('.mat-price');
            if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
            item.classList.toggle('disabled', !materialState.bezetten.mp75);
        }
        
        calculate();
    };
    
    // V10.5: Toggle XPS materiaal checkbox met gitex methode
    window.toggleXpsMaterial = function(materialKey, dikte, qty, gitexMethode) {
        materialState.xps[materialKey] = !materialState.xps[materialKey];
        const effectief_mat = getXpsMatPrijs(dikte, gitexMethode);
        const breakdown = XPS_MAT_BREAKDOWN[dikte] || XPS_MAT_BREAKDOWN[40];
        const gitexSys = XPS_GITEX_SYSTEMS[gitexMethode] || XPS_GITEX_SYSTEMS.naden;
        
        const totalEl = document.getElementById('xps-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const materials = ['plaat', 'lgips', 'gitex', 'snelband'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                let prijs = 0;
                if (materialState.xps[key]) {
                    if (key === 'plaat') prijs = breakdown.plaat.prijs;
                    else if (key === 'lgips') prijs = breakdown.lgips.prijs;
                    else if (key === 'gitex') prijs = gitexSys.gitex_prijs;
                    else if (key === 'snelband') prijs = gitexSys.snelband_prijs;
                }
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.xps[key]);
            }
        });
        
        calculate();
    };
    
    // V10.7: Toggle Sulfatex materiaal checkbox met Autex
    window.toggleSulfatexMaterial = function(materialKey, lagen, qty, metAutex) {
        materialState.sulfatex[materialKey] = !materialState.sulfatex[materialKey];
        const effectief_mat = getSulfatexMatPrijs(lagen, metAutex);
        const breakdown = SULFATEX_MAT_BREAKDOWN[lagen] || SULFATEX_MAT_BREAKDOWN[2];
        
        const totalEl = document.getElementById('sulfatex-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const materials = metAutex ? ['mortel', 'autex'] : ['mortel'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                let prijs = 0;
                if (materialState.sulfatex[key]) {
                    prijs = breakdown[key].prijs;
                }
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.sulfatex[key]);
            }
        });
        
        calculate();
    };
    
    // V10.6: Toggle Sopro materiaal checkbox met Autex
    window.toggleSoproMaterial = function(materialKey, lagen, qty, metAutex) {
        materialState.sopro[materialKey] = !materialState.sopro[materialKey];
        const effectief_mat = getSoproMatPrijs(lagen, metAutex);
        const breakdown = SOPRO_MAT_BREAKDOWN[lagen] || SOPRO_MAT_BREAKDOWN[2];
        
        const totalEl = document.getElementById('sopro-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const materials = metAutex ? ['mortel', 'autex'] : ['mortel'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                let prijs = 0;
                if (materialState.sopro[key]) {
                    prijs = breakdown[key].prijs;
                }
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.sopro[key]);
            }
        });
        
        calculate();
    };
    
    // V10.8: Toggle Asocret materiaal checkbox met dikte
    window.toggleAsocretMaterial = function(materialKey, dikte, metAutex, qty) {
        materialState.asocret[materialKey] = !materialState.asocret[materialKey];
        const effectief_mat = getAsocretMatPrijs(dikte, metAutex);
        const breakdown = ASOCRET_MAT_BREAKDOWN[dikte] || ASOCRET_MAT_BREAKDOWN[10];
        
        const totalEl = document.getElementById('asocret-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const materials = metAutex ? ['mortel', 'autex'] : ['mortel'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                let prijs = 0;
                if (materialState.asocret[key]) {
                    prijs = breakdown[key].prijs;
                }
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.asocret[key]);
            }
        });
        
        calculate();
    };
    
    // V9.22: Toggle Fix & Finish materiaal checkbox
    window.toggleFixfinishMaterial = function(materialKey, qty) {
        materialState.fixfinish[materialKey] = !materialState.fixfinish[materialKey];
        const effectief_mat = getFixfinishMatPrijs();
        
        const totalEl = document.getElementById('fixfinish-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const item = document.querySelector('.material-checkbox-item[data-key="absfinish"]');
        if (item) {
            const prijs = materialState.fixfinish.absfinish ? 
                FIXFINISH_MAT_BREAKDOWN.absfinish.prijs : 0;
            const priceEl = item.querySelector('.mat-price');
            if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
            item.classList.toggle('disabled', !materialState.fixfinish.absfinish);
        }
        
        calculate();
    };
    
    // V9.22: Toggle Fassa Shield materiaal checkbox
    window.toggleFassashieldMaterial = function(materialKey, qty) {
        materialState.fassashield[materialKey] = !materialState.fassashield[materialKey];
        const effectief_mat = getFassashieldMatPrijs();
        
        const totalEl = document.getElementById('fassashield-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(qty * effectief_mat).toFixed(2)}`;
        }
        
        const materials = ['shield', 'superbond', 'afwerking'];
        materials.forEach(key => {
            const item = document.querySelector(`.material-checkbox-item[data-key="${key}"]`);
            if (item) {
                const prijs = materialState.fassashield[key] ? 
                    FASSASHIELD_MAT_BREAKDOWN[key].prijs : 0;
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                item.classList.toggle('disabled', !materialState.fassashield[key]);
            }
        });
        
        calculate();
    };
    
    // V9.28: Toggle Bijkomend pleisterwerk materiaal checkbox
    window.toggleBijkomendpleisterMaterial = function(materialKey, extraDikte, oppervlakte) {
        materialState.bijkomendpleister[materialKey] = !materialState.bijkomendpleister[materialKey];
        const mat_prijs = getBijkomendpleisterMatPrijs();
        const totaal_prijs = mat_prijs + BIJKOMENDPLEISTER_ARBEID;
        const totaal = extraDikte * totaal_prijs * oppervlakte;
        
        const totalEl = document.getElementById('bijkomendpleister-mat-total');
        if (totalEl) {
            totalEl.textContent = `€ ${(extraDikte * mat_prijs * oppervlakte).toFixed(2)}`;
        }
        
        const totaalTotEl = document.getElementById('bijkomendpleister-totaal');
        if (totaalTotEl) {
            totaalTotEl.textContent = `€ ${totaal.toFixed(2)}`;
        }
        
        const item = document.querySelector('.material-checkbox-item[data-key="mp75"]');
        if (item) {
            const prijs = materialState.bijkomendpleister.mp75 ? 
                BIJKOMENDPLEISTER_MAT_BREAKDOWN.mp75.prijs : 0;
            const priceEl = item.querySelector('.mat-price');
            if (priceEl) priceEl.textContent = `€ ${prijs.toFixed(2)}/cm/m²`;
            item.classList.toggle('disabled', !materialState.bijkomendpleister.mp75);
        }
        
        calculate();
    };
    
    // V9.29: Toggle Grondering materiaal checkbox
    window.toggleGroderingMaterial = function(product, qty) {
        materialState.grondering.product = !materialState.grondering.product;
        const spec = XTRA.grondering[product];
        
        if (spec) {
            let mat_totaal = 0;
            if (materialState.grondering.product) {
                if (spec.trapfunctie) {
                    const kg_nodig = qty * spec.verbruik_per_m2;
                    const emmers = Math.ceil(kg_nodig / spec.emmer_kg);
                    mat_totaal = emmers * spec.emmer_prijs;
                } else {
                    mat_totaal = qty * spec.mat;
                }
            }
            
            const totalEl = document.getElementById('grondering-mat-total');
            if (totalEl) {
                totalEl.textContent = `€ ${mat_totaal.toFixed(2)}`;
            }
            
            const item = document.querySelector('.material-checkbox-item[data-key="product"]');
            if (item) {
                let prijs = 0;
                if (materialState.grondering.product) {
                    if (spec.trapfunctie) {
                        const kg_nodig = qty * spec.verbruik_per_m2;
                        const emmers = Math.ceil(kg_nodig / spec.emmer_kg);
                        prijs = emmers * spec.emmer_prijs;
                    } else {
                        prijs = spec.mat;
                    }
                }
                const priceEl = item.querySelector('.mat-price');
                if (priceEl) {
                    if (spec.trapfunctie) {
                        priceEl.textContent = `€ ${prijs.toFixed(2)}`;
                    } else {
                        priceEl.textContent = `€ ${prijs.toFixed(2)}/m²`;
                    }
                }
                item.classList.toggle('disabled', !materialState.grondering.product);
            }
        }
        
        calculate();
    };

    // === BEREKENINGEN ===
    function isEvenredigVerdeeld(qty) {
        if (qty.afkappen <= 0 || qty.injecties <= 0 || 
            qty.membraan <= 0 || qty.bezetten <= 0) {
            return false;
        }
        const values = [qty.afkappen, qty.injecties, qty.membraan, qty.bezetten];
        const first = values[0];
        const tolerance = 0.01;
        return values.every(v => Math.abs(v - first) < tolerance);
    }

    function berekenVasteTarieven(qty) {
        const tarieven = {
            afkappen: 13,
            injecties: 31,
            membraan: 28,
            bezetten: 38
        };
        
        const result = { 
            manuren: 0, mat: 0, loon: 0, TO: 0, 
            totaal: 0, winst: 0, werkdagen_TO: 0 
        };
        
        let totaal_manuren = 0;
        ['afkappen', 'injecties', 'membraan', 'bezetten'].forEach(comp => {
            if (qty[comp] > 0) {
                const manuren = (qty[comp] / COMP[comp].cap_per_man) * 8;
                totaal_manuren += manuren;
            }
        });
        
        result.manuren = totaal_manuren;
        let werkdagen = 0;
        if (totaal_manuren > 0) {
            // V8.4: Correcte T&O berekening met 4-uur tolerantie
            werkdagen = Math.ceil(totaal_manuren / 16);
            const overschot = totaal_manuren % 16;
            if (overschot > 0 && overschot <= 4) {
                werkdagen = Math.floor(totaal_manuren / 16);
            }
            if (werkdagen < 1) werkdagen = 1;
        }
        result.werkdagen_TO = werkdagen;
        
        ['afkappen', 'injecties', 'membraan', 'bezetten'].forEach(comp => {
            if (qty[comp] > 0) {
                const prijs_per_eenheid = tarieven[comp];
                const subtotaal = qty[comp] * prijs_per_eenheid;
                const tijd = (qty[comp] / COMP[comp].cap_per_man) * 8;
                
                // V9.25: Effectieve materiaalprijs op basis van checkboxes
                let mat_prijs;
                if (comp === 'injecties') {
                    mat_prijs = getInjectiesMatPrijs();
                } else if (comp === 'membraan') {
                    mat_prijs = getMembraanMatPrijs();
                } else if (comp === 'bezetten') {
                    mat_prijs = getBezettenMatPrijs();
                } else {
                    mat_prijs = COMP[comp].mat; // afkappen heeft geen checkboxes
                }
                const mat = qty[comp] * mat_prijs;
                const loon = tijd * LOON;
                
                result[comp] = { 
                    prijs: prijs_per_eenheid,
                    subtotaal: subtotaal,
                    tijd: tijd,
                    manuren: tijd,
                    mat: mat,
                    loon: loon
                };
                
                result.totaal += subtotaal;
                result.mat += mat;
                result.loon += loon;
            }
        });
        
        result.TO = result.werkdagen_TO * TO_PER_DAG;
        result.winst = result.totaal * 0.25;
        
        const kosten = result.totaal * 0.75;
        const werkelijke_kosten = result.mat + result.loon + result.TO;
        
        if (werkelijke_kosten > 0) {
            const factor = kosten / werkelijke_kosten;
            result.loon = result.loon * factor;
        }
        
        result.mat = result.totaal - result.loon - result.TO - result.winst;
        return result;
    }

    function berekenDynamisch(qty) {
        const result = { 
            manuren: 0, mat: 0, loon: 0, TO: 0, 
            totaal: 0, winst: 0 
        };
        
        // V9.25: Gebruik effectieve prijs functies voor checkbox sync
        ['afkappen', 'injecties', 'membraan', 'bezetten'].forEach(comp => {
            if (qty[comp] > 0) {
                const manuren = (qty[comp] / COMP[comp].cap_per_man) * 8;
                const loon = manuren * LOON;
                
                // V9.25: Effectieve materiaalprijs op basis van checkboxes
                let mat_prijs;
                if (comp === 'injecties') {
                    mat_prijs = getInjectiesMatPrijs();
                } else if (comp === 'membraan') {
                    mat_prijs = getMembraanMatPrijs();
                } else if (comp === 'bezetten') {
                    mat_prijs = getBezettenMatPrijs();
                } else {
                    mat_prijs = COMP[comp].mat; // afkappen heeft geen checkboxes
                }
                const mat = qty[comp] * mat_prijs;
                
                // V9.25: Alle properties voor card display
                const subtotaal = mat + loon;
                const prijs = subtotaal / qty[comp];
                
                result[comp] = { 
                    manuren, loon, mat, 
                    tijd: manuren,
                    prijs: prijs,
                    subtotaal: subtotaal
                };
                result.manuren += manuren;
                result.loon += loon;
                result.mat += mat;
            }
        });

        // V10.5: XPS met gitex methode
        if (qty.xps > 0) {
            const dikte = parseInt(document.getElementById('xps-dikte').value);
            const gitexMethode = document.getElementById('xps-gitex').value || 'naden';
            const mat_prijs = getXpsMatPrijs(dikte, gitexMethode);
            const cap_per_man = getXpsCapaciteit(gitexMethode);
            const manuren = (qty.xps / cap_per_man) * 8;
            const loon = manuren * LOON;
            const mat = qty.xps * mat_prijs;
            const subtotaal = mat + loon;
            const prijs = subtotaal / qty.xps;
            
            result.xps = { 
                manuren, loon, mat,
                tijd: manuren,
                prijs: prijs,
                subtotaal: subtotaal
            };
            result.manuren += manuren;
            result.loon += loon;
            result.mat += mat;
        }

        if (qty.wedi > 0) {
            const dikte = parseInt(document.getElementById('wedi-dikte').value) || 10;
            const gitexMethode = document.getElementById('wedi-gitex').value || 'naden';
            // V9.21: Gebruik effectieve prijs en capaciteit op basis van gitex methode
            const mat_prijs = getWediMatPrijs(dikte, gitexMethode);
            const cap_per_man = getWediCapaciteit(gitexMethode);
            const manuren = (qty.wedi / cap_per_man) * 8;
            const loon = manuren * LOON;
            const mat = qty.wedi * mat_prijs;
            const subtotaal = mat + loon;
            const prijs = subtotaal / qty.wedi;
            
            result.wedi = { 
                manuren, loon, mat,
                tijd: manuren,
                prijs: prijs,
                subtotaal: subtotaal
            };
            result.manuren += manuren;
            result.loon += loon;
            result.mat += mat;
        }

        if (qty.ultradun > 0) {
            const systeem = document.getElementById('ultradun-systeem').value;
            
            // V10.9: Skip berekening als geen geldig systeem geselecteerd
            if (!systeem || !['sopro', 'asocret', 'sulfatex'].includes(systeem)) {
                // Geen geldig systeem - geen berekening
            } else {
                let mat, cap_per_man;
                if (systeem === 'sopro') {
                    // V10.6: Sopro met Autex optie
                    const lagen = parseInt(document.getElementById('sopro-lagen').value) || 2;
                    const metAutex = document.getElementById('sopro-autex').value === 'met';
                    const lagen_data = XTRA.ultradun.sopro.lagen[lagen];
                    cap_per_man = metAutex ? lagen_data.cap_met_autex : lagen_data.cap_per_man;
                    mat = qty.ultradun * getSoproMatPrijs(lagen, metAutex);
                } else if (systeem === 'asocret') {
                    // V10.8: Asocret met dikte dropdown
                    const dikte = parseInt(document.getElementById('asocret-dikte').value) || 10;
                    const metAutex = document.getElementById('asocret-autex').value === 'met';
                    const dikte_data = XTRA.ultradun.asocret.diktes[dikte];
                    cap_per_man = metAutex ? dikte_data.cap_met_autex : dikte_data.cap_per_man;
                    mat = qty.ultradun * getAsocretMatPrijs(dikte, metAutex);
                } else if (systeem === 'sulfatex') {
                    // V10.7: Sulfatex met lagen en Autex optie
                    const lagen = parseInt(document.getElementById('sulfatex-lagen').value) || 2;
                    const metAutex = document.getElementById('sulfatex-autex').value === 'met';
                    const lagen_data = XTRA.ultradun.sulfatex.lagen[lagen];
                    cap_per_man = metAutex ? lagen_data.cap_met_autex : lagen_data.cap_per_man;
                    mat = qty.ultradun * getSulfatexMatPrijs(lagen, metAutex);
                }
                
                const manuren = (qty.ultradun / cap_per_man) * 8;
                const loon = manuren * LOON;
                const subtotaal = mat + loon;
                const prijs = subtotaal / qty.ultradun;
                
                result.ultradun = { 
                    manuren, loon, mat,
                    tijd: manuren,
                    prijs: prijs,
                    subtotaal: subtotaal
                };
                result.manuren += manuren;
                result.loon += loon;
                result.mat += mat;
            }
        }

        // V9.25: Fixfinish met effectieve prijs functie
        if (qty.fixfinish > 0) {
            const manuren = (qty.fixfinish / XTRA.fixfinish.cap_per_man) * 8;
            const loon = manuren * LOON;
            const mat = qty.fixfinish * getFixfinishMatPrijs();
            const subtotaal = mat + loon;
            const prijs = subtotaal / qty.fixfinish;
            
            result.fixfinish = { 
                manuren, loon, mat,
                tijd: manuren,
                prijs: prijs,
                subtotaal: subtotaal
            };
            result.manuren += manuren;
            result.loon += loon;
            result.mat += mat;
        }

        // V9.25: Fassashield met effectieve prijs functie
        if (qty.fassashield > 0) {
            const manuren = (qty.fassashield / XTRA.fassashield.cap_per_man) * 8;
            const loon = manuren * LOON;
            const mat = qty.fassashield * getFassashieldMatPrijs();
            const subtotaal = mat + loon;
            const prijs = subtotaal / qty.fassashield;
            
            result.fassashield = { 
                manuren, loon, mat,
                tijd: manuren,
                prijs: prijs,
                subtotaal: subtotaal
            };
            result.manuren += manuren;
            result.loon += loon;
            result.mat += mat;
        }

        // V8.8: Grondering Muur
        if (qty.grondering > 0) {
            const product = document.getElementById('product-grondering').value || 'stucprimer';
            const spec = XTRA.grondering[product];
            
            // V9.29: Mat berekenen met checkbox state
            let mat;
            let emmers = 0;
            if (materialState.grondering.product) {
                if (spec && spec.trapfunctie) {
                    // Technicure AS: trapfunctie (emmer-afronding)
                    const kg_nodig = qty.grondering * spec.verbruik_per_m2;
                    emmers = Math.ceil(kg_nodig / spec.emmer_kg);
                    mat = emmers * spec.emmer_prijs;
                } else if (spec) {
                    mat = qty.grondering * spec.mat;
                } else {
                    mat = 0;
                }
            } else {
                mat = 0;
            }
            
            const cap = spec ? spec.cap_per_man : 140;
            const manuren = (qty.grondering / cap) * 8;
            const loon = manuren * LOON;
            
            result.grondering = { manuren, loon, mat, emmers, tijd: manuren };
            result.manuren += manuren;
            result.loon += loon;
            result.mat += mat;
        }

        // V9.28 FIX: Defensieve herberekening van result.manuren voor T&O
        // Voorkomt inconsistentie wanneer manuren verkeerd werden opgeteld
        let verified_manuren = 0;
        let verified_loon = 0;
        let verified_mat = 0;
        ['afkappen', 'injecties', 'membraan', 'bezetten', 'xps', 'wedi',
         'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
            if (result[comp]) {
                verified_manuren += result[comp].manuren || 0;
                verified_loon += result[comp].loon || 0;
                verified_mat += result[comp].mat || 0;
            }
        });
        result.manuren = verified_manuren;
        result.loon = verified_loon;
        result.mat = verified_mat;

        let werkdagen = 0;
        if (result.manuren > 0) {
            // V8.4: Correcte T&O berekening met 4-uur tolerantie
            werkdagen = Math.ceil(result.manuren / 16);
            const overschot = result.manuren % 16;
            if (overschot > 0 && overschot <= 4) {
                werkdagen = Math.floor(result.manuren / 16);
            }
            if (werkdagen < 1) werkdagen = 1;
        }
        result.werkdagen_TO = werkdagen;
        result.TO = result.werkdagen_TO * TO_PER_DAG;

        const werkelijke_kosten = result.mat + result.loon + result.TO;
        result.winst = werkelijke_kosten / 3;
        result.totaal = werkelijke_kosten + result.winst;

        ['afkappen', 'injecties', 'membraan', 'bezetten', 'xps', 'wedi',
         'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
            if (result[comp]) {
                const comp_manuren = result[comp].manuren;
                const comp_ratio = comp_manuren / result.manuren;
                
                result[comp].TO = result.TO * comp_ratio;
                
                const comp_kosten = result[comp].mat + 
                                   result[comp].loon + 
                                   result[comp].TO;
                result[comp].winst = comp_kosten / 3;
                result[comp].subtotaal = comp_kosten + result[comp].winst;
                result[comp].prijs = result[comp].subtotaal / qty[comp];
                result[comp].tijd = result[comp].manuren;
            }
        });

        // Herbereken op basis van afgeronde eenheidsprijzen
        let totaal_herberekend = 0;
        ['afkappen', 'injecties', 'membraan', 'bezetten', 'xps', 'wedi',
         'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
            if (result[comp] && qty[comp] > 0) {
                const eenheidsprijs_afgerond = Math.round(result[comp].prijs * 100) / 100;
                const subtotaal_nieuw = qty[comp] * eenheidsprijs_afgerond;
                result[comp].subtotaal = subtotaal_nieuw;
                result[comp].prijs = eenheidsprijs_afgerond;
                totaal_herberekend += subtotaal_nieuw;
            }
        });
        result.totaal = totaal_herberekend;

        return result;
    }

    function calculate() {
        const qty = {
            afkappen: parseFloat(document.getElementById('afkappen').value) || 0,
            injecties: parseFloat(document.getElementById('injecties').value) || 0,
            membraan: parseFloat(document.getElementById('membraan').value) || 0,
            bezetten: parseFloat(document.getElementById('bezetten').value) || 0,
            xps: parseFloat(document.getElementById('xps').value) || 0,
            wedi: parseFloat(document.getElementById('wedi').value) || 0,
            ultradun: parseFloat(document.getElementById('ultradun').value) || 0,
            fixfinish: parseFloat(document.getElementById('fixfinish').value) || 0,
            fassashield: parseFloat(document.getElementById('fassashield').value) || 0,
            grondering: parseFloat(document.getElementById('grondering').value) || 0
        };

        let result;
        
        if (isEvenredigVerdeeld(qty) && qty.xps === 0 && qty.wedi === 0 && 
            qty.ultradun === 0 && qty.fixfinish === 0 && qty.fassashield === 0 &&
            qty.grondering === 0) {
            result = berekenVasteTarieven(qty);
        } else {
            result = berekenDynamisch(qty);
        }

        // === BIJKOMEND PLEISTERWERK ===
        let bijkomend_totaal = 0;
        const bijkomendpleister_zakken = parseFloat(
            document.getElementById('bijkomendpleister').value) || 0;
        const oppervlakte_bezetten = qty.bezetten;
        
        if (bijkomendpleister_zakken > 0 && oppervlakte_bezetten > 0) {
            const totaal_kg = bijkomendpleister_zakken * 25;
            const kg_per_m2 = totaal_kg / oppervlakte_bezetten;
            const totale_dikte = kg_per_m2 / 7.5;
            const extra_dikte = Math.max(0, totale_dikte - 2);
            const standaard_zakken = (oppervlakte_bezetten * 2 * 7.5) / 25;
            
            if (bijkomendpleister_zakken > standaard_zakken) {
                // V9.28: Dynamische prijs op basis van materialState
                const mat_prijs = getBijkomendpleisterMatPrijs();
                const totaal_prijs = mat_prijs + BIJKOMENDPLEISTER_ARBEID;
                bijkomend_totaal = extra_dikte * totaal_prijs * oppervlakte_bezetten;
                
                const prijs_per_m2 = bijkomend_totaal / oppervlakte_bezetten;
                document.getElementById('price-bijkomendpleister').textContent = 
                    `€ ${prijs_per_m2.toFixed(2)}/m²`;
                document.getElementById('totale-dikte-bijkomendpleister').textContent = 
                    `${totale_dikte.toFixed(2)} cm`;
                document.getElementById('extra-dikte-bijkomendpleister').textContent = 
                    `${extra_dikte.toFixed(2)} cm`;
                document.getElementById('tot-bijkomendpleister').textContent = 
                    `€ ${bijkomend_totaal.toFixed(2)}`;
                
                document.getElementById('card-bijkomendpleister').classList.remove('dormant');
                document.getElementById('breakdown-bijkomendpleister').classList.add('show');
            } else {
                document.getElementById('card-bijkomendpleister').classList.add('dormant');
                document.getElementById('breakdown-bijkomendpleister').classList.remove('show');
                document.getElementById('price-bijkomendpleister').textContent = '€ 0,00/m²';
                document.getElementById('totale-dikte-bijkomendpleister').textContent = '0 cm';
                document.getElementById('extra-dikte-bijkomendpleister').textContent = '0 cm';
                document.getElementById('tot-bijkomendpleister').textContent = '€ 0';
            }
        } else {
            document.getElementById('card-bijkomendpleister').classList.add('dormant');
            document.getElementById('breakdown-bijkomendpleister').classList.remove('show');
            document.getElementById('price-bijkomendpleister').textContent = '€ 0,00/m²';
            document.getElementById('totale-dikte-bijkomendpleister').textContent = '0 cm';
            document.getElementById('extra-dikte-bijkomendpleister').textContent = '0 cm';
            document.getElementById('tot-bijkomendpleister').textContent = '€ 0';
        }

        // === EGALISATIE ===
        let egalisatie_totaal = 0;
        const egalisatie_zakken = parseFloat(
            document.getElementById('egalisatie').value) || 0;
        
        if (egalisatie_zakken > 0 && oppervlakte_bezetten > 0) {
            const totaal_kg = egalisatie_zakken * 25;
            const kg_per_m2 = totaal_kg / oppervlakte_bezetten;
            const totale_dikte_mm = kg_per_m2 / 2;
            
            egalisatie_totaal = totale_dikte_mm * 3.50 * oppervlakte_bezetten;
            
            const prijs_per_m2 = egalisatie_totaal / oppervlakte_bezetten;
            document.getElementById('price-egalisatie').textContent = 
                `€ ${prijs_per_m2.toFixed(2)}/m²`;
            document.getElementById('totale-dikte-egalisatie').textContent = 
                `${totale_dikte_mm.toFixed(2)} mm`;
            document.getElementById('tot-egalisatie').textContent = 
                `€ ${egalisatie_totaal.toFixed(2)}`;
            
            document.getElementById('card-egalisatie').classList.remove('dormant');
            document.getElementById('breakdown-egalisatie').classList.add('show');
        } else {
            document.getElementById('card-egalisatie').classList.add('dormant');
            document.getElementById('breakdown-egalisatie').classList.remove('show');
            document.getElementById('price-egalisatie').textContent = '€ 0,00/m²';
            document.getElementById('totale-dikte-egalisatie').textContent = '0 mm';
            document.getElementById('tot-egalisatie').textContent = '€ 0';
        }

        // === HOEKPROFIELEN ===
        let hoekprofielen_totaal = 0;
        const hoekprofielen_meters = parseFloat(
            document.getElementById('hoekprofielen').value) || 0;
        
        if (hoekprofielen_meters > 0 && oppervlakte_bezetten > 0) {
            const hoekprofielen_mat = hoekprofielen_meters * 0.80;
            const hoekprofielen_tijd = hoekprofielen_meters * 0.25;
            const hoekprofielen_arb = hoekprofielen_tijd * LOON;
            
            hoekprofielen_totaal = hoekprofielen_mat + hoekprofielen_arb;
            
            const prijs_per_meter = 0.80 + (0.25 * LOON);
            document.getElementById('price-hoekprofielen').textContent = 
                `€ ${prijs_per_meter.toFixed(2)}/m`;
            document.getElementById('mat-hoekprofielen').textContent = 
                `€ ${hoekprofielen_mat.toFixed(2)}`;
            document.getElementById('arb-hoekprofielen').textContent = 
                `€ ${hoekprofielen_arb.toFixed(2)}`;
            
            const uren = Math.floor(hoekprofielen_tijd);
            const minuten = Math.round((hoekprofielen_tijd - uren) * 60);
            document.getElementById('tijd-hoekprofielen').textContent = 
                `${uren}u ${minuten}m`;
            document.getElementById('tot-hoekprofielen').textContent = 
                `€ ${hoekprofielen_totaal.toFixed(2)}`;
            
            document.getElementById('card-hoekprofielen').classList.remove('dormant');
            document.getElementById('breakdown-hoekprofielen').classList.add('show');
        } else {
            document.getElementById('card-hoekprofielen').classList.add('dormant');
            document.getElementById('breakdown-hoekprofielen').classList.remove('show');
            document.getElementById('price-hoekprofielen').textContent = '€ 0,00/m';
            document.getElementById('mat-hoekprofielen').textContent = '€ 0';
            document.getElementById('arb-hoekprofielen').textContent = '€ 0';
            document.getElementById('tijd-hoekprofielen').textContent = '0u 0m';
            document.getElementById('tot-hoekprofielen').textContent = '€ 0';
        }
        
        // Toon/verberg bijkomend rijen
        document.getElementById('row-bijkomendpleister').style.display = 
            bijkomend_totaal > 0 ? 'flex' : 'none';
        document.getElementById('row-egalisatie').style.display = 
            egalisatie_totaal > 0 ? 'flex' : 'none';
        document.getElementById('row-hoekprofielen').style.display = 
            hoekprofielen_totaal > 0 ? 'flex' : 'none';
        
        // Update titels
        const hoofdTitle = document.getElementById('hoofdcomponenten-title');
        const hasExtraComponents = qty.xps > 0 || qty.wedi > 0 || qty.ultradun > 0 || 
                                   qty.fixfinish > 0 || qty.fassashield > 0 || qty.grondering > 0;
        hoofdTitle.textContent = hasExtraComponents ? 
            'Hoofd- en Extra Componenten' : 'Hoofdcomponenten';
        
        const bijkomendTitle = document.getElementById('bijkomend-title');
        bijkomendTitle.style.display = 
            (bijkomend_totaal > 0 || egalisatie_totaal > 0 || hoekprofielen_totaal > 0) 
            ? 'block' : 'none';
        
        // Herbereken bijkomend werk met afgeronde eenheidsprijzen
        if (bijkomend_totaal > 0 && oppervlakte_bezetten > 0) {
            const eenheidsprijs = bijkomend_totaal / oppervlakte_bezetten;
            const eenheidsprijs_afgerond = Math.round(eenheidsprijs * 100) / 100;
            bijkomend_totaal = oppervlakte_bezetten * eenheidsprijs_afgerond;
        }
        
        if (egalisatie_totaal > 0 && oppervlakte_bezetten > 0) {
            const eenheidsprijs = egalisatie_totaal / oppervlakte_bezetten;
            const eenheidsprijs_afgerond = Math.round(eenheidsprijs * 100) / 100;
            egalisatie_totaal = oppervlakte_bezetten * eenheidsprijs_afgerond;
        }
        
        if (hoekprofielen_totaal > 0 && hoekprofielen_meters > 0) {
            const eenheidsprijs = hoekprofielen_totaal / hoekprofielen_meters;
            const eenheidsprijs_afgerond = Math.round(eenheidsprijs * 100) / 100;
            hoekprofielen_totaal = hoekprofielen_meters * eenheidsprijs_afgerond;
        }
        
        const bijkomend_werk_kosten = bijkomend_totaal + egalisatie_totaal + hoekprofielen_totaal;
        if (bijkomend_werk_kosten > 0) {
            result.totaal += bijkomend_werk_kosten;
        }

        // Update component cards
        ['afkappen', 'injecties', 'membraan', 'bezetten', 'xps', 'wedi',
         'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
            const card = document.getElementById(`card-${comp}`);
            const breakdown = document.getElementById(`breakdown-${comp}`);
            
            if (qty[comp] > 0 && result[comp]) {
                card.classList.remove('dormant');
                breakdown.classList.add('show');
                
                const unit = (comp === 'injecties') ? 'm' : 'm²';
                document.getElementById(`price-${comp}`).textContent = 
                    `€ ${result[comp].prijs.toFixed(2)}/${unit}`;
                document.getElementById(`mat-${comp}`).textContent = 
                    `€ ${result[comp].mat.toFixed(2)}`;
                document.getElementById(`arb-${comp}`).textContent = 
                    `€ ${result[comp].loon.toFixed(2)}`;
                
                const uren = Math.floor(result[comp].tijd);
                const minuten = Math.round((result[comp].tijd - uren) * 60);
                document.getElementById(`tijd-${comp}`).textContent = 
                    `${uren}u ${minuten}m`;
                document.getElementById(`tot-${comp}`).textContent = 
                    `€ ${result[comp].subtotaal.toFixed(2)}`;
            } else {
                card.classList.add('dormant');
                breakdown.classList.remove('show');
                document.getElementById(`price-${comp}`).textContent = 
                    `€ 0,00/${(comp === 'injecties') ? 'm' : 'm²'}`;
            }
        });

        // Update summary
        const hasAnyValue = result.totaal > 0;
        document.getElementById('summary').classList.toggle('dormant', !hasAnyValue);

        const totaal_uren = Math.floor(result.manuren);
        const totaal_minuten = Math.round((result.manuren - totaal_uren) * 60);
        document.getElementById('total-tijd').textContent = 
            `${totaal_uren}u ${totaal_minuten}m`;
        document.getElementById('total-arbeid').textContent = 
            `€ ${result.loon.toFixed(2)}`;
        document.getElementById('total-materiaal').textContent = 
            `€ ${result.mat.toFixed(2)}`;
        document.getElementById('total-to').textContent = 
            `€ ${result.TO.toFixed(2)}`;
        document.getElementById('total-bijkomendpleister').textContent = 
            `€ ${bijkomend_totaal.toFixed(2)}`;
        document.getElementById('total-egalisatie').textContent = 
            `€ ${egalisatie_totaal.toFixed(2)}`;
        document.getElementById('total-hoekprofielen').textContent = 
            `€ ${hoekprofielen_totaal.toFixed(2)}`;
        document.getElementById('total-winst').textContent = 
            `€ ${result.winst.toFixed(2)}`;
        document.getElementById('total-prijs').textContent = 
            `€ ${result.totaal.toFixed(2)}`;
        
        // === FACTUUROVERZICHT ===
        const invoiceItemsContainer = document.getElementById('invoice-items');
        invoiceItemsContainer.innerHTML = '';
        
        const componentNames = {
            'afkappen': 'Afkappen',
            'injecties': 'Injecties',
            'membraan': 'SNC-membraan',
            'bezetten': 'Bezetten',
            'xps': 'XPS isolatie',
            'wedi': 'Wedi Bouwplaten',
            'ultradun': 'Compacte dichting',
            'fixfinish': 'Fix & Finish',
            'fassashield': 'Fassa Shield',
            'grondering': 'Grondering Muur'
        };
        
        ['afkappen', 'injecties', 'membraan', 'bezetten', 'xps', 'wedi',
         'ultradun', 'fixfinish', 'fassashield', 'grondering'].forEach(comp => {
            if (qty[comp] > 0 && result[comp]) {
                const unit = (comp === 'injecties') ? 'm' : 'm²';
                const eenheidsprijs = result[comp].prijs;
                const subtotaal = result[comp].subtotaal;
                
                const row = document.createElement('div');
                row.className = 'invoice-row';
                row.innerHTML = `
                    <span class="component-name">${componentNames[comp]}</span>
                    <span class="component-calc">${qty[comp].toFixed(2)} ${unit} x 
                    € ${eenheidsprijs.toFixed(2)}</span>
                    <span class="component-total">€ ${subtotaal.toFixed(2)}</span>
                `;
                invoiceItemsContainer.appendChild(row);
            }
        });
        
        if (bijkomend_totaal > 0 && oppervlakte_bezetten > 0) {
            const eenheidsprijs = bijkomend_totaal / oppervlakte_bezetten;
            const row = document.createElement('div');
            row.className = 'invoice-row';
            row.innerHTML = `
                <span class="component-name">Bijkomend pleisterwerk</span>
                <span class="component-calc">${oppervlakte_bezetten.toFixed(2)} m² x 
                € ${eenheidsprijs.toFixed(2)}</span>
                <span class="component-total">€ ${bijkomend_totaal.toFixed(2)}</span>
            `;
            invoiceItemsContainer.appendChild(row);
        }
        
        if (egalisatie_totaal > 0 && oppervlakte_bezetten > 0) {
            const eenheidsprijs = egalisatie_totaal / oppervlakte_bezetten;
            const row = document.createElement('div');
            row.className = 'invoice-row';
            row.innerHTML = `
                <span class="component-name">Bijkomende egalisatie</span>
                <span class="component-calc">${oppervlakte_bezetten.toFixed(2)} m² x 
                € ${eenheidsprijs.toFixed(2)}</span>
                <span class="component-total">€ ${egalisatie_totaal.toFixed(2)}</span>
            `;
            invoiceItemsContainer.appendChild(row);
        }
        
        if (hoekprofielen_totaal > 0 && hoekprofielen_meters > 0) {
            const eenheidsprijs = hoekprofielen_totaal / hoekprofielen_meters;
            const row = document.createElement('div');
            row.className = 'invoice-row';
            row.innerHTML = `
                <span class="component-name">Hoekprofiel(en)</span>
                <span class="component-calc">${hoekprofielen_meters.toFixed(2)} m x 
                € ${eenheidsprijs.toFixed(2)}</span>
                <span class="component-total">€ ${hoekprofielen_totaal.toFixed(2)}</span>
            `;
            invoiceItemsContainer.appendChild(row);
        }
        
        document.getElementById('invoice-total').textContent = 
            `€ ${result.totaal.toFixed(2)}`;
        
        // Toggle dormant state voor invoice card (gelijk aan summary)
        document.getElementById('invoice').classList.toggle('dormant', !hasAnyValue);
    }

    // ============================================================
    // V11.0: UX PARITEIT MET V34.5 SALES CALCULATOR
    // Card activation systeem + auto-scroll + auto-select
    // ============================================================
    
    // V11.0: Map card IDs to their primary (activating) field
    // Kaart blijft dormant totdat dit numerieke veld waarde > 0 heeft
    const cardPrimaryField = {
        'card-afkappen': 'afkappen',
        'card-injecties': 'injecties',
        'card-membraan': 'membraan',
        'card-bezetten': 'bezetten',
        'card-hoekprofielen': 'hoekprofielen',
        'card-bijkomendpleister': 'bijkomendpleister',
        'card-egalisatie': 'egalisatie',
        'card-xps': 'xps',
        'card-wedi': 'wedi',
        'card-ultradun': 'ultradun',
        'card-fixfinish': 'fixfinish',
        'card-fassashield': 'fassashield',
        'card-grondering': 'grondering'
    };
    
    // V11.0: Map input/select IDs to their parent card IDs
    const inputToCard = {
        'afkappen': 'card-afkappen',
        'injecties': 'card-injecties',
        'membraan': 'card-membraan',
        'bezetten': 'card-bezetten',
        'hoekprofielen': 'card-hoekprofielen',
        'bijkomendpleister': 'card-bijkomendpleister',
        'egalisatie': 'card-egalisatie',
        'xps': 'card-xps',
        'xps-dikte': 'card-xps',
        'xps-gitex': 'card-xps',
        'wedi': 'card-wedi',
        'wedi-dikte': 'card-wedi',
        'wedi-gitex': 'card-wedi',
        'ultradun': 'card-ultradun',
        'ultradun-systeem': 'card-ultradun',
        'sopro-lagen': 'card-ultradun',
        'sopro-autex': 'card-ultradun',
        'sulfatex-lagen': 'card-ultradun',
        'sulfatex-autex': 'card-ultradun',
        'asocret-dikte': 'card-ultradun',
        'asocret-autex': 'card-ultradun',
        'fixfinish': 'card-fixfinish',
        'fassashield': 'card-fassashield',
        'grondering': 'card-grondering',
        'product-grondering': 'card-grondering'
    };
    
    // V11.0: Check of kaart geactiveerd mag worden (alleen als primair veld waarde > 0)
    const shouldActivateCard = (cardId) => {
        const primaryField = cardPrimaryField[cardId];
        if (!primaryField) return true;  // Geen mapping = altijd activeren
        
        const el = document.getElementById(primaryField);
        return el && parseFloat(el.value.replace(',', '.')) > 0;
    };
    
    // V11.0: Maak kaart dormant als primair veld leeg/0
    const deactivateCardIfEmpty = (cardId) => {
        if (!shouldActivateCard(cardId)) {
            const card = document.getElementById(cardId);
            if (card) card.classList.add('dormant');
        }
    };
    
    // V11.0: Activeer kaart (verwijder dormant class)
    const activateCard = (cardId) => {
        const card = document.getElementById(cardId);
        if (card) card.classList.remove('dormant');
    };
    
    // V11.0: Scroll active field to 1/3 from top of viewport (V33.2 pattern)
    const scrollFieldIntoView = (element) => {
        if (!element) return;
        
        // Small delay to let mobile keyboard appear first
        setTimeout(() => {
            const rect = element.getBoundingClientRect();
            const elementTop = rect.top + window.scrollY;
            const viewportHeight = window.innerHeight;
            const targetOffset = viewportHeight / 3;
            const scrollTo = elementTop - targetOffset;
            
            window.scrollTo({
                top: Math.max(0, scrollTo),
                behavior: 'smooth'
            });
        }, 50);
    };

    // === EVENT LISTENERS ===
    const inputIds = [
        'afkappen', 'injecties', 'membraan', 'bezetten',
        'hoekprofielen', 'bijkomendpleister', 'egalisatie',
        'xps', 'wedi', 'ultradun', 'fixfinish', 'fassashield', 'grondering'
    ];
    
    inputIds.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
            // V11.0: Input event met dormant logica (V34.5 pattern)
            element.addEventListener('input', function(e) {
                const cardId = inputToCard[id];
                if (cardId) {
                    if (shouldActivateCard(cardId)) {
                        activateCard(cardId);
                    } else {
                        deactivateCardIfEmpty(cardId);
                    }
                }
                
                calculate();
                UnitPositioner.update(e.target);
            });
            
            // Blur event: format naar 1 decimaal en update positie
            element.addEventListener('blur', function(e) {
                const value = parseFloat(e.target.value.replace(',', '.'));
                if (!isNaN(value) && value >= 0) {
                    e.target.value = value.toFixed(1).replace('.', ',');
                    UnitPositioner.update(e.target);
                } else if (e.target.value.trim() !== '') {
                    e.target.value = '';
                    UnitPositioner.update(e.target);
                }
                calculate();
            });
            
            // V11.0: Focus event met auto-scroll + auto-select (V33.2 + V27.0 pattern)
            element.addEventListener('focus', function() {
                scrollFieldIntoView(element);
                if (element.value) {
                    element.select();
                }
            });
        }
    });
    
    // V11.0: Select handlers met shouldActivateCard check (V34.5 pattern)
    // Dropdown selecties alleen activeren kaart als primair veld waarde > 0 heeft
    ['xps-dikte', 'xps-gitex', 'ultradun-systeem', 'sopro-lagen', 'wedi-dikte', 'wedi-gitex', 'product-grondering'].forEach(id => {
        const select = document.getElementById(id);
        select.addEventListener('change', function(e) {
            // Toggle placeholder-active class
            if (e.target.value === '' || e.target.selectedOptions[0].disabled) {
                e.target.classList.add('placeholder-active');
            } else {
                e.target.classList.remove('placeholder-active');
                UnitPositioner.update(e.target);
            }
            
            // V11.0: Alleen activeren als primair veld waarde heeft
            const cardId = inputToCard[id];
            if (cardId && shouldActivateCard(cardId)) {
                activateCard(cardId);
            }
            
            // V10.8: Show/hide systeem-specifieke dropdowns
            if (id === 'ultradun-systeem') {
                const soproLagenWrapper = document.getElementById('sopro-lagen-wrapper');
                const soproLagenSelect = document.getElementById('sopro-lagen');
                const soproAutexWrapper = document.getElementById('sopro-autex-wrapper');
                const sulfatexLagenWrapper = document.getElementById('sulfatex-lagen-wrapper');
                const sulfatexLagenSelect = document.getElementById('sulfatex-lagen');
                const sulfatexAutexWrapper = document.getElementById('sulfatex-autex-wrapper');
                const asocretAutexWrapper = document.getElementById('asocret-autex-wrapper');
                const asocretDikteWrapper = document.getElementById('asocret-dikte-wrapper');
                const asocretDikteSelect = document.getElementById('asocret-dikte');
                
                if (e.target.value === 'sopro') {
                    soproAutexWrapper.style.display = 'block';
                    soproLagenWrapper.style.display = 'block';
                    sulfatexAutexWrapper.style.display = 'none';
                    sulfatexLagenWrapper.style.display = 'none';
                    asocretAutexWrapper.style.display = 'none';
                    asocretDikteWrapper.style.display = 'none';
                } else if (e.target.value === 'sulfatex') {
                    soproAutexWrapper.style.display = 'none';
                    soproLagenWrapper.style.display = 'none';
                    soproLagenSelect.value = '2';
                    sulfatexAutexWrapper.style.display = 'block';
                    sulfatexLagenWrapper.style.display = 'block';
                    asocretAutexWrapper.style.display = 'none';
                    asocretDikteWrapper.style.display = 'none';
                } else if (e.target.value === 'asocret') {
                    soproAutexWrapper.style.display = 'none';
                    soproLagenWrapper.style.display = 'none';
                    soproLagenSelect.value = '2';
                    sulfatexAutexWrapper.style.display = 'none';
                    sulfatexLagenWrapper.style.display = 'none';
                    sulfatexLagenSelect.value = '2';
                    asocretAutexWrapper.style.display = 'block';
                    asocretDikteWrapper.style.display = 'block';
                } else {
                    // No selection
                    soproAutexWrapper.style.display = 'none';
                    soproLagenWrapper.style.display = 'none';
                    soproLagenSelect.value = '2';
                    sulfatexAutexWrapper.style.display = 'none';
                    sulfatexLagenWrapper.style.display = 'none';
                    sulfatexLagenSelect.value = '2';
                    asocretAutexWrapper.style.display = 'none';
                    asocretDikteWrapper.style.display = 'none';
                    asocretDikteSelect.value = '10';
                }
            }
            
            calculate();
        });
        
        // V11.0: Focus event voor select met auto-scroll
        select.addEventListener('focus', function() {
            scrollFieldIntoView(select);
        });
    });

    // V11.0: Autex en dikte dropdowns met shouldActivateCard check
    // Deze dropdowns activeren kaart alleen als primair veld (ultradun) waarde > 0 heeft
    
    // Asocret-autex dropdown
    const asocretAutex = document.getElementById('asocret-autex');
    asocretAutex.addEventListener('change', function() {
        if (shouldActivateCard('card-ultradun')) {
            activateCard('card-ultradun');
        }
        calculate();
    });
    asocretAutex.addEventListener('focus', function() {
        scrollFieldIntoView(asocretAutex);
    });

    // Asocret-dikte dropdown
    const asocretDikte = document.getElementById('asocret-dikte');
    asocretDikte.addEventListener('change', function() {
        if (shouldActivateCard('card-ultradun')) {
            activateCard('card-ultradun');
        }
        calculate();
    });
    asocretDikte.addEventListener('focus', function() {
        scrollFieldIntoView(asocretDikte);
    });

    // Sopro-autex dropdown
    const soproAutex = document.getElementById('sopro-autex');
    soproAutex.addEventListener('change', function() {
        if (shouldActivateCard('card-ultradun')) {
            activateCard('card-ultradun');
        }
        calculate();
    });
    soproAutex.addEventListener('focus', function() {
        scrollFieldIntoView(soproAutex);
    });

    // Sulfatex-autex dropdown
    const sulfatexAutex = document.getElementById('sulfatex-autex');
    sulfatexAutex.addEventListener('change', function() {
        if (shouldActivateCard('card-ultradun')) {
            activateCard('card-ultradun');
        }
        calculate();
    });
    sulfatexAutex.addEventListener('focus', function() {
        scrollFieldIntoView(sulfatexAutex);
    });

    // Sulfatex-lagen dropdown
    const sulfatexLagen = document.getElementById('sulfatex-lagen');
    sulfatexLagen.addEventListener('change', function() {
        if (shouldActivateCard('card-ultradun')) {
            activateCard('card-ultradun');
        }
        calculate();
    });
    sulfatexLagen.addEventListener('focus', function() {
        scrollFieldIntoView(sulfatexLagen);
    });

    // Initialize UnitPositioner
    UnitPositioner.init();

    // Initial calculate
    calculate();
    </script>
</body>
</html>
